function styleInject(e,t){var n,r,t=(t=void 0===t?{}:t).insertAt;e&&"undefined"!=typeof document&&(n=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===t&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}var css_248z='.lgraphcanvas {\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  outline: none;\n  font-family: Tahoma, sans-serif;\n}\n\n.lgraphcanvas * {\n  box-sizing: border-box;\n}\n\n.litegraph.litecontextmenu {\n  font-family: Tahoma, sans-serif;\n  position: fixed;\n  top: 100px;\n  left: 100px;\n  min-width: 100px;\n  color: #aaf;\n  padding: 0;\n  box-shadow: 0 0 10px black !important;\n  background-color: #2e2e2e !important;\n  z-index: 10;\n}\n\n.litegraph.litecontextmenu.dark {\n  background-color: #000 !important;\n}\n\n.litegraph.litecontextmenu .litemenu-title img {\n  margin-top: 2px;\n  margin-left: 2px;\n  margin-right: 4px;\n}\n\n.litegraph.litecontextmenu .litemenu-entry {\n  margin: 2px;\n  padding: 2px;\n}\n\n.litegraph.litecontextmenu .litemenu-entry.submenu {\n  background-color: #2e2e2e !important;\n}\n\n.litegraph.litecontextmenu.dark .litemenu-entry.submenu {\n  background-color: #000 !important;\n}\n\n.litegraph .litemenubar ul {\n  font-family: Tahoma, sans-serif;\n  margin: 0;\n  padding: 0;\n}\n\n.litegraph .litemenubar li {\n  font-size: 14px;\n  color: #999;\n  display: inline-block;\n  min-width: 50px;\n  padding-left: 10px;\n  padding-right: 10px;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  cursor: pointer;\n}\n\n.litegraph .litemenubar li:hover {\n  background-color: #777;\n  color: #eee;\n}\n\n.litegraph .litegraph .litemenubar-panel {\n  position: absolute;\n  top: 5px;\n  left: 5px;\n  min-width: 100px;\n  background-color: #444;\n  box-shadow: 0 0 3px black;\n  padding: 4px;\n  border-bottom: 2px solid #aaf;\n  z-index: 10;\n}\n\n.litegraph .litemenu-entry,\n.litemenu-title {\n  font-size: 12px;\n  color: #aaa;\n  padding: 0 0 0 4px;\n  margin: 2px;\n  padding-left: 2px;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  user-select: none;\n  cursor: pointer;\n}\n\n.litegraph .litemenu-entry .icon {\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  margin: 2px;\n  vertical-align: top;\n}\n\n.litegraph .litemenu-entry.checked .icon {\n  background-color: #aaf;\n}\n\n.litegraph .litemenu-entry .more {\n  float: right;\n  padding-right: 5px;\n}\n\n.litegraph .litemenu-entry.disabled {\n  opacity: 0.5;\n  cursor: default;\n}\n\n.litegraph .litemenu-entry.separator {\n  display: block;\n  border-top: 1px solid #333;\n  border-bottom: 1px solid #666;\n  width: 100%;\n  height: 0px;\n  margin: 3px 0 2px 0;\n  background-color: transparent;\n  padding: 0 !important;\n  cursor: default !important;\n}\n\n.litegraph .litemenu-entry.has_submenu {\n  border-right: 2px solid cyan;\n}\n\n.litegraph .litemenu-title {\n  color: #dde;\n  background-color: #111;\n  margin: 0;\n  padding: 2px;\n  cursor: default;\n}\n\n.litegraph .litemenu-entry:hover:not(.disabled):not(.separator) {\n  background-color: #444 !important;\n  color: #eee;\n  transition: all 0.2s;\n}\n\n.litegraph .litemenu-entry .property_name {\n  display: inline-block;\n  text-align: left;\n  min-width: 80px;\n  min-height: 1.2em;\n}\n\n.litegraph .litemenu-entry .property_value {\n  display: inline-block;\n  background-color: rgba(0, 0, 0, 0.5);\n  text-align: right;\n  min-width: 80px;\n  min-height: 1.2em;\n  vertical-align: middle;\n  padding-right: 10px;\n}\n\n.litegraph.litesearchbox {\n  font-family: Tahoma, sans-serif;\n  position: absolute;\n  padding-top: 4px;\n  border-radius: 0 !important;\n}\n\n.litegraph.litesearchbox input,\n.litegraph.litesearchbox select {\n  margin-top: 3px;\n  min-width: 60px;\n  min-height: 1.5em;\n  background-color: black;\n  border: 0;\n  color: white;\n  padding-left: 10px;\n  margin-right: 5px;\n}\n\n.litegraph.litesearchbox .name {\n  display: inline-block;\n  min-width: 60px;\n  min-height: 1.5em;\n  padding-left: 10px;\n}\n\n.litegraph.litesearchbox .helper {\n  overflow: auto;\n  max-height: 200px;\n  margin-top: 2px;\n}\n\n.litegraph.lite-search-item {\n  font-family: Tahoma, sans-serif;\n  background-color: rgba(0, 0, 0, 0.5);\n  color: white;\n  padding-top: 2px;\n}\n\n.litegraph.lite-search-item.not_in_filter {\n  /*background-color: rgba(50, 50, 50, 0.5);*/\n  /*color: #999;*/\n  color: #b99;\n  font-style: italic;\n}\n\n.litegraph.lite-search-item.generic_type {\n  /*background-color: rgba(50, 50, 50, 0.5);*/\n  /*color: #DD9;*/\n  color: #999;\n  font-style: italic;\n}\n\n.litegraph.lite-search-item:hover,\n.litegraph.lite-search-item.selected {\n  cursor: pointer;\n  background-color: white;\n  color: black;\n}\n\n/* DIALOGs ******/\n.litegraph .dialog {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -150px;\n  margin-left: -200px;\n  background-color: #2a2a2a;\n  min-width: 400px;\n  min-height: 200px;\n  box-shadow: 0 0 4px #111;\n}\n\n.litegraph .dialog.settings {\n  left: 10px;\n  top: 10px;\n  height: calc(100% - 20px);\n  margin: auto;\n  max-width: 50%;\n}\n\n.litegraph .dialog.centered {\n  top: 50px;\n  left: 50%;\n  position: absolute;\n  transform: translateX(-50%);\n  min-width: 600px;\n  min-height: 300px;\n  height: calc(100% - 100px);\n  margin: auto;\n}\n\n.litegraph .dialog .close {\n  float: right;\n  margin: 4px;\n  margin-right: 10px;\n  cursor: pointer;\n  font-size: 1.4em;\n}\n\n.litegraph .dialog .close:hover {\n  color: white;\n}\n\n.litegraph .dialog .dialog-header {\n  color: #aaa;\n  border-bottom: 1px solid #161616;\n}\n\n.litegraph .dialog .dialog-header {\n  height: 40px;\n}\n\n.litegraph .dialog .dialog-footer {\n  height: 50px;\n  padding: 10px;\n  border-top: 1px solid #1a1a1a;\n}\n\n.litegraph .dialog .dialog-header .dialog-title {\n  font: 20px "Arial";\n  margin: 4px;\n  padding: 4px 10px;\n  display: inline-block;\n}\n\n.litegraph .dialog .dialog-content,\n.litegraph .dialog .dialog-alt-content {\n  height: calc(100% - 90px);\n  width: 100%;\n  min-height: 100px;\n  display: inline-block;\n  color: #aaa;\n  /*background-color: black;*/\n  overflow: auto;\n}\n\n.litegraph .dialog .dialog-content h3 {\n  margin: 10px;\n}\n\n.litegraph .dialog .dialog-content .connections {\n  flex-direction: row;\n}\n\n.litegraph .dialog .dialog-content .connections .connections_side {\n  width: calc(50% - 5px);\n  min-height: 100px;\n  background-color: black;\n  display: flex;\n}\n\n.litegraph .dialog .node_type {\n  font-size: 1.2em;\n  display: block;\n  margin: 10px;\n}\n\n.litegraph .dialog .node_desc {\n  opacity: 0.5;\n  display: block;\n  margin: 10px;\n}\n\n.litegraph .dialog .separator {\n  display: block;\n  width: calc(100% - 4px);\n  height: 1px;\n  border-top: 1px solid #000;\n  border-bottom: 1px solid #333;\n  margin: 10px 2px;\n  padding: 0;\n}\n\n.litegraph .dialog .property {\n  margin-bottom: 2px;\n  padding: 4px;\n}\n\n.litegraph .dialog .property:hover {\n  background: #545454;\n}\n\n.litegraph .dialog .property_name {\n  color: #737373;\n  display: inline-block;\n  text-align: left;\n  vertical-align: top;\n  width: 160px;\n  padding-left: 4px;\n  overflow: hidden;\n  margin-right: 6px;\n}\n\n.litegraph .dialog .property:hover .property_name {\n  color: white;\n}\n\n.litegraph .dialog .property_value {\n  display: inline-block;\n  text-align: right;\n  color: #aaa;\n  background-color: #1a1a1a;\n  /*width: calc( 100% - 122px );*/\n  max-width: calc(100% - 162px);\n  min-width: 200px;\n  max-height: 300px;\n  min-height: 20px;\n  padding: 4px;\n  padding-right: 12px;\n  overflow: hidden;\n  cursor: pointer;\n}\n\n.litegraph .dialog .property_value:hover {\n  color: white;\n}\n\n.litegraph .dialog .property.boolean .property_value {\n  padding-right: 30px;\n  color: #a88;\n  /*width: auto;\n    float: right;*/\n}\n\n.litegraph .dialog .property.boolean.bool-on .property_name {\n  color: #8a8;\n}\n\n.litegraph .dialog .property.boolean.bool-on .property_value {\n  color: #8a8;\n}\n\n.litegraph .dialog .btn {\n  border: 0;\n  border-radius: 4px;\n  padding: 4px 20px;\n  margin-left: 0px;\n  background-color: #060606;\n  color: #8e8e8e;\n}\n\n.litegraph .dialog .btn:hover {\n  background-color: #111;\n  color: #fff;\n}\n\n.litegraph .dialog .btn.delete:hover {\n  background-color: #f33;\n  color: black;\n}\n\n.litegraph .subgraph_property {\n  padding: 4px;\n}\n\n.litegraph .subgraph_property:hover {\n  background-color: #333;\n}\n\n.litegraph .subgraph_property.extra {\n  margin-top: 8px;\n}\n\n.litegraph .subgraph_property span.name {\n  font-size: 1.3em;\n  padding-left: 4px;\n}\n\n.litegraph .subgraph_property span.type {\n  opacity: 0.5;\n  margin-right: 20px;\n  padding-left: 4px;\n}\n\n.litegraph .subgraph_property span.label {\n  display: inline-block;\n  width: 60px;\n  padding: 0px 10px;\n}\n\n.litegraph .subgraph_property input {\n  width: 140px;\n  color: #999;\n  background-color: #1a1a1a;\n  border-radius: 4px;\n  border: 0;\n  margin-right: 10px;\n  padding: 4px;\n  padding-left: 10px;\n}\n\n.litegraph .subgraph_property button {\n  background-color: #1c1c1c;\n  color: #aaa;\n  border: 0;\n  border-radius: 2px;\n  padding: 4px 10px;\n  cursor: pointer;\n}\n\n.litegraph .subgraph_property.extra {\n  color: #ccc;\n}\n\n.litegraph .subgraph_property.extra input {\n  background-color: #111;\n}\n\n.litegraph .bullet_icon {\n  margin-left: 10px;\n  border-radius: 10px;\n  width: 12px;\n  height: 12px;\n  background-color: #666;\n  display: inline-block;\n  margin-top: 2px;\n  margin-right: 4px;\n  transition: background-color 0.1s ease 0s;\n  -moz-transition: background-color 0.1s ease 0s;\n}\n\n.litegraph .bullet_icon:hover {\n  background-color: #698;\n  cursor: pointer;\n}\n\n/* OLD */\n.graphcontextmenu {\n  padding: 4px;\n  min-width: 100px;\n}\n\n.graphcontextmenu-title {\n  color: #dde;\n  background-color: #222;\n  margin: 0;\n  padding: 2px;\n  cursor: default;\n}\n\n.graphmenu-entry {\n  box-sizing: border-box;\n  margin: 2px;\n  padding-left: 20px;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  transition: all linear 0.3s;\n}\n\n.graphmenu-entry.event,\n.litemenu-entry.event {\n  border-left: 8px solid orange;\n  padding-left: 12px;\n}\n\n.graphmenu-entry.disabled {\n  opacity: 0.3;\n}\n\n.graphmenu-entry.submenu {\n  border-right: 2px solid #eee;\n}\n\n.graphmenu-entry:hover {\n  background-color: #555;\n}\n\n.graphmenu-entry.separator {\n  background-color: #111;\n  border-bottom: 1px solid #666;\n  height: 1px;\n  width: calc(100% - 20px);\n  -moz-width: calc(100% - 20px);\n  -webkit-width: calc(100% - 20px);\n}\n\n.graphmenu-entry .property_name {\n  display: inline-block;\n  text-align: left;\n  min-width: 80px;\n  min-height: 1.2em;\n}\n\n.graphmenu-entry .property_value,\n.litemenu-entry .property_value {\n  display: inline-block;\n  background-color: rgba(0, 0, 0, 0.5);\n  text-align: right;\n  min-width: 80px;\n  min-height: 1.2em;\n  vertical-align: middle;\n  padding-right: 10px;\n}\n\n.graphdialog {\n  position: absolute;\n  top: 10px;\n  left: 10px;\n  min-height: 2em;\n  background-color: #333;\n  font-size: 1.2em;\n  box-shadow: 0 0 10px black !important;\n  z-index: 10;\n}\n\n.graphdialog.rounded {\n  border-radius: 12px;\n}\n\n.graphdialog .name {\n  display: inline-block;\n  min-width: 60px;\n  min-height: 1.5em;\n  padding-left: 10px;\n}\n\n.graphdialog input,\n.graphdialog textarea,\n.graphdialog select {\n  margin: 3px;\n  min-width: 60px;\n  min-height: 1.5em;\n  background-color: black;\n  border: 0;\n  color: white;\n  padding-left: 10px;\n  outline: none;\n}\n\n.graphdialog textarea {\n  min-height: 150px;\n}\n\n.graphdialog button {\n  margin-top: 3px;\n  vertical-align: top;\n  background-color: #999;\n  border: 0;\n}\n\n.graphdialog button.rounded,\n.graphdialog input.rounded {\n  border-radius: 0 12px 12px 0;\n}\n\n.graphdialog .helper {\n  overflow: auto;\n  max-height: 200px;\n}\n\n.graphdialog .help-item {\n  padding-left: 10px;\n}\n\n.graphdialog .help-item:hover,\n.graphdialog .help-item.selected {\n  cursor: pointer;\n  background-color: white;\n  color: black;\n}\n\n.litegraph .dialog {\n  min-height: 0;\n}\n\n.litegraph .dialog .dialog-content {\n  display: block;\n}\n\n.litegraph .dialog .dialog-content .subgraph_property {\n  padding: 5px;\n}\n\n.litegraph .dialog .dialog-footer {\n  margin: 0;\n}\n\n.litegraph .dialog .dialog-footer .subgraph_property {\n  margin-top: 0;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n}\n\n.litegraph .dialog .dialog-footer .subgraph_property .name {\n  flex: 1;\n}\n\n.litegraph .graphdialog {\n  display: flex;\n  align-items: center;\n  border-radius: 20px;\n  padding: 4px 10px;\n  position: fixed;\n}\n\n.litegraph .graphdialog .name {\n  padding: 0;\n  min-height: 0;\n  font-size: 16px;\n  vertical-align: middle;\n}\n\n.litegraph .graphdialog .value {\n  font-size: 16px;\n  min-height: 0;\n  margin: 0 10px;\n  padding: 2px 5px;\n}\n\n.litegraph .graphdialog input[type=checkbox] {\n  width: 16px;\n  height: 16px;\n}\n\n.litegraph .graphdialog button {\n  padding: 4px 18px;\n  border-radius: 20px;\n  cursor: pointer;\n}',freeGlobal=(styleInject(css_248z),"object"==typeof global&&global&&global.Object===Object&&global),freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol=root.Symbol,objectProto$s=Object.prototype,hasOwnProperty$o=objectProto$s.hasOwnProperty,nativeObjectToString$3=objectProto$s.toString,symToStringTag$1=Symbol?Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$o.call(e,symToStringTag$1),n=e[symToStringTag$1];try{var r=!(e[symToStringTag$1]=void 0)}catch(e){}var i=nativeObjectToString$3.call(e);return r&&(t?e[symToStringTag$1]=n:delete e[symToStringTag$1]),i}var objectProto$r=Object.prototype,nativeObjectToString$2=objectProto$r.toString;function objectToString(e){return nativeObjectToString$2.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol?Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:(symToStringTag&&symToStringTag in Object(e)?getRawTag:objectToString)(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag$3="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag$3}var NAN$2=NaN;function baseToNumber(e){return"number"==typeof e?e:isSymbol(e)?NAN$2:+e}function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var isArray=Array.isArray,INFINITY$5=1/0,symbolProto$2=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(e){var t;return"string"==typeof e?e:isArray(e)?arrayMap(e,baseToString)+"":isSymbol(e)?symbolToString?symbolToString.call(e):"":"0"==(t=e+"")&&1/e==-INFINITY$5?"-0":t}function createMathOperation(r,i){return function(e,t){var n;if(void 0===e&&void 0===t)return i;if(void 0!==e&&(n=e),void 0!==t){if(void 0===n)return t;t=("string"==typeof e||"string"==typeof t?(e=baseToString(e),baseToString):(e=baseToNumber(e),baseToNumber))(t),n=r(e,t)}return n}}var add=createMathOperation(function(e,t){return e+t},0),reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var reTrimStart$2=/^\s+/;function baseTrim(e){return e&&e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart$2,"")}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var NAN$1=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN$1;if("string"!=typeof(e=isObject(e)?isObject(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=baseTrim(e);var t=reIsBinary.test(e);return t||reIsOctal.test(e)?freeParseInt(e.slice(2),t?2:8):reIsBadHex.test(e)?NAN$1:+e}var INFINITY$4=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber(e))===INFINITY$4||e===-INFINITY$4?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var e=toFinite(e),t=e%1;return e==e?t?e-t:e:0}var FUNC_ERROR_TEXT$b="Expected a function";function after(e,t){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$b);return e=toInteger(e),function(){if(--e<1)return t.apply(this,arguments)}}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){return!!isObject(e)&&((e=baseGetTag(e))==funcTag$2||e==genTag$1||e==asyncTag||e==proxyTag)}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(null!=e){try{return funcToString$2.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$q=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$n=objectProto$q.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$n).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject(e)||isMasked(e))&&(isFunction(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){e=getValue(e,t);return baseIsNative(e)?e:void 0}var WeakMap=getNative(root,"WeakMap"),metaMap=WeakMap&&new WeakMap,baseSetData=metaMap?function(e,t){return metaMap.set(e,t),e}:identity,objectCreate=Object.create,baseCreate=function(){function t(){}return function(e){if(!isObject(e))return{};if(objectCreate)return objectCreate(e);t.prototype=e;e=new t;return t.prototype=void 0,e}}();function createCtor(r){return function(){var e=arguments;switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3]);case 5:return new r(e[0],e[1],e[2],e[3],e[4]);case 6:return new r(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new r(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=baseCreate(r.prototype),n=r.apply(t,e);return isObject(n)?n:t}}var WRAP_BIND_FLAG$8=1;function createBind(t,e,n){var r=e&WRAP_BIND_FLAG$8,i=createCtor(t);return function e(){return(this&&this!==root&&this instanceof e?i:t).apply(r?n:this,arguments)}}function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var nativeMax$g=Math.max;function composeArgs(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,l=t.length,h=nativeMax$g(o-a,0),p=Array(l+h),u=!r;++s<l;)p[s]=t[s];for(;++i<a;)(u||i<o)&&(p[n[i]]=e[i]);for(;h--;)p[s++]=e[i++];return p}var nativeMax$f=Math.max;function composeArgsRight(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,l=-1,h=t.length,p=nativeMax$f(o-s,0),u=Array(p+h),c=!r;++i<p;)u[i]=e[i];for(var d=i;++l<h;)u[d+l]=t[l];for(;++a<s;)(c||i<o)&&(u[d+n[a]]=e[i++]);return u}function countHolders(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function baseLodash(){}var MAX_ARRAY_LENGTH$6=4294967295;function LazyWrapper(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH$6,this.__views__=[]}function noop(){}LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper;var getData=metaMap?function(e){return metaMap.get(e)}:noop,realNames={},objectProto$p=Object.prototype,hasOwnProperty$m=objectProto$p.hasOwnProperty;function getFuncName(e){for(var t=e.name+"",n=realNames[t],r=hasOwnProperty$m.call(realNames,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function LodashWrapper(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function copyArray(e,t){var n=-1,r=e.length;for(t=t||Array(r);++n<r;)t[n]=e[n];return t}function wrapperClone(e){var t;return e instanceof LazyWrapper?e.clone():((t=new LodashWrapper(e.__wrapped__,e.__chain__)).__actions__=copyArray(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t)}LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper;var objectProto$o=Object.prototype,hasOwnProperty$l=objectProto$o.hasOwnProperty;function lodash(e){if(isObjectLike(e)&&!isArray(e)&&!(e instanceof LazyWrapper)){if(e instanceof LodashWrapper)return e;if(hasOwnProperty$l.call(e,"__wrapped__"))return wrapperClone(e)}return new LodashWrapper(e)}function isLaziable(e){var t=getFuncName(e),n=lodash[t];return"function"==typeof n&&t in LazyWrapper.prototype&&(e===n||!!(t=getData(n))&&e===t[0])}lodash.prototype=baseLodash.prototype,lodash.prototype.constructor=lodash;var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(n){var r=0,i=0;return function(){var e=nativeNow(),t=HOT_SPAN-(e-i);if(i=e,0<t){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return n.apply(void 0,arguments)}}var setData=shortOut(baseSetData),reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;function getWrapDetails(e){e=e.match(reWrapDetails);return e?e[1].split(reSplitDetails):[]}var reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function insertWrapDetails(e,t){var n,r=t.length;return r?(t[n=r-1]=(1<r?"& ":"")+t[n],t=t.join(2<r?", ":" "),e.replace(reWrapComment,"{\n/* [wrapped with "+t+"] */\n")):e}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),baseSetToString=defineProperty?function(e,t){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,setToString=shortOut(baseSetToString);function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function baseFindIndex(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function baseIsNaN(e){return e!=e}function strictIndexOf(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function baseIndexOf(e,t,n){return t==t?strictIndexOf(e,t,n):baseFindIndex(e,baseIsNaN,n)}function arrayIncludes(e,t){return!!(null==e?0:e.length)&&-1<baseIndexOf(e,t,0)}var WRAP_BIND_FLAG$7=1,WRAP_BIND_KEY_FLAG$6=2,WRAP_CURRY_FLAG$6=8,WRAP_CURRY_RIGHT_FLAG$3=16,WRAP_PARTIAL_FLAG$6=32,WRAP_PARTIAL_RIGHT_FLAG$3=64,WRAP_ARY_FLAG$4=128,WRAP_REARG_FLAG$3=256,WRAP_FLIP_FLAG$2=512,wrapFlags=[["ary",WRAP_ARY_FLAG$4],["bind",WRAP_BIND_FLAG$7],["bindKey",WRAP_BIND_KEY_FLAG$6],["curry",WRAP_CURRY_FLAG$6],["curryRight",WRAP_CURRY_RIGHT_FLAG$3],["flip",WRAP_FLIP_FLAG$2],["partial",WRAP_PARTIAL_FLAG$6],["partialRight",WRAP_PARTIAL_RIGHT_FLAG$3],["rearg",WRAP_REARG_FLAG$3]];function updateWrapDetails(n,r){return arrayEach(wrapFlags,function(e){var t="_."+e[0];r&e[1]&&!arrayIncludes(n,t)&&n.push(t)}),n.sort()}function setWrapToString(e,t,n){t+="";return setToString(e,insertWrapDetails(t,updateWrapDetails(getWrapDetails(t),n)))}var WRAP_BIND_FLAG$6=1,WRAP_BIND_KEY_FLAG$5=2,WRAP_CURRY_BOUND_FLAG$1=4,WRAP_CURRY_FLAG$5=8,WRAP_PARTIAL_FLAG$5=32,WRAP_PARTIAL_RIGHT_FLAG$2=64;function createRecurry(e,t,n,r,i,o,a,s,l,h){var p=t&WRAP_CURRY_FLAG$5,i=((t=(t|(p?WRAP_PARTIAL_FLAG$5:WRAP_PARTIAL_RIGHT_FLAG$2))&~(p?WRAP_PARTIAL_RIGHT_FLAG$2:WRAP_PARTIAL_FLAG$5))&WRAP_CURRY_BOUND_FLAG$1||(t&=~(WRAP_BIND_FLAG$6|WRAP_BIND_KEY_FLAG$5)),[e,t,i,p?o:void 0,p?a:void 0,p?void 0:o,p?void 0:a,s,l,h]),o=n.apply(void 0,i);return isLaziable(e)&&setData(o,i),o.placeholder=r,setWrapToString(o,e,t)}function getHolder(e){return e.placeholder}var MAX_SAFE_INTEGER$5=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var n=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$5:t)&&("number"==n||"symbol"!=n&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}var nativeMin$e=Math.min;function reorder(e,t){for(var n=e.length,r=nativeMin$e(t.length,n),i=copyArray(e);r--;){var o=t[r];e[r]=isIndex(o,n)?i[o]:void 0}return e}var PLACEHOLDER$1="__lodash_placeholder__";function replaceHolders(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==PLACEHOLDER$1||(e[n]=PLACEHOLDER$1,o[i++]=n)}return o}var WRAP_BIND_FLAG$5=1,WRAP_BIND_KEY_FLAG$4=2,WRAP_CURRY_FLAG$4=8,WRAP_CURRY_RIGHT_FLAG$2=16,WRAP_ARY_FLAG$3=128,WRAP_FLIP_FLAG$1=512;function createHybrid(a,s,l,h,p,u,c,d,g,f){var _=s&WRAP_ARY_FLAG$3,y=s&WRAP_BIND_FLAG$5,v=s&WRAP_BIND_KEY_FLAG$4,b=s&(WRAP_CURRY_FLAG$4|WRAP_CURRY_RIGHT_FLAG$2),m=s&WRAP_FLIP_FLAG$1,L=v?void 0:createCtor(a);return function e(){for(var t,n,r=arguments.length,i=Array(r),o=r;o--;)i[o]=arguments[o];return b&&(n=countHolders(i,t=getHolder(e))),h&&(i=composeArgs(i,h,p,b)),u&&(i=composeArgsRight(i,u,c,b)),r-=n,b&&r<f?(n=replaceHolders(i,t),createRecurry(a,s,createHybrid,e.placeholder,l,i,n,d,g,f-r)):(t=y?l:this,n=v?t[a]:a,r=i.length,d?i=reorder(i,d):m&&1<r&&i.reverse(),_&&g<r&&(i.length=g),(n=this&&this!==root&&this instanceof e?L||createCtor(n):n).apply(t,i))}}function createCurry(o,a,s){var l=createCtor(o);return function e(){for(var t=arguments.length,n=Array(t),r=t,i=getHolder(e);r--;)n[r]=arguments[r];i=t<3&&n[0]!==i&&n[t-1]!==i?[]:replaceHolders(n,i);return(t-=i.length)<s?createRecurry(o,a,createHybrid,e.placeholder,void 0,n,i,void 0,void 0,s-t):apply(this&&this!==root&&this instanceof e?l:o,this,n)}}var WRAP_BIND_FLAG$4=1;function createPartial(s,e,l,h){var p=e&WRAP_BIND_FLAG$4,u=createCtor(s);return function e(){for(var t=-1,n=arguments.length,r=-1,i=h.length,o=Array(i+n),a=this&&this!==root&&this instanceof e?u:s;++r<i;)o[r]=h[r];for(;n--;)o[r++]=arguments[++t];return apply(a,p?l:this,o)}}var PLACEHOLDER="__lodash_placeholder__",WRAP_BIND_FLAG$3=1,WRAP_BIND_KEY_FLAG$3=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG$3=8,WRAP_ARY_FLAG$2=128,WRAP_REARG_FLAG$2=256,nativeMin$d=Math.min;function mergeData(e,t){var n,r=e[1],i=t[1],o=r|i,a=i==WRAP_ARY_FLAG$2&&r==WRAP_CURRY_FLAG$3||i==WRAP_ARY_FLAG$2&&r==WRAP_REARG_FLAG$2&&e[7].length<=t[8]||i==(WRAP_ARY_FLAG$2|WRAP_REARG_FLAG$2)&&t[7].length<=t[8]&&r==WRAP_CURRY_FLAG$3;return(o<(WRAP_BIND_FLAG$3|WRAP_BIND_KEY_FLAG$3|WRAP_ARY_FLAG$2)||a)&&(i&WRAP_BIND_FLAG$3&&(e[2]=t[2],o|=r&WRAP_BIND_FLAG$3?0:WRAP_CURRY_BOUND_FLAG),(a=t[3])&&(n=e[3],e[3]=n?composeArgs(n,a,t[4]):a,e[4]=n?replaceHolders(e[3],PLACEHOLDER):t[4]),(a=t[5])&&(n=e[5],e[5]=n?composeArgsRight(n,a,t[6]):a,e[6]=n?replaceHolders(e[5],PLACEHOLDER):t[6]),(a=t[7])&&(e[7]=a),i&WRAP_ARY_FLAG$2&&(e[8]=null==e[8]?t[8]:nativeMin$d(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o),e}var FUNC_ERROR_TEXT$a="Expected a function",WRAP_BIND_FLAG$2=1,WRAP_BIND_KEY_FLAG$2=2,WRAP_CURRY_FLAG$2=8,WRAP_CURRY_RIGHT_FLAG$1=16,WRAP_PARTIAL_FLAG$4=32,WRAP_PARTIAL_RIGHT_FLAG$1=64,nativeMax$e=Math.max;function createWrap(e,t,n,r,i,o,a,s){var l,h,p,u=t&WRAP_BIND_KEY_FLAG$2;if(u||"function"==typeof e)return(l=r?r.length:0)||(t&=~(WRAP_PARTIAL_FLAG$4|WRAP_PARTIAL_RIGHT_FLAG$1),r=i=void 0),a=void 0===a?a:nativeMax$e(toInteger(a),0),s=void 0===s?s:toInteger(s),l-=i?i.length:0,t&WRAP_PARTIAL_RIGHT_FLAG$1&&(p=r,h=i,r=i=void 0),p=[e,t,n,r,i,p,h,o,a,s],(h=u?void 0:getData(e))&&mergeData(p,h),e=p[0],t=p[1],n=p[2],r=p[3],i=p[4],!(s=p[9]=void 0===p[9]?u?0:e.length:nativeMax$e(p[9]-l,0))&&t&(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1)&&(t&=~(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1)),o=t&&t!=WRAP_BIND_FLAG$2?t==WRAP_CURRY_FLAG$2||t==WRAP_CURRY_RIGHT_FLAG$1?createCurry(e,t,s):t!=WRAP_PARTIAL_FLAG$4&&t!=(WRAP_BIND_FLAG$2|WRAP_PARTIAL_FLAG$4)||i.length?createHybrid.apply(void 0,p):createPartial(e,t,n,r):createBind(e,t,n),setWrapToString((h?baseSetData:setData)(o,p),e,t);throw new TypeError(FUNC_ERROR_TEXT$a)}var WRAP_ARY_FLAG$1=128;function ary(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,createWrap(e,WRAP_ARY_FLAG$1,void 0,void 0,void 0,void 0,t)}function baseAssignValue(e,t,n){"__proto__"==t&&defineProperty?defineProperty(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function eq(e,t){return e===t||e!=e&&t!=t}var objectProto$n=Object.prototype,hasOwnProperty$k=objectProto$n.hasOwnProperty;function assignValue(e,t,n){var r=e[t];hasOwnProperty$k.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||baseAssignValue(e,t,n)}function copyObject(e,t,n,r){for(var i=!n,o=(n=n||{},-1),a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):void 0;(i?baseAssignValue:assignValue)(n,s,l=void 0===l?e[s]:l)}return n}var nativeMax$d=Math.max;function overRest(o,a,s){return a=nativeMax$d(void 0===a?o.length-1:a,0),function(){for(var e=arguments,t=-1,n=nativeMax$d(e.length-a,0),r=Array(n);++t<n;)r[t]=e[a+t];for(var t=-1,i=Array(a+1);++t<a;)i[t]=e[t];return i[a]=s(r),apply(o,this,i)}}function baseRest(e,t){return setToString(overRest(e,t,identity),e+"")}var MAX_SAFE_INTEGER$4=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER$4}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isIterateeCall(e,t,n){var r;return!!isObject(n)&&(!!("number"==(r=typeof t)?isArrayLike(n)&&isIndex(t,n.length):"string"==r&&t in n)&&eq(n[t],e))}function createAssigner(s){return baseRest(function(e,t){var n=-1,r=t.length,i=1<r?t[r-1]:void 0,o=2<r?t[2]:void 0,i=3<s.length&&"function"==typeof i?(r--,i):void 0;for(o&&isIterateeCall(t[0],t[1],o)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var a=t[n];a&&s(e,a,n,i)}return e})}var objectProto$m=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$m)}function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var argsTag$3="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$3}var objectProto$l=Object.prototype,hasOwnProperty$j=objectProto$l.hasOwnProperty,propertyIsEnumerable$1=objectProto$l.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$j.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")};function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",funcTag$1="[object Function]",mapTag$9="[object Map]",numberTag$4="[object Number]",objectTag$4="[object Object]",regexpTag$4="[object RegExp]",setTag$9="[object Set]",stringTag$4="[object String]",weakMapTag$3="[object WeakMap]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(t){return function(e){return t(e)}}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$4]=typedArrayTags[boolTag$4]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$4]=typedArrayTags[errorTag$3]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$9]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$4]=typedArrayTags[setTag$9]=typedArrayTags[stringTag$4]=typedArrayTags[weakMapTag$3]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e?e:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$k=Object.prototype,hasOwnProperty$i=objectProto$k.hasOwnProperty;function arrayLikeKeys(e,t){var n,r=isArray(e),i=!r&&isArguments(e),o=!r&&!i&&isBuffer(e),a=!r&&!i&&!o&&isTypedArray(e),s=r||i||o||a,l=s?baseTimes(e.length,String):[],h=l.length;for(n in e)!t&&!hasOwnProperty$i.call(e,n)||s&&("length"==n||o&&("offset"==n||"parent"==n)||a&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||isIndex(n,h))||l.push(n);return l}function overArg(t,n){return function(e){return t(n(e))}}var nativeKeys=overArg(Object.keys,Object),objectProto$j=Object.prototype,hasOwnProperty$h=objectProto$j.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t,n=[];for(t in Object(e))hasOwnProperty$h.call(e,t)&&"constructor"!=t&&n.push(t);return n}function keys(e){return(isArrayLike(e)?arrayLikeKeys:baseKeys)(e)}var objectProto$i=Object.prototype,hasOwnProperty$g=objectProto$i.hasOwnProperty,assign=createAssigner(function(e,t){if(isPrototype(t)||isArrayLike(t))copyObject(t,keys(t),e);else for(var n in t)hasOwnProperty$g.call(t,n)&&assignValue(e,n,t[n])});function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}var objectProto$h=Object.prototype,hasOwnProperty$f=objectProto$h.hasOwnProperty;function baseKeysIn(e){if(!isObject(e))return nativeKeysIn(e);var t,n=isPrototype(e),r=[];for(t in e)("constructor"!=t||!n&&hasOwnProperty$f.call(e,t))&&r.push(t);return r}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var assignIn=createAssigner(function(e,t){copyObject(t,keysIn(t),e)}),assignInWith=createAssigner(function(e,t,n,r){copyObject(t,keysIn(t),e,r)}),assignWith=createAssigner(function(e,t,n,r){copyObject(t,keys(t),e,r)}),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){var n;return!isArray(e)&&(!("number"!=(n=typeof e)&&"symbol"!=n&&"boolean"!=n&&null!=e&&!isSymbol(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t)))}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function hashGet(e){var t,n=this.__data__;return nativeCreate?(t=n[e])===HASH_UNDEFINED$2?void 0:t:hasOwnProperty$e.call(n,e)?n[e]:void 0}var objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$d.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto$5=Array.prototype,splice$2=arrayProto$5.splice;function listCacheDelete(e){var t=this.__data__,e=assocIndexOf(t,e);return!(e<0)&&(e==t.length-1?t.pop():splice$2.call(t,e,1),--this.size,!0)}function listCacheGet(e){var t=this.__data__,e=assocIndexOf(t,e);return e<0?void 0:t[e][1]}function listCacheHas(e){return-1<assocIndexOf(this.__data__,e)}function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){e=e.__data__;return isKeyable(t)?e["string"==typeof t?"string":"hash"]:e.map}function mapCacheDelete(e){e=getMapData(this,e).delete(e);return this.size-=e?1:0,e}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var n=getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$9="Expected a function";function memoize(r,i){if("function"!=typeof r||null!=i&&"function"!=typeof i)throw new TypeError(FUNC_ERROR_TEXT$9);function o(){var e=arguments,t=i?i.apply(this,e):e[0],n=o.cache;return n.has(t)?n.get(t):(e=r.apply(this,e),o.cache=n.set(t,e)||n,e)}return o.cache=new(memoize.Cache||MapCache),o}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var e=memoize(e,function(e){return t.size===MAX_MEMOIZE_SIZE&&t.clear(),e}),t=e.cache;return e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(rePropName,function(e,t,n,r){i.push(n?r.replace(reEscapeChar,"$1"):t||e)}),i});function toString(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray(e)?e:isKey(e,t)?[e]:stringToPath(toString(e))}var INFINITY$3=1/0;function toKey(e){var t;return"string"==typeof e||isSymbol(e)?e:"0"==(t=e+"")&&1/e==-INFINITY$3?"-0":t}function baseGet(e,t){for(var n=0,r=(t=castPath(t,e)).length;null!=e&&n<r;)e=e[toKey(t[n++])];return n&&n==r?e:void 0}function get(e,t,n){e=null==e?void 0:baseGet(e,t);return void 0===e?n:e}function baseAt(e,t){for(var n=-1,r=t.length,i=Array(r),o=null==e;++n<r;)i[n]=o?void 0:get(e,t[n]);return i}function arrayPush(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,n,r,i){var o=-1,a=e.length;for(n=n||isFlattenable,i=i||[];++o<a;){var s=e[o];0<t&&n(s)?1<t?baseFlatten(s,t-1,n,r,i):arrayPush(i,s):r||(i[i.length]=s)}return i}function flatten(e){return(null==e?0:e.length)?baseFlatten(e,1):[]}function flatRest(e){return setToString(overRest(e,void 0,flatten),e+"")}var at=flatRest(baseAt),getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$e=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$c=objectProto$e.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(e){return!(!isObjectLike(e)||baseGetTag(e)!=objectTag$3)&&(null===(e=getPrototype(e))||"function"==typeof(e=hasOwnProperty$c.call(e,"constructor")&&e.constructor)&&e instanceof e&&funcToString.call(e)==objectCtorString)}var domExcTag="[object DOMException]",errorTag$2="[object Error]";function isError(e){var t;return!!isObjectLike(e)&&((t=baseGetTag(e))==errorTag$2||t==domExcTag||"string"==typeof e.message&&"string"==typeof e.name&&!isPlainObject(e))}var attempt=baseRest(function(e,t){try{return apply(e,void 0,t)}catch(e){return isError(e)?e:new Error(e)}}),FUNC_ERROR_TEXT$8="Expected a function";function before(e,t){var n;if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$8);return e=toInteger(e),function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var WRAP_BIND_FLAG$1=1,WRAP_PARTIAL_FLAG$3=32,bind=baseRest(function(e,t,n){var r,i=WRAP_BIND_FLAG$1;return n.length&&(r=replaceHolders(n,getHolder(bind)),i|=WRAP_PARTIAL_FLAG$3),createWrap(e,i,t,n,r)}),bindAll=(bind.placeholder={},flatRest(function(t,e){return arrayEach(e,function(e){e=toKey(e),baseAssignValue(t,e,bind(t[e],t))}),t})),WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG$1=2,WRAP_PARTIAL_FLAG$2=32,bindKey=baseRest(function(e,t,n){var r,i=WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG$1;return n.length&&(r=replaceHolders(n,getHolder(bindKey)),i|=WRAP_PARTIAL_FLAG$2),createWrap(t,i,e,n,r)});function baseSlice(e,t,n){for(var r=-1,i=e.length,o=((n=i<n?i:n)<0&&(n+=i),i=n<(t=t<0?i<-t?0:i+t:t)?0:n-t>>>0,t>>>=0,Array(i));++r<i;)o[r]=e[r+t];return o}function castSlice(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&r<=n?e:baseSlice(e,t,n)}bindKey.placeholder={};var rsAstralRange$3="\\ud800-\\udfff",rsComboMarksRange$4="\\u0300-\\u036f",reComboHalfMarksRange$4="\\ufe20-\\ufe2f",rsComboSymbolsRange$4="\\u20d0-\\u20ff",rsComboRange$4=rsComboMarksRange$4+reComboHalfMarksRange$4+rsComboSymbolsRange$4,rsVarRange$3="\\ufe0e\\ufe0f",rsZWJ$3="\\u200d",reHasUnicode=RegExp("["+rsZWJ$3+rsAstralRange$3+rsComboRange$4+rsVarRange$3+"]");function hasUnicode(e){return reHasUnicode.test(e)}function asciiToArray(e){return e.split("")}var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f",rsAstral$1="["+rsAstralRange$2+"]",rsCombo$3="["+rsComboRange$3+"]",rsFitz$2="\\ud83c[\\udffb-\\udfff]",rsModifier$2="(?:"+rsCombo$3+"|"+rsFitz$2+")",rsNonAstral$2="[^"+rsAstralRange$2+"]",rsRegional$2="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$2="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$2="\\u200d",reOptMod$2=rsModifier$2+"?",rsOptVar$2="["+rsVarRange$2+"]?",rsOptJoin$2="(?:"+rsZWJ$2+"(?:"+[rsNonAstral$2,rsRegional$2,rsSurrPair$2].join("|")+")"+rsOptVar$2+reOptMod$2+")*",rsSeq$2=rsOptVar$2+reOptMod$2+rsOptJoin$2,rsSymbol$1="(?:"+[rsNonAstral$2+rsCombo$3+"?",rsCombo$3,rsRegional$2,rsSurrPair$2,rsAstral$1].join("|")+")",reUnicode$1=RegExp(rsFitz$2+"(?="+rsFitz$2+")|"+rsSymbol$1+rsSeq$2,"g");function unicodeToArray(e){return e.match(reUnicode$1)||[]}function stringToArray(e){return(hasUnicode(e)?unicodeToArray:asciiToArray)(e)}function createCaseFirst(r){return function(e){var t=hasUnicode(e=toString(e))?stringToArray(e):void 0,n=t?t[0]:e.charAt(0),t=t?castSlice(t,1).join(""):e.slice(1);return n[r]()+t}}var upperFirst=createCaseFirst("toUpperCase");function capitalize(e){return upperFirst(toString(e).toLowerCase())}function arrayReduce(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function basePropertyOf(t){return function(e){return null==t?void 0:t[e]}}var deburredLetters={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},deburrLetter=basePropertyOf(deburredLetters),reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2,rsCombo$2="["+rsComboRange$2+"]",reComboMark=RegExp(rsCombo$2,"g");function deburr(e){return(e=toString(e))&&e.replace(reLatin,deburrLetter).replace(reComboMark,"")}var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function asciiWords(e){return e.match(reAsciiWord)||[]}var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function hasUnicodeWord(e){return reHasUnicodeWord.test(e)}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange$1="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange,rsApos$1="['’]",rsBreak="["+rsBreakRange+"]",rsCombo$1="["+rsComboRange$1+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange$1+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1="(?:"+rsCombo$1+"|"+rsFitz$1+")",rsNonAstral$1="[^"+rsAstralRange$1+"]",rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ$1="\\u200d",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos$1+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos$1+"(?:D|LL|M|RE|S|T|VE))?",reOptMod$1=rsModifier$1+"?",rsOptVar$1="["+rsVarRange$1+"]?",rsOptJoin$1="(?:"+rsZWJ$1+"(?:"+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join("|")+")"+rsOptVar$1+reOptMod$1+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsEmoji="(?:"+[rsDingbat,rsRegional$1,rsSurrPair$1].join("|")+")"+rsSeq$1,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");function unicodeWords(e){return e.match(reUnicodeWord)||[]}function words(e,t,n){return e=toString(e),void 0===(t=n?void 0:t)?(hasUnicodeWord(e)?unicodeWords:asciiWords)(e):e.match(t)||[]}var rsApos="['’]",reApos=RegExp(rsApos,"g");function createCompounder(t){return function(e){return arrayReduce(words(deburr(e).replace(reApos,"")),t,"")}}var camelCase=createCompounder(function(e,t,n){return t=t.toLowerCase(),e+(n?capitalize(t):t)});function castArray(){var e;return arguments.length?isArray(e=arguments[0])?e:[e]:[]}var nativeIsFinite$1=root.isFinite,nativeMin$c=Math.min;function createRound(e){var r=Math[e];return function(e,t){var n;return e=toNumber(e),(t=null==t?0:nativeMin$c(toInteger(t),292))&&nativeIsFinite$1(e)?(n=(toString(e)+"e").split("e"),+((n=(toString(r(n[0]+"e"+(+n[1]+t)))+"e").split("e"))[0]+"e"+(+n[1]-t))):r(e)}}var ceil=createRound("ceil");function chain(e){e=lodash(e);return e.__chain__=!0,e}var nativeCeil$3=Math.ceil,nativeMax$c=Math.max;function chunk(e,t,n){t=(n?isIterateeCall(e,t,n):void 0===t)?1:nativeMax$c(toInteger(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=Array(nativeCeil$3(r/t));i<r;)a[o++]=baseSlice(e,i,i+=t);return a}function baseClamp(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=t<=e?e:t)),e}function clamp(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=toNumber(n))==n?n:0),void 0!==t&&(t=(t=toNumber(t))==t?t:0),baseClamp(toNumber(e),t,n)}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$2=200;function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!Map||r.length<LARGE_ARRAY_SIZE$2-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new MapCache(r)}return n.set(e,t),this.size=n.size,this}function Stack(e){e=this.__data__=new ListCache(e);this.size=e.size}function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}function baseAssignIn(e,t){return e&&copyObject(t,keysIn(t),e)}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(e,t){return t?e.slice():(t=e.length,t=allocUnsafe?allocUnsafe(t):new e.constructor(t),e.copy(t),t)}function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function stubArray(){return[]}var objectProto$d=Object.prototype,propertyIsEnumerable=objectProto$d.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return null==t?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(e){return propertyIsEnumerable.call(t,e)}))}:stubArray;function copySymbols(e,t){return copyObject(e,getSymbols(e),t)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush(t,getSymbols(e)),e=getPrototype(e);return t}:stubArray;function copySymbolsIn(e,t){return copyObject(e,getSymbolsIn(e),t)}function baseGetAllKeys(e,t,n){t=t(e);return isArray(e)?t:arrayPush(t,n(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn,getSymbolsIn)}var DataView=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set=getNative(root,"Set"),mapTag$8="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$8="[object Set]",weakMapTag$2="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag,getTag$1=getTag=DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$3||Map&&getTag(new Map)!=mapTag$8||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag$8||WeakMap&&getTag(new WeakMap)!=weakMapTag$2?function(e){var t=baseGetTag(e),e=t==objectTag$2?e.constructor:void 0,e=e?toSource(e):"";if(e)switch(e){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$8;case promiseCtorString:return promiseTag;case setCtorString:return setTag$8;case weakMapCtorString:return weakMapTag$2}return t}:getTag,objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function initCloneArray(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$b.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Uint8Array=root.Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}function cloneDataView(e,t){t=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags$1.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto$1=Symbol?Symbol.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}function cloneTypedArray(e,t){t=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var boolTag$3="[object Boolean]",dateTag$3="[object Date]",mapTag$7="[object Map]",numberTag$3="[object Number]",regexpTag$3="[object RegExp]",setTag$7="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case arrayBufferTag$3:return cloneArrayBuffer(e);case boolTag$3:case dateTag$3:return new r(+e);case dataViewTag$2:return cloneDataView(e,n);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,n);case mapTag$7:return new r;case numberTag$3:case stringTag$3:return new r(e);case regexpTag$3:return cloneRegExp(e);case setTag$7:return new r;case symbolTag$2:return cloneSymbol(e)}}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var mapTag$6="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag$1(e)==mapTag$6}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$6="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag$1(e)==setTag$6}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$7=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$5=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$5="[object Map]",numberTag$2="[object Number]",objectTag$1="[object Object]",regexpTag$2="[object RegExp]",setTag$5="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$1="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(n,r,i,e,t,o){var a,s=r&CLONE_DEEP_FLAG$7,l=r&CLONE_FLAT_FLAG$1,h=r&CLONE_SYMBOLS_FLAG$5;if(void 0===(a=i?t?i(n,e,t,o):i(n):a)){if(!isObject(n))return n;e=isArray(n);if(e){if(a=initCloneArray(n),!s)return copyArray(n,a)}else{var p=getTag$1(n),u=p==funcTag||p==genTag;if(isBuffer(n))return cloneBuffer(n,s);if(p==objectTag$1||p==argsTag$1||u&&!t){if(a=l||u?{}:initCloneObject(n),!s)return l?copySymbolsIn(n,baseAssignIn(a,n)):copySymbols(n,baseAssign(a,n))}else{if(!cloneableTags[p])return t?n:{};a=initCloneByTag(n,p,s)}}u=(o=o||new Stack).get(n);if(u)return u;o.set(n,a),isSet(n)?n.forEach(function(e){a.add(baseClone(e,r,i,e,n,o))}):isMap(n)&&n.forEach(function(e,t){a.set(t,baseClone(e,r,i,t,n,o))});var c=e?void 0:(h?l?getAllKeysIn:getAllKeys:l?keysIn:keys)(n);arrayEach(c||n,function(e,t){c&&(e=n[t=e]),assignValue(a,t,baseClone(e,r,i,t,n,o))})}return a}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$5]=cloneableTags[numberTag$2]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$5]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag$1]=!1;var CLONE_SYMBOLS_FLAG$4=4;function clone(e){return baseClone(e,CLONE_SYMBOLS_FLAG$4)}var CLONE_DEEP_FLAG$6=1,CLONE_SYMBOLS_FLAG$3=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG$6|CLONE_SYMBOLS_FLAG$3)}var CLONE_DEEP_FLAG$5=1,CLONE_SYMBOLS_FLAG$2=4;function cloneDeepWith(e,t){return baseClone(e,CLONE_DEEP_FLAG$5|CLONE_SYMBOLS_FLAG$2,t="function"==typeof t?t:void 0)}var CLONE_SYMBOLS_FLAG$1=4;function cloneWith(e,t){return baseClone(e,CLONE_SYMBOLS_FLAG$1,t="function"==typeof t?t:void 0)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}function concat(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return arrayPush(isArray(n)?copyArray(n):[n],baseFlatten(t,1))}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG$5,s=e.length,l=t.length;if(s!=l&&!(a&&s<l))return!1;var l=o.get(e),h=o.get(t);if(l&&h)return l==t&&h==e;var p=-1,u=!0,c=n&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(e,t),o.set(t,e);++p<s;){var d,g=e[p],f=t[p];if(void 0!==(d=r?a?r(f,g,p,t,e,o):r(g,f,p,e,t,o):d)){if(d)continue;u=!1;break}if(c){if(!arraySome(t,function(e,t){if(!cacheHas(c,t)&&(g===e||i(g,e,n,r,o)))return c.push(t)})){u=!1;break}}else if(g!==f&&!i(g,f,n,r,o)){u=!1;break}}return o.delete(e),o.delete(t),u}function mapToArray(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag="[object Error]",mapTag$4="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$4="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,n,r,i,o,a){switch(n){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$1:return e.byteLength==t.byteLength&&o(new Uint8Array(e),new Uint8Array(t))?!0:!1;case boolTag$1:case dateTag$1:case numberTag$1:return eq(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag$1:case stringTag$1:return e==t+"";case mapTag$4:var s=mapToArray;case setTag$4:s=s||setToArray;if(e.size!=t.size&&!(r&COMPARE_PARTIAL_FLAG$4))return!1;var l=a.get(e);if(l)return l==t;r|=COMPARE_UNORDERED_FLAG$2,a.set(e,t);l=equalArrays(s(e),s(t),r,i,o,a);return a.delete(e),l;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty;function equalObjects(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG$3,s=getAllKeys(e),l=s.length;if(l!=getAllKeys(t).length&&!a)return!1;for(var h=l;h--;){var p=s[h];if(!(a?p in t:hasOwnProperty$a.call(t,p)))return!1}var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;for(var d=!0,g=(o.set(e,t),o.set(t,e),a);++h<l;){var f,_=e[p=s[h]],y=t[p];if(!(void 0===(f=r?a?r(y,_,p,t,e,o):r(_,y,p,e,t,o):f)?_===y||i(_,y,n,r,o):f)){d=!1;break}g=g||"constructor"==p}return d&&!g&&(u=e.constructor)!=(c=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof u&&u instanceof u&&"function"==typeof c&&c instanceof c)&&(d=!1),o.delete(e),o.delete(t),d}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseIsEqualDeep(e,t,n,r,i,o){var a=isArray(e),s=isArray(t),l=a?arrayTag:getTag$1(e),s=s?arrayTag:getTag$1(t),h=(l=l==argsTag?objectTag:l)==objectTag,p=(s=s==argsTag?objectTag:s)==objectTag,s=l==s;if(s&&isBuffer(e)){if(!isBuffer(t))return!1;h=!(a=!0)}if(s&&!h)return o=o||new Stack,a||isTypedArray(e)?equalArrays(e,t,n,r,i,o):equalByTag(e,t,l,n,r,i,o);if(!(n&COMPARE_PARTIAL_FLAG$2)){a=h&&hasOwnProperty$9.call(e,"__wrapped__"),l=p&&hasOwnProperty$9.call(t,"__wrapped__");if(a||l)return i(a?e.value():e,l?t.value():t,n,r,o=o||new Stack)}return!!s&&equalObjects(e,t,n,r,i,o=o||new Stack)}function baseIsEqual(e,t,n,r,i){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,n,r,baseIsEqual,i))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],h=e[l],p=s[1];if(a&&s[2]){if(void 0===h&&!(l in e))return!1}else{var u,c=new Stack;if(!(void 0===(u=r?r(h,p,l,e,t,c):u)?baseIsEqual(p,h,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,r,c):u))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject(e)}function getMatchData(e){for(var t=keys(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,isStrictComparable(i)]}return t}function matchesStrictComparable(t,n){return function(e){return null!=e&&(e[t]===n&&(void 0!==n||t in Object(e)))}}function baseMatches(t){var n=getMatchData(t);return 1==n.length&&n[0][2]?matchesStrictComparable(n[0][0],n[0][1]):function(e){return e===t||baseIsMatch(e,t,n)}}function baseHasIn(e,t){return null!=e&&t in Object(e)}function hasPath(e,t,n){for(var r=-1,i=(t=castPath(t,e)).length,o=!1;++r<i;){var a=toKey(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&isLength(i)&&isIndex(a,i)&&(isArray(e)||isArguments(e))}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(n,r){return isKey(n)&&isStrictComparable(r)?matchesStrictComparable(toKey(n),r):function(e){var t=get(e,n);return void 0===t&&t===r?hasIn(e,n):baseIsEqual(r,t,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function basePropertyDeep(t){return function(e){return baseGet(e,t)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?isArray(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}var FUNC_ERROR_TEXT$7="Expected a function";function cond(r){var i=null==r?0:r.length,t=baseIteratee;return r=i?arrayMap(r,function(e){if("function"!=typeof e[1])throw new TypeError(FUNC_ERROR_TEXT$7);return[t(e[0]),e[1]]}):[],baseRest(function(e){for(var t=-1;++t<i;){var n=r[t];if(apply(n[0],this,e))return apply(n[1],this,e)}})}function baseConformsTo(e,t,n){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}function baseConforms(t){var n=keys(t);return function(e){return baseConformsTo(e,t,n)}}var CLONE_DEEP_FLAG$4=1;function conforms(e){return baseConforms(baseClone(e,CLONE_DEEP_FLAG$4))}function conformsTo(e,t){return null==t||baseConformsTo(e,t,keys(t))}function arrayAggregator(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function createBaseFor(l){return function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[l?a:++r];if(!1===t(i[s],s,i))break}return e}}var baseFor=createBaseFor();function baseForOwn(e,t){return e&&baseFor(e,t,keys)}function createBaseEach(o,a){return function(e,t){if(null!=e){if(!isArrayLike(e))return o(e,t);for(var n=e.length,r=a?n:-1,i=Object(e);(a?r--:++r<n)&&!1!==t(i[r],r,i););}return e}}var baseEach=createBaseEach(baseForOwn);function baseAggregator(e,r,i,o){return baseEach(e,function(e,t,n){r(o,e,i(e),n)}),o}function createAggregator(i,o){return function(e,t){var n=isArray(e)?arrayAggregator:baseAggregator,r=o?o():{};return n(e,i,baseIteratee(t),r)}}var objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty,countBy=createAggregator(function(e,t,n){hasOwnProperty$8.call(e,n)?++e[n]:baseAssignValue(e,n,1)});function create(e,t){e=baseCreate(e);return null==t?e:baseAssign(e,t)}var WRAP_CURRY_FLAG$1=8;function curry(e,t,n){e=createWrap(e,WRAP_CURRY_FLAG$1,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return e.placeholder=curry.placeholder,e}curry.placeholder={};var WRAP_CURRY_RIGHT_FLAG=16;function curryRight(e,t,n){e=createWrap(e,WRAP_CURRY_RIGHT_FLAG,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return e.placeholder=curryRight.placeholder,e}curryRight.placeholder={};var now=function(){return root.Date.now()},FUNC_ERROR_TEXT$6="Expected a function",nativeMax$b=Math.max,nativeMin$b=Math.min;function debounce(r,n,e){var i,o,a,s,l,h,p=0,u=!1,c=!1,t=!0;if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT$6);function d(e){var t=i,n=o;return i=o=void 0,p=e,s=r.apply(n,t)}function g(e){var t=e-h;return void 0===h||n<=t||t<0||c&&a<=e-p}function f(){var e,t=now();if(g(t))return _(t);l=setTimeout(f,(e=n-((t=t)-h),c?nativeMin$b(e,a-(t-p)):e))}function _(e){return l=void 0,t&&i?d(e):(i=o=void 0,s)}function y(){var e=now(),t=g(e);if(i=arguments,o=this,h=e,t){if(void 0===l)return p=e=h,l=setTimeout(f,n),u?d(e):s;if(c)return clearTimeout(l),l=setTimeout(f,n),d(h)}return void 0===l&&(l=setTimeout(f,n)),s}return n=toNumber(n)||0,isObject(e)&&(u=!!e.leading,c="maxWait"in e,a=c?nativeMax$b(toNumber(e.maxWait)||0,n):a,t="trailing"in e?!!e.trailing:t),y.cancel=function(){void 0!==l&&clearTimeout(l),i=h=o=l=void(p=0)},y.flush=function(){return void 0===l?s:_(now())},y}function defaultTo(e,t){return null==e||e!=e?t:e}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty,defaults=baseRest(function(e,t){e=Object(e);var n=-1,r=t.length,i=2<r?t[2]:void 0;for(i&&isIterateeCall(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=keysIn(o),s=-1,l=a.length;++s<l;){var h=a[s],p=e[h];(void 0===p||eq(p,objectProto$8[h])&&!hasOwnProperty$7.call(e,h))&&(e[h]=o[h])}return e});function assignMergeValue(e,t,n){(void 0===n||eq(e[t],n))&&(void 0!==n||t in e)||baseAssignValue(e,t,n)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function toPlainObject(e){return copyObject(e,keysIn(e))}function baseMergeDeep(e,t,n,r,i,o,a){var s,l,h,p=safeGet(e,n),u=safeGet(t,n),c=a.get(u);c||((t=void 0===(c=o?o(p,u,n+"",e,t,a):void 0))&&(l=!(s=isArray(u))&&isBuffer(u),h=!s&&!l&&isTypedArray(u),c=u,s||l||h?c=isArray(p)?p:isArrayLikeObject(p)?copyArray(p):l?cloneBuffer(u,!(t=!1)):h?cloneTypedArray(u,!(t=!1)):[]:isPlainObject(u)||isArguments(u)?isArguments(c=p)?c=toPlainObject(p):isObject(p)&&!isFunction(p)||(c=initCloneObject(u)):t=!1),t&&(a.set(u,c),i(c,u,r,o,a),a.delete(u))),assignMergeValue(e,n,c)}function baseMerge(r,i,o,a,s){r!==i&&baseFor(i,function(e,t){var n;s=s||new Stack,isObject(e)?baseMergeDeep(r,i,t,o,baseMerge,a,s):(n=a?a(safeGet(r,t),e,t+"",r,i,s):void 0,assignMergeValue(r,t,n=void 0===n?e:n))},keysIn)}function customDefaultsMerge(e,t,n,r,i,o){return isObject(e)&&isObject(t)&&(o.set(t,e),baseMerge(e,t,void 0,customDefaultsMerge,o),o.delete(t)),e}var mergeWith=createAssigner(function(e,t,n,r){baseMerge(e,t,n,r)}),defaultsDeep=baseRest(function(e){return e.push(void 0,customDefaultsMerge),apply(mergeWith,void 0,e)}),FUNC_ERROR_TEXT$5="Expected a function";function baseDelay(e,t,n){if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$5);return setTimeout(function(){e.apply(void 0,n)},t)}var defer=baseRest(function(e,t){return baseDelay(e,1,t)}),delay=baseRest(function(e,t,n){return baseDelay(e,toNumber(t)||0,n)});function arrayIncludesWith(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(e,t,n,r){var i=-1,o=arrayIncludes,a=!0,s=e.length,l=[],h=t.length;if(s){n&&(t=arrayMap(t,baseUnary(n))),r?(o=arrayIncludesWith,a=!1):t.length>=LARGE_ARRAY_SIZE$1&&(o=cacheHas,a=!1,t=new SetCache(t));e:for(;++i<s;){var p=e[i],u=null==n?p:n(p),p=r||0!==p?p:0;if(a&&u==u){for(var c=h;c--;)if(t[c]===u)continue e;l.push(p)}else o(t,u,r)||l.push(p)}}return l}var difference=baseRest(function(e,t){return isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0)):[]});function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var differenceBy=baseRest(function(e,t){var n=last(t);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0),baseIteratee(n)):[]}),differenceWith=baseRest(function(e,t){var n=last(t);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0),void 0,n):[]}),divide=createMathOperation(function(e,t){return e/t},1);function drop(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,(t=n||void 0===t?1:toInteger(t))<0?0:t,r):[]}function dropRight(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,0,(t=r-(t=n||void 0===t?1:toInteger(t)))<0?0:t):[]}function baseWhile(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?baseSlice(e,r?0:o,r?o+1:i):baseSlice(e,r?o+1:0,r?i:o)}function dropRightWhile(e,t){return e&&e.length?baseWhile(e,baseIteratee(t),!0,!0):[]}function dropWhile(e,t){return e&&e.length?baseWhile(e,baseIteratee(t),!0):[]}function castFunction(e){return"function"==typeof e?e:identity}function forEach(e,t){return(isArray(e)?arrayEach:baseEach)(e,castFunction(t))}function arrayEachRight(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var baseForRight=createBaseFor(!0);function baseForOwnRight(e,t){return e&&baseForRight(e,t,keys)}var baseEachRight=createBaseEach(baseForOwnRight,!0);function forEachRight(e,t){return(isArray(e)?arrayEachRight:baseEachRight)(e,castFunction(t))}function endsWith(e,t,n){e=toString(e),t=baseToString(t);var r=e.length,r=n=void 0===n?r:baseClamp(toInteger(n),0,r);return 0<=(n-=t.length)&&e.slice(n,r)==t}function baseToPairs(t,e){return arrayMap(e,function(e){return[e,t[e]]})}function setToPairs(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}var mapTag$3="[object Map]",setTag$3="[object Set]";function createToPairs(n){return function(e){var t=getTag$1(e);return t==mapTag$3?mapToArray(e):t==setTag$3?setToPairs(e):baseToPairs(e,n(e))}}var toPairs=createToPairs(keys),toPairsIn=createToPairs(keysIn),htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=basePropertyOf(htmlEscapes),reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape$1(e){return(e=toString(e))&&reHasUnescapedHtml.test(e)?e.replace(reUnescapedHtml,escapeHtmlChar):e}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);function escapeRegExp(e){return(e=toString(e))&&reHasRegExpChar.test(e)?e.replace(reRegExpChar,"\\$&"):e}function arrayEvery(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function baseEvery(e,r){var i=!0;return baseEach(e,function(e,t,n){return i=!!r(e,t,n)}),i}function every(e,t,n){return(isArray(e)?arrayEvery:baseEvery)(e,baseIteratee(t=n&&isIterateeCall(e,t,n)?void 0:t))}var MAX_ARRAY_LENGTH$5=4294967295;function toLength(e){return e?baseClamp(toInteger(e),0,MAX_ARRAY_LENGTH$5):0}function baseFill(e,t,n,r){var i=e.length;for((n=toInteger(n))<0&&(n=i<-n?0:i+n),(r=void 0===r||i<r?i:toInteger(r))<0&&(r+=i),r=r<n?0:toLength(r);n<r;)e[n++]=t;return e}function fill(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(n=0,r=i),baseFill(e,t,n,r)):[]}function baseFilter(e,r){var i=[];return baseEach(e,function(e,t,n){r(e,t,n)&&i.push(e)}),i}function filter(e,t){return(isArray(e)?arrayFilter:baseFilter)(e,baseIteratee(t))}function createFind(o){return function(e,t,n){var r,i=Object(e),t=(isArrayLike(e)||(r=baseIteratee(t),e=keys(e),t=function(e){return r(i[e],e,i)}),o(e,t,n));return-1<t?i[r?e[t]:t]:void 0}}var nativeMax$a=Math.max;function findIndex(e,t,n){var r=null==e?0:e.length;return r?((n=null==n?0:toInteger(n))<0&&(n=nativeMax$a(r+n,0)),baseFindIndex(e,baseIteratee(t),n)):-1}var find=createFind(findIndex);function baseFindKey(e,r,t){var i;return t(e,function(e,t,n){if(r(e,t,n))return i=t,!1}),i}function findKey(e,t){return baseFindKey(e,baseIteratee(t),baseForOwn)}var nativeMax$9=Math.max,nativeMin$a=Math.min;function findLastIndex(e,t,n){var r,i=null==e?0:e.length;return i?(r=i-1,void 0!==n&&(r=toInteger(n),r=n<0?nativeMax$9(i+r,0):nativeMin$a(r,i-1)),baseFindIndex(e,baseIteratee(t),r,!0)):-1}var findLast=createFind(findLastIndex);function findLastKey(e,t){return baseFindKey(e,baseIteratee(t),baseForOwnRight)}function head(e){return e&&e.length?e[0]:void 0}function baseMap(e,r){var i=-1,o=isArrayLike(e)?Array(e.length):[];return baseEach(e,function(e,t,n){o[++i]=r(e,t,n)}),o}function map(e,t){return(isArray(e)?arrayMap:baseMap)(e,baseIteratee(t))}function flatMap(e,t){return baseFlatten(map(e,t),1)}var INFINITY$2=1/0;function flatMapDeep(e,t){return baseFlatten(map(e,t),INFINITY$2)}function flatMapDepth(e,t,n){return n=void 0===n?1:toInteger(n),baseFlatten(map(e,t),n)}var INFINITY$1=1/0;function flattenDeep(e){return(null==e?0:e.length)?baseFlatten(e,INFINITY$1):[]}function flattenDepth(e,t){return(null==e?0:e.length)?baseFlatten(e,t=void 0===t?1:toInteger(t)):[]}var WRAP_FLIP_FLAG=512;function flip(e){return createWrap(e,WRAP_FLIP_FLAG)}var floor=createRound("floor"),FUNC_ERROR_TEXT$4="Expected a function",WRAP_CURRY_FLAG=8,WRAP_PARTIAL_FLAG$1=32,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG$1=256;function createFlow(l){return flatRest(function(i){var o=i.length,e=o,t=LodashWrapper.prototype.thru;for(l&&i.reverse();e--;){var n=i[e];if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT$4);t&&!s&&"wrapper"==getFuncName(n)&&(s=new LodashWrapper([],!0))}for(e=s?e:o;++e<o;)var r=getFuncName(n=i[e]),a="wrapper"==r?getData(n):void 0,s=a&&isLaziable(a[0])&&a[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG$1|WRAP_REARG_FLAG$1)&&!a[4].length&&1==a[9]?s[getFuncName(a[0])].apply(s,a[3]):1==n.length&&isLaziable(n)?s[r]():s.thru(n);return function(){var e=arguments,t=e[0];if(s&&1==e.length&&isArray(t))return s.plant(t).value();for(var n=0,r=o?i[n].apply(this,e):t;++n<o;)r=i[n].call(this,r);return r}})}var flow=createFlow(),flowRight=createFlow(!0);function forIn(e,t){return null==e?e:baseFor(e,castFunction(t),keysIn)}function forInRight(e,t){return null==e?e:baseForRight(e,castFunction(t),keysIn)}function forOwn(e,t){return e&&baseForOwn(e,castFunction(t))}function forOwnRight(e,t){return e&&baseForOwnRight(e,castFunction(t))}function fromPairs(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}function baseFunctions(t,e){return arrayFilter(e,function(e){return isFunction(t[e])})}function functions(e){return null==e?[]:baseFunctions(e,keys(e))}function functionsIn(e){return null==e?[]:baseFunctions(e,keysIn(e))}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty,groupBy=createAggregator(function(e,t,n){hasOwnProperty$6.call(e,n)?e[n].push(t):baseAssignValue(e,n,[t])});function baseGt(e,t){return t<e}function createRelationalOperation(n){return function(e,t){return"string"==typeof e&&"string"==typeof t||(e=toNumber(e),t=toNumber(t)),n(e,t)}}var gt=createRelationalOperation(baseGt),gte=createRelationalOperation(function(e,t){return t<=e}),objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseHas(e,t){return null!=e&&hasOwnProperty$5.call(e,t)}function has(e,t){return null!=e&&hasPath(e,t,baseHas)}var nativeMax$8=Math.max,nativeMin$9=Math.min;function baseInRange(e,t,n){return e>=nativeMin$9(t,n)&&e<nativeMax$8(t,n)}function inRange(e,t,n){return t=toFinite(t),void 0===n?(n=t,t=0):n=toFinite(n),baseInRange(e=toNumber(e),t,n)}var stringTag="[object String]";function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&baseGetTag(e)==stringTag}function baseValues(t,e){return arrayMap(e,function(e){return t[e]})}function values(e){return null==e?[]:baseValues(e,keys(e))}var nativeMax$7=Math.max;function includes(e,t,n,r){e=isArrayLike(e)?e:values(e),n=n&&!r?toInteger(n):0;r=e.length;return n<0&&(n=nativeMax$7(r+n,0)),isString(e)?n<=r&&-1<e.indexOf(t,n):!!r&&-1<baseIndexOf(e,t,n)}var nativeMax$6=Math.max;function indexOf(e,t,n){var r=null==e?0:e.length;return r?baseIndexOf(e,t,e=(e=null==n?0:toInteger(n))<0?nativeMax$6(r+e,0):e):-1}function initial(e){return(null==e?0:e.length)?baseSlice(e,0,-1):[]}var nativeMin$8=Math.min;function baseIntersection(e,t,n){for(var r=n?arrayIncludesWith:arrayIncludes,i=e[0].length,o=e.length,a=o,s=Array(o),l=1/0,h=[];a--;){var p=e[a];a&&t&&(p=arrayMap(p,baseUnary(t))),l=nativeMin$8(p.length,l),s[a]=!n&&(t||120<=i&&120<=p.length)?new SetCache(a&&p):void 0}var p=e[0],u=-1,c=s[0];e:for(;++u<i&&h.length<l;){var d=p[u],g=t?t(d):d,d=n||0!==d?d:0;if(!(c?cacheHas(c,g):r(h,g,n))){for(a=o;--a;){var f=s[a];if(!(f?cacheHas(f,g):r(e[a],g,n)))continue e}c&&c.push(g),h.push(d)}}return h}function castArrayLikeObject(e){return isArrayLikeObject(e)?e:[]}var intersection=baseRest(function(e){var t=arrayMap(e,castArrayLikeObject);return t.length&&t[0]===e[0]?baseIntersection(t):[]}),intersectionBy=baseRest(function(e){var t=last(e),n=arrayMap(e,castArrayLikeObject);return t===last(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?baseIntersection(n,baseIteratee(t)):[]}),intersectionWith=baseRest(function(e){var t=last(e),n=arrayMap(e,castArrayLikeObject);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?baseIntersection(n,void 0,t):[]});function baseInverter(e,r,i,o){return baseForOwn(e,function(e,t,n){r(o,i(e),t,n)}),o}function createInverter(n,r){return function(e,t){return baseInverter(e,n,r(t),{})}}var objectProto$5=Object.prototype,nativeObjectToString$1=objectProto$5.toString,invert=createInverter(function(e,t,n){e[t=null!=t&&"function"!=typeof t.toString?nativeObjectToString$1.call(t):t]=n},constant(identity)),objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty,nativeObjectToString=objectProto$4.toString,invertBy=createInverter(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=nativeObjectToString.call(t)),hasOwnProperty$4.call(e,t)?e[t].push(n):e[t]=[n]},baseIteratee);function parent(e,t){return t.length<2?e:baseGet(e,baseSlice(t,0,-1))}function baseInvoke(e,t,n){t=null==(e=parent(e,t=castPath(t,e)))?e:e[toKey(last(t))];return null==t?void 0:apply(t,e,n)}var invoke=baseRest(baseInvoke),invokeMap=baseRest(function(e,t,n){var r=-1,i="function"==typeof t,o=isArrayLike(e)?Array(e.length):[];return baseEach(e,function(e){o[++r]=i?apply(t,e,n):baseInvoke(e,t,n)}),o}),arrayBufferTag="[object ArrayBuffer]";function baseIsArrayBuffer(e){return isObjectLike(e)&&baseGetTag(e)==arrayBufferTag}var nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer,isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):baseIsArrayBuffer,boolTag="[object Boolean]";function isBoolean(e){return!0===e||!1===e||isObjectLike(e)&&baseGetTag(e)==boolTag}var dateTag="[object Date]";function baseIsDate(e){return isObjectLike(e)&&baseGetTag(e)==dateTag}var nodeIsDate=nodeUtil&&nodeUtil.isDate,isDate=nodeIsDate?baseUnary(nodeIsDate):baseIsDate;function isElement(e){return isObjectLike(e)&&1===e.nodeType&&!isPlainObject(e)}var mapTag$2="[object Map]",setTag$2="[object Set]",objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function isEmpty(e){if(null!=e){if(isArrayLike(e)&&(isArray(e)||"string"==typeof e||"function"==typeof e.splice||isBuffer(e)||isTypedArray(e)||isArguments(e)))return!e.length;var t,n=getTag$1(e);if(n==mapTag$2||n==setTag$2)return!e.size;if(isPrototype(e))return!baseKeys(e).length;for(t in e)if(hasOwnProperty$3.call(e,t))return!1}return!0}function isEqual(e,t){return baseIsEqual(e,t)}function isEqualWith(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?baseIsEqual(e,t,void 0,n):!!r}var nativeIsFinite=root.isFinite;function isFinite(e){return"number"==typeof e&&nativeIsFinite(e)}function isInteger(e){return"number"==typeof e&&e==toInteger(e)}function isMatch(e,t){return e===t||baseIsMatch(e,t,getMatchData(t))}function isMatchWith(e,t,n){return n="function"==typeof n?n:void 0,baseIsMatch(e,t,getMatchData(t),n)}var numberTag="[object Number]";function isNumber(e){return"number"==typeof e||isObjectLike(e)&&baseGetTag(e)==numberTag}function isNaN(e){return isNumber(e)&&e!=+e}var isMaskable=coreJsData?isFunction:stubFalse,CORE_ERROR_TEXT="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function isNative(e){if(isMaskable(e))throw new Error(CORE_ERROR_TEXT);return baseIsNative(e)}function isNil(e){return null==e}function isNull(e){return null===e}var regexpTag="[object RegExp]";function baseIsRegExp(e){return isObjectLike(e)&&baseGetTag(e)==regexpTag}var nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp,MAX_SAFE_INTEGER$3=9007199254740991;function isSafeInteger(e){return isInteger(e)&&-MAX_SAFE_INTEGER$3<=e&&e<=MAX_SAFE_INTEGER$3}function isUndefined(e){return void 0===e}var weakMapTag="[object WeakMap]";function isWeakMap(e){return isObjectLike(e)&&getTag$1(e)==weakMapTag}var weakSetTag="[object WeakSet]";function isWeakSet(e){return isObjectLike(e)&&baseGetTag(e)==weakSetTag}var CLONE_DEEP_FLAG$3=1;function iteratee(e){return baseIteratee("function"==typeof e?e:baseClone(e,CLONE_DEEP_FLAG$3))}var arrayProto$4=Array.prototype,nativeJoin=arrayProto$4.join;function join(e,t){return null==e?"":nativeJoin.call(e,t)}var kebabCase=createCompounder(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),keyBy=createAggregator(function(e,t,n){baseAssignValue(e,n,t)});function strictLastIndexOf(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}var nativeMax$5=Math.max,nativeMin$7=Math.min;function lastIndexOf(e,t,n){var r,i=null==e?0:e.length;return i?(r=i,void 0!==n&&(r=(r=toInteger(n))<0?nativeMax$5(i+r,0):nativeMin$7(r,i-1)),t==t?strictLastIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r,!0)):-1}var lowerCase=createCompounder(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),lowerFirst=createCaseFirst("toLowerCase");function baseLt(e,t){return e<t}var lt=createRelationalOperation(baseLt),lte=createRelationalOperation(function(e,t){return e<=t});function mapKeys(e,r){var i={};return r=baseIteratee(r),baseForOwn(e,function(e,t,n){baseAssignValue(i,r(e,t,n),e)}),i}function mapValues(e,r){var i={};return r=baseIteratee(r),baseForOwn(e,function(e,t,n){baseAssignValue(i,t,r(e,t,n))}),i}var CLONE_DEEP_FLAG$2=1;function matches(e){return baseMatches(baseClone(e,CLONE_DEEP_FLAG$2))}var CLONE_DEEP_FLAG$1=1;function matchesProperty(e,t){return baseMatchesProperty(e,baseClone(t,CLONE_DEEP_FLAG$1))}function baseExtremum(e,t,n){for(var r=-1,i=e.length;++r<i;){var o,a,s=e[r],l=t(s);null!=l&&(void 0===o?l==l&&!isSymbol(l):n(l,o))&&(o=l,a=s)}return a}function max(e){return e&&e.length?baseExtremum(e,identity,baseGt):void 0}function maxBy(e,t){return e&&e.length?baseExtremum(e,baseIteratee(t),baseGt):void 0}function baseSum(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}var NAN=NaN;function baseMean(e,t){var n=null==e?0:e.length;return n?baseSum(e,t)/n:NAN}function mean(e){return baseMean(e,identity)}function meanBy(e,t){return baseMean(e,baseIteratee(t))}var merge=createAssigner(function(e,t,n){baseMerge(e,t,n)}),method=baseRest(function(t,n){return function(e){return baseInvoke(e,t,n)}}),methodOf=baseRest(function(t,n){return function(e){return baseInvoke(t,e,n)}});function min(e){return e&&e.length?baseExtremum(e,identity,baseLt):void 0}function minBy(e,t){return e&&e.length?baseExtremum(e,baseIteratee(t),baseLt):void 0}function mixin$1(r,t,e){var n=keys(t),n=baseFunctions(t,n),i=!(isObject(e)&&"chain"in e&&!e.chain),o=isFunction(r);return arrayEach(n,function(e){var n=t[e];r[e]=n,o&&(r.prototype[e]=function(){var e,t=this.__chain__;return i||t?(((e=r(this.__wrapped__)).__actions__=copyArray(this.__actions__)).push({func:n,args:arguments,thisArg:r}),e.__chain__=t,e):n.apply(r,arrayPush([this.value()],arguments))})}),r}var multiply=createMathOperation(function(e,t){return e*t},1),FUNC_ERROR_TEXT$3="Expected a function";function negate(t){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$3);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function iteratorToArray(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}var mapTag$1="[object Map]",setTag$1="[object Set]",symIterator$1=Symbol?Symbol.iterator:void 0;function toArray(e){var t;return e?isArrayLike(e)?(isString(e)?stringToArray:copyArray)(e):symIterator$1&&e[symIterator$1]?iteratorToArray(e[symIterator$1]()):((t=getTag$1(e))==mapTag$1?mapToArray:t==setTag$1?setToArray:values)(e):[]}function wrapperNext(){void 0===this.__values__&&(this.__values__=toArray(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}}function baseNth(e,t){var n=e.length;return n&&isIndex(t+=t<0?n:0,n)?e[t]:void 0}function nth(e,t){return e&&e.length?baseNth(e,toInteger(t)):void 0}function nthArg(t){return t=toInteger(t),baseRest(function(e){return baseNth(e,t)})}function baseUnset(e,t){return null==(e=parent(e,t=castPath(t,e)))||delete e[toKey(last(t))]}function customOmitClone(e){return isPlainObject(e)?void 0:e}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest(function(t,e){var n={};if(null!=t)for(var r=!1,i=(e=arrayMap(e,function(e){return e=castPath(e,t),r=r||1<e.length,e}),copyObject(t,getAllKeysIn(t),n),r&&(n=baseClone(n,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone)),e.length);i--;)baseUnset(n,e[i]);return n});function baseSet(e,t,n,r){if(isObject(e))for(var i=-1,o=(t=castPath(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l,h=toKey(t[i]),p=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;i!=a&&(l=s[h],void 0===(p=r?r(l,h,s):void 0)&&(p=isObject(l)?l:isIndex(t[i+1])?[]:{})),assignValue(s,h,p),s=s[h]}return e}function basePickBy(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=baseGet(e,a);n(s,a)&&baseSet(o,castPath(a,e),s)}return o}function pickBy(e,n){var t;return null==e?{}:(t=arrayMap(getAllKeysIn(e),function(e){return[e]}),n=baseIteratee(n),basePickBy(e,t,function(e,t){return n(e,t[0])}))}function omitBy(e,t){return pickBy(e,negate(baseIteratee(t)))}function once(e){return before(2,e)}function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function compareAscending(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=isSymbol(e),a=void 0!==t,s=null===t,l=t==t,h=isSymbol(t);if(!s&&!h&&!o&&t<e||o&&a&&l&&!s&&!h||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!h&&e<t||h&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!l)return-1}return 0}function compareMultiple(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=compareAscending(i[r],o[r]);if(l)return s<=r?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}function baseOrderBy(e,r,n){r=r.length?arrayMap(r,function(t){return isArray(t)?function(e){return baseGet(e,1===t.length?t[0]:t)}:t}):[identity];var i=-1;return r=arrayMap(r,baseUnary(baseIteratee)),baseSortBy(baseMap(e,function(t,e,n){return{criteria:arrayMap(r,function(e){return e(t)}),index:++i,value:t}}),function(e,t){return compareMultiple(e,t,n)})}function orderBy(e,t,n,r){return null==e?[]:baseOrderBy(e,t=isArray(t)?t:null==t?[]:[t],n=isArray(n=r?void 0:n)?n:null==n?[]:[n])}function createOver(r){return flatRest(function(e){return e=arrayMap(e,baseUnary(baseIteratee)),baseRest(function(t){var n=this;return r(e,function(e){return apply(e,n,t)})})})}var over=createOver(arrayMap),castRest=baseRest,nativeMin$6=Math.min,overArgs=castRest(function(r,i){var o=(i=1==i.length&&isArray(i[0])?arrayMap(i[0],baseUnary(baseIteratee)):arrayMap(baseFlatten(i,1),baseUnary(baseIteratee))).length;return baseRest(function(e){for(var t=-1,n=nativeMin$6(e.length,o);++t<n;)e[t]=i[t].call(this,e[t]);return apply(r,this,e)})}),overEvery=createOver(arrayEvery),overSome=createOver(arraySome),MAX_SAFE_INTEGER$2=9007199254740991,nativeFloor$3=Math.floor;function baseRepeat(e,t){var n="";if(!(!e||t<1||MAX_SAFE_INTEGER$2<t))for(;t%2&&(n+=e),(t=nativeFloor$3(t/2))&&(e+=e),t;);return n}var asciiSize=baseProperty("length"),rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange+"]",rsCombo="["+rsComboRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeSize(e){for(var t=reUnicode.lastIndex=0;reUnicode.test(e);)++t;return t}function stringSize(e){return(hasUnicode(e)?unicodeSize:asciiSize)(e)}var nativeCeil$2=Math.ceil;function createPadding(e,t){var n=(t=void 0===t?" ":baseToString(t)).length;return n<2?n?baseRepeat(t,e):t:(n=baseRepeat(t,nativeCeil$2(e/stringSize(t))),hasUnicode(t)?castSlice(stringToArray(n),0,e).join(""):n.slice(0,e))}var nativeCeil$1=Math.ceil,nativeFloor$2=Math.floor;function pad(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;return!t||t<=r?e:createPadding(nativeFloor$2(t=(t-r)/2),n)+e+createPadding(nativeCeil$1(t),n)}function padEnd(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;return t&&r<t?e+createPadding(t-r,n):e}function padStart(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;return t&&r<t?createPadding(t-r,n)+e:e}var reTrimStart$1=/^\s+/,nativeParseInt=root.parseInt;function parseInt$1(e,t,n){return t=n||null==t?0:t&&+t,nativeParseInt(toString(e).replace(reTrimStart$1,""),t||0)}var WRAP_PARTIAL_FLAG=32,partial=baseRest(function(e,t){var n=replaceHolders(t,getHolder(partial));return createWrap(e,WRAP_PARTIAL_FLAG,void 0,t,n)}),WRAP_PARTIAL_RIGHT_FLAG=(partial.placeholder={},64),partialRight=baseRest(function(e,t){var n=replaceHolders(t,getHolder(partialRight));return createWrap(e,WRAP_PARTIAL_RIGHT_FLAG,void 0,t,n)}),partition=(partialRight.placeholder={},createAggregator(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}));function basePick(n,e){return basePickBy(n,e,function(e,t){return hasIn(n,t)})}var pick=flatRest(function(e,t){return null==e?{}:basePick(e,t)});function wrapperPlant(e){for(var t,n=this;n instanceof baseLodash;)var r=wrapperClone(n),i=(r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r,r),n=n.__wrapped__;return i.__wrapped__=e,t}function propertyOf(t){return function(e){return null==t?void 0:baseGet(t,e)}}function baseIndexOfWith(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}var arrayProto$3=Array.prototype,splice$1=arrayProto$3.splice;function basePullAll(e,t,n,r){var i=r?baseIndexOfWith:baseIndexOf,o=-1,a=t.length,s=e;for(e===t&&(t=copyArray(t)),n&&(s=arrayMap(e,baseUnary(n)));++o<a;)for(var l=0,h=t[o],p=n?n(h):h;-1<(l=i(s,p,l,r));)s!==e&&splice$1.call(s,l,1),splice$1.call(e,l,1);return e}function pullAll(e,t){return e&&e.length&&t&&t.length?basePullAll(e,t):e}var pull=baseRest(pullAll);function pullAllBy(e,t,n){return e&&e.length&&t&&t.length?basePullAll(e,t,baseIteratee(n)):e}function pullAllWith(e,t,n){return e&&e.length&&t&&t.length?basePullAll(e,t,void 0,n):e}var arrayProto$2=Array.prototype,splice=arrayProto$2.splice;function basePullAt(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i,o=t[n];n!=r&&o===i||(isIndex(i=o)?splice.call(e,o,1):baseUnset(e,o))}return e}var pullAt=flatRest(function(e,t){var n=null==e?0:e.length,r=baseAt(e,t);return basePullAt(e,arrayMap(t,function(e){return isIndex(e,n)?+e:e}).sort(compareAscending)),r}),nativeFloor$1=Math.floor,nativeRandom$1=Math.random;function baseRandom(e,t){return e+nativeFloor$1(nativeRandom$1()*(t-e+1))}var freeParseFloat=parseFloat,nativeMin$5=Math.min,nativeRandom=Math.random;function random(e,t,n){var r;return n&&"boolean"!=typeof n&&isIterateeCall(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=toFinite(e),void 0===t?(t=e,e=0):t=toFinite(t)),t<e&&(r=e,e=t,t=r),n||e%1||t%1?(r=nativeRandom(),nativeMin$5(e+r*(t-e+freeParseFloat("1e-"+((r+"").length-1))),t)):baseRandom(e,t)}var nativeCeil=Math.ceil,nativeMax$4=Math.max;function baseRange(e,t,n,r){for(var i=-1,o=nativeMax$4(nativeCeil((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}function createRange(r){return function(e,t,n){return n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(t=n=void 0),e=toFinite(e),void 0===t?(t=e,e=0):t=toFinite(t),baseRange(e,t,n=void 0===n?e<t?1:-1:toFinite(n),r)}}var range=createRange(),rangeRight=createRange(!0),WRAP_REARG_FLAG=256,rearg=flatRest(function(e,t){return createWrap(e,WRAP_REARG_FLAG,void 0,void 0,void 0,t)});function baseReduce(e,r,i,o,t){return t(e,function(e,t,n){i=o?(o=!1,e):r(i,e,t,n)}),i}function reduce(e,t,n){var r=isArray(e)?arrayReduce:baseReduce,i=arguments.length<3;return r(e,baseIteratee(t),n,i,baseEach)}function arrayReduceRight(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function reduceRight(e,t,n){var r=isArray(e)?arrayReduceRight:baseReduce,i=arguments.length<3;return r(e,baseIteratee(t),n,i,baseEachRight)}function reject(e,t){return(isArray(e)?arrayFilter:baseFilter)(e,negate(baseIteratee(t)))}function remove(e,t){var n=[];if(e&&e.length){var r=-1,i=[],o=e.length;for(t=baseIteratee(t);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}basePullAt(e,i)}return n}function repeat(e,t,n){return t=(n?isIterateeCall(e,t,n):void 0===t)?1:toInteger(t),baseRepeat(toString(e),t)}function replace(){var e=arguments,t=toString(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var FUNC_ERROR_TEXT$2="Expected a function";function rest(e,t){if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$2);return baseRest(e,t=void 0===t?t:toInteger(t))}function result(e,t,n){var r=-1,i=(t=castPath(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[toKey(t[r])];void 0===o&&(r=i,o=n),e=isFunction(o)?o.call(e):o}return e}var arrayProto$1=Array.prototype,nativeReverse=arrayProto$1.reverse;function reverse(e){return null==e?e:nativeReverse.call(e)}var round=createRound("round");function arraySample(e){var t=e.length;return t?e[baseRandom(0,t-1)]:void 0}function baseSample(e){return arraySample(values(e))}function sample(e){return(isArray(e)?arraySample:baseSample)(e)}function shuffleSelf(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=baseRandom(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function arraySampleSize(e,t){return shuffleSelf(copyArray(e),baseClamp(t,0,e.length))}function baseSampleSize(e,t){e=values(e);return shuffleSelf(e,baseClamp(t,0,e.length))}function sampleSize(e,t,n){return t=(n?isIterateeCall(e,t,n):void 0===t)?1:toInteger(t),(isArray(e)?arraySampleSize:baseSampleSize)(e,t)}function set(e,t,n){return null==e?e:baseSet(e,t,n)}function setWith(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:baseSet(e,t,n,r)}function arrayShuffle(e){return shuffleSelf(copyArray(e))}function baseShuffle(e){return shuffleSelf(values(e))}function shuffle(e){return(isArray(e)?arrayShuffle:baseShuffle)(e)}var mapTag="[object Map]",setTag="[object Set]";function size(e){var t;return null==e?0:isArrayLike(e)?isString(e)?stringSize(e):e.length:(t=getTag$1(e))==mapTag||t==setTag?e.size:baseKeys(e).length}function slice(e,t,n){var r=null==e?0:e.length;return r?(n=n&&"number"!=typeof n&&isIterateeCall(e,t,n)?(t=0,r):(t=null==t?0:toInteger(t),void 0===n?r:toInteger(n)),baseSlice(e,t,n)):[]}var snakeCase=createCompounder(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function baseSome(e,r){var i;return baseEach(e,function(e,t,n){return!(i=r(e,t,n))}),!!i}function some(e,t,n){return(isArray(e)?arraySome:baseSome)(e,baseIteratee(t=n&&isIterateeCall(e,t,n)?void 0:t))}var sortBy=baseRest(function(e,t){var n;return null==e?[]:(1<(n=t.length)&&isIterateeCall(e,t[0],t[1])?t=[]:2<n&&isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),baseOrderBy(e,baseFlatten(t,1),[]))}),MAX_ARRAY_LENGTH$4=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH$4-1,nativeFloor=Math.floor,nativeMin$4=Math.min;function baseSortedIndexBy(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=isSymbol(t),h=void 0===t;i<o;){var p=nativeFloor((i+o)/2),u=n(e[p]),c=void 0!==u,d=null===u,g=u==u,f=isSymbol(u),g=a?r||g:h?g&&(r||c):s?g&&c&&(r||!d):l?g&&c&&!d&&(r||!f):!d&&!f&&(r?u<=t:u<t);g?i=p+1:o=p}return nativeMin$4(o,MAX_ARRAY_INDEX)}var MAX_ARRAY_LENGTH$3=4294967295,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH$3>>>1;function baseSortedIndex(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=HALF_MAX_ARRAY_LENGTH){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!isSymbol(a)&&(n?a<=t:a<t)?r=1+o:i=o}return i}return baseSortedIndexBy(e,t,identity,n)}function sortedIndex(e,t){return baseSortedIndex(e,t)}function sortedIndexBy(e,t,n){return baseSortedIndexBy(e,t,baseIteratee(n))}function sortedIndexOf(e,t){var n=null==e?0:e.length;if(n){var r=baseSortedIndex(e,t);if(r<n&&eq(e[r],t))return r}return-1}function sortedLastIndex(e,t){return baseSortedIndex(e,t,!0)}function sortedLastIndexBy(e,t,n){return baseSortedIndexBy(e,t,baseIteratee(n),!0)}function sortedLastIndexOf(e,t){if(null==e?0:e.length){var n=baseSortedIndex(e,t,!0)-1;if(eq(e[n],t))return n}return-1}function baseSortedUniq(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a,s=e[n],l=t?t(s):s;n&&eq(l,a)||(a=l,o[i++]=0===s?0:s)}return o}function sortedUniq(e){return e&&e.length?baseSortedUniq(e):[]}function sortedUniqBy(e,t){return e&&e.length?baseSortedUniq(e,baseIteratee(t)):[]}var MAX_ARRAY_LENGTH$2=4294967295;function split(e,t,n){return n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(t=n=void 0),(n=void 0===n?MAX_ARRAY_LENGTH$2:n>>>0)?(e=toString(e))&&("string"==typeof t||null!=t&&!isRegExp(t))&&!(t=baseToString(t))&&hasUnicode(e)?castSlice(stringToArray(e),0,n):e.split(t,n):[]}var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$3=Math.max;function spread(n,r){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT$1);return r=null==r?0:nativeMax$3(toInteger(r),0),baseRest(function(e){var t=e[r],e=castSlice(e,0,r);return t&&arrayPush(e,t),apply(n,this,e)})}var startCase=createCompounder(function(e,t,n){return e+(n?" ":"")+upperFirst(t)});function startsWith(e,t,n){return e=toString(e),n=null==n?0:baseClamp(toInteger(n),0,e.length),t=baseToString(t),e.slice(n,n+t.length)==t}function stubObject(){return{}}function stubString(){return""}function stubTrue(){return!0}var subtract=createMathOperation(function(e,t){return e-t},0);function sum(e){return e&&e.length?baseSum(e,identity):0}function sumBy(e,t){return e&&e.length?baseSum(e,baseIteratee(t)):0}function tail(e){var t=null==e?0:e.length;return t?baseSlice(e,1,t):[]}function take(e,t,n){return e&&e.length?baseSlice(e,0,(t=n||void 0===t?1:toInteger(t))<0?0:t):[]}function takeRight(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,(t=r-(t=n||void 0===t?1:toInteger(t)))<0?0:t,r):[]}function takeRightWhile(e,t){return e&&e.length?baseWhile(e,baseIteratee(t),!1,!0):[]}function takeWhile(e,t){return e&&e.length?baseWhile(e,baseIteratee(t)):[]}function tap(e,t){return t(e),e}var objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function customDefaultsAssignIn(e,t,n,r){return void 0===e||eq(e,objectProto$2[n])&&!hasOwnProperty$2.call(r,n)?t:e}var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(e){return"\\"+stringEscapes[e]}var reInterpolate=/<%=([\s\S]+?)%>/g,reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:{escape:escape$1}}},INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function template(a,e,t){var s,l,n=templateSettings.imports._.templateSettings||templateSettings,t=(t&&isIterateeCall(a,e,t)&&(e=void 0),a=toString(a),e=assignInWith({},e,n,customDefaultsAssignIn),assignInWith({},e.imports,n.imports,customDefaultsAssignIn)),r=keys(t),i=baseValues(t,r),h=0,n=e.interpolate||reNoMatch,p="__p += '",t=RegExp((e.escape||reNoMatch).source+"|"+n.source+"|"+(n===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(e.evaluate||reNoMatch).source+"|$","g"),o=hasOwnProperty$1.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"",n=(a.replace(t,function(e,t,n,r,i,o){return n=n||r,p+=a.slice(h,o).replace(reUnescapedString,escapeStringChar),t&&(s=!0,p+="' +\n__e("+t+") +\n'"),i&&(l=!0,p+="';\n"+i+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=o+e.length,e}),p+="';\n",hasOwnProperty$1.call(e,"variable")&&e.variable);if(n){if(reForbiddenIdentifierChars.test(n))throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}else p="with (obj) {\n"+p+"\n}\n";p=(l?p.replace(reEmptyStringLeading,""):p).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");p="function("+(n||"obj")+") {\n"+(n?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}",t=attempt(function(){return Function(r,o+"return "+p).apply(void 0,i)});if(t.source=p,isError(t))throw t;return t}var FUNC_ERROR_TEXT="Expected a function";function throttle(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);return isObject(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),debounce(e,t,{leading:r,maxWait:t,trailing:i})}function thru(e,t){return t(e)}var MAX_SAFE_INTEGER$1=9007199254740991,MAX_ARRAY_LENGTH$1=4294967295,nativeMin$3=Math.min;function times(e,t){if((e=toInteger(e))<1||MAX_SAFE_INTEGER$1<e)return[];for(var n=MAX_ARRAY_LENGTH$1,r=nativeMin$3(e,MAX_ARRAY_LENGTH$1),r=(t=castFunction(t),e-=MAX_ARRAY_LENGTH$1,baseTimes(r,t));++n<e;)t(n);return r}function wrapperToIterator(){return this}function baseWrapperValue(e,t){return arrayReduce(t,function(e,t){return t.func.apply(t.thisArg,arrayPush([e],t.args))},e=e instanceof LazyWrapper?e.value():e)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function toLower(e){return toString(e).toLowerCase()}function toPath(e){return isArray(e)?arrayMap(e,toKey):isSymbol(e)?[e]:copyArray(stringToPath(toString(e)))}var MAX_SAFE_INTEGER=9007199254740991;function toSafeInteger(e){return e?baseClamp(toInteger(e),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER):0===e?e:0}function toUpper(e){return toString(e).toUpperCase()}function transform(e,r,i){var t,n=isArray(e),o=n||isBuffer(e)||isTypedArray(e);return r=baseIteratee(r),null==i&&(t=e&&e.constructor,i=o?n?new t:[]:isObject(e)&&isFunction(t)?baseCreate(getPrototype(e)):{}),(o?arrayEach:baseForOwn)(e,function(e,t,n){return r(i,e,t,n)}),i}function charsEndIndex(e,t){for(var n=e.length;n--&&-1<baseIndexOf(t,e[n],0););return n}function charsStartIndex(e,t){for(var n=-1,r=e.length;++n<r&&-1<baseIndexOf(t,e[n],0););return n}function trim(e,t,n){return(e=toString(e))&&(n||void 0===t)?baseTrim(e):e&&(t=baseToString(t))?castSlice(n=stringToArray(e),charsStartIndex(n,t=stringToArray(t)),charsEndIndex(n,t)+1).join(""):e}function trimEnd(e,t,n){return(e=toString(e))&&(n||void 0===t)?e.slice(0,trimmedEndIndex(e)+1):e&&(t=baseToString(t))?castSlice(n=stringToArray(e),0,charsEndIndex(n,stringToArray(t))+1).join(""):e}var reTrimStart=/^\s+/;function trimStart(e,t,n){return(e=toString(e))&&(n||void 0===t)?e.replace(reTrimStart,""):e&&(t=baseToString(t))?castSlice(n=stringToArray(e),charsStartIndex(n,stringToArray(t))).join(""):e}var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",reFlags=/\w*$/;function truncate(e,t){var n,r=DEFAULT_TRUNC_LENGTH,i=DEFAULT_TRUNC_OMISSION,t=(isObject(t)&&(n="separator"in t?t.separator:n,r="length"in t?toInteger(t.length):r,i="omission"in t?baseToString(t.omission):i),(e=toString(e)).length);if((t=hasUnicode(e)?(o=stringToArray(e)).length:t)<=r)return e;t=r-stringSize(i);if(t<1)return i;var o,r=o?castSlice(o,0,t).join(""):e.slice(0,t);if(void 0!==n)if(o&&(t+=r.length-t),isRegExp(n)){if(e.slice(t).search(n)){var a,s=r;for((n=n.global?n:RegExp(n.source,toString(reFlags.exec(n))+"g")).lastIndex=0;a=n.exec(s);)var l=a.index;r=r.slice(0,void 0===l?t:l)}}else e.indexOf(baseToString(n),t)==t||-1<(o=r.lastIndexOf(n))&&(r=r.slice(0,o));return r+i}function unary(e){return ary(e,1)}var htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},unescapeHtmlChar=basePropertyOf(htmlUnescapes),reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reHasEscapedHtml=RegExp(reEscapedHtml.source);function unescape$1(e){return(e=toString(e))&&reHasEscapedHtml.test(e)?e.replace(reEscapedHtml,unescapeHtmlChar):e}var INFINITY=1/0,createSet=Set&&1/setToArray(new Set([,-0]))[1]==INFINITY?function(e){return new Set(e)}:noop,LARGE_ARRAY_SIZE=200;function baseUniq(e,t,n){var r=-1,i=arrayIncludes,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=arrayIncludesWith;else if(LARGE_ARRAY_SIZE<=o){var h=t?null:createSet(e);if(h)return setToArray(h);a=!1,i=cacheHas,l=new SetCache}else l=t?[]:s;e:for(;++r<o;){var p=e[r],u=t?t(p):p,p=n||0!==p?p:0;if(a&&u==u){for(var c=l.length;c--;)if(l[c]===u)continue e;t&&l.push(u),s.push(p)}else i(l,u,n)||(l!==s&&l.push(u),s.push(p))}return s}var union=baseRest(function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject,!0))}),unionBy=baseRest(function(e){var t=last(e);return isArrayLikeObject(t)&&(t=void 0),baseUniq(baseFlatten(e,1,isArrayLikeObject,!0),baseIteratee(t))}),unionWith=baseRest(function(e){var t="function"==typeof(t=last(e))?t:void 0;return baseUniq(baseFlatten(e,1,isArrayLikeObject,!0),void 0,t)});function uniq(e){return e&&e.length?baseUniq(e):[]}function uniqBy(e,t){return e&&e.length?baseUniq(e,baseIteratee(t)):[]}function uniqWith(e,t){return t="function"==typeof t?t:void 0,e&&e.length?baseUniq(e,void 0,t):[]}var idCounter=0;function uniqueId(e){var t=++idCounter;return toString(e)+t}function unset(e,t){return null==e||baseUnset(e,t)}var nativeMax$2=Math.max;function unzip(t){var n;return t&&t.length?(n=0,t=arrayFilter(t,function(e){if(isArrayLikeObject(e))return n=nativeMax$2(e.length,n),!0}),baseTimes(n,function(e){return arrayMap(t,baseProperty(e))})):[]}function unzipWith(e,t){return e&&e.length?(e=unzip(e),null==t?e:arrayMap(e,function(e){return apply(t,void 0,e)})):[]}function baseUpdate(e,t,n,r){return baseSet(e,t,n(baseGet(e,t)),r)}function update(e,t,n){return null==e?e:baseUpdate(e,t,castFunction(n))}function updateWith(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:baseUpdate(e,t,castFunction(n),r)}var upperCase=createCompounder(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()});function valuesIn(e){return null==e?[]:baseValues(e,keysIn(e))}var without=baseRest(function(e,t){return isArrayLikeObject(e)?baseDifference(e,t):[]});function wrap(e,t){return partial(castFunction(t),e)}var wrapperAt=flatRest(function(t){function e(e){return baseAt(e,t)}var n=t.length,r=n?t[0]:0,i=this.__wrapped__;return!(1<n||this.__actions__.length)&&i instanceof LazyWrapper&&isIndex(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:thru,args:[e],thisArg:void 0}),new LodashWrapper(i,this.__chain__).thru(function(e){return n&&!e.length&&e.push(void 0),e})):this.thru(e)});function wrapperChain(){return chain(this)}function wrapperReverse(){var e=this.__wrapped__;return e instanceof LazyWrapper?(e=e,(e=(e=this.__actions__.length?new LazyWrapper(this):e).reverse()).__actions__.push({func:thru,args:[reverse],thisArg:void 0}),new LodashWrapper(e,this.__chain__)):this.thru(reverse)}function baseXor(e,t,n){var r=e.length;if(r<2)return r?baseUniq(e[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=baseDifference(o[i]||a,e[s],t,n));return baseUniq(baseFlatten(o,1),t,n)}var xor=baseRest(function(e){return baseXor(arrayFilter(e,isArrayLikeObject))}),xorBy=baseRest(function(e){var t=last(e);return isArrayLikeObject(t)&&(t=void 0),baseXor(arrayFilter(e,isArrayLikeObject),baseIteratee(t))}),xorWith=baseRest(function(e){var t="function"==typeof(t=last(e))?t:void 0;return baseXor(arrayFilter(e,isArrayLikeObject),void 0,t)}),zip=baseRest(unzip);function baseZipObject(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s)}return a}function zipObject(e,t){return baseZipObject(e||[],t||[],assignValue)}function zipObjectDeep(e,t){return baseZipObject(e||[],t||[],baseSet)}var zipWith=baseRest(function(e){var t=e.length,t="function"==typeof(t=1<t?e[t-1]:void 0)?(e.pop(),t):void 0;return unzipWith(e,t)}),array={chunk:chunk,compact:compact,concat:concat,difference:difference,differenceBy:differenceBy,differenceWith:differenceWith,drop:drop,dropRight:dropRight,dropRightWhile:dropRightWhile,dropWhile:dropWhile,fill:fill,findIndex:findIndex,findLastIndex:findLastIndex,first:head,flatten:flatten,flattenDeep:flattenDeep,flattenDepth:flattenDepth,fromPairs:fromPairs,head:head,indexOf:indexOf,initial:initial,intersection:intersection,intersectionBy:intersectionBy,intersectionWith:intersectionWith,join:join,last:last,lastIndexOf:lastIndexOf,nth:nth,pull:pull,pullAll:pullAll,pullAllBy:pullAllBy,pullAllWith:pullAllWith,pullAt:pullAt,remove:remove,reverse:reverse,slice:slice,sortedIndex:sortedIndex,sortedIndexBy:sortedIndexBy,sortedIndexOf:sortedIndexOf,sortedLastIndex:sortedLastIndex,sortedLastIndexBy:sortedLastIndexBy,sortedLastIndexOf:sortedLastIndexOf,sortedUniq:sortedUniq,sortedUniqBy:sortedUniqBy,tail:tail,take:take,takeRight:takeRight,takeRightWhile:takeRightWhile,takeWhile:takeWhile,union:union,unionBy:unionBy,unionWith:unionWith,uniq:uniq,uniqBy:uniqBy,uniqWith:uniqWith,unzip:unzip,unzipWith:unzipWith,without:without,xor:xor,xorBy:xorBy,xorWith:xorWith,zip:zip,zipObject:zipObject,zipObjectDeep:zipObjectDeep,zipWith:zipWith},collection={countBy:countBy,each:forEach,eachRight:forEachRight,every:every,filter:filter,find:find,findLast:findLast,flatMap:flatMap,flatMapDeep:flatMapDeep,flatMapDepth:flatMapDepth,forEach:forEach,forEachRight:forEachRight,groupBy:groupBy,includes:includes,invokeMap:invokeMap,keyBy:keyBy,map:map,orderBy:orderBy,partition:partition,reduce:reduce,reduceRight:reduceRight,reject:reject,sample:sample,sampleSize:sampleSize,shuffle:shuffle,size:size,some:some,sortBy:sortBy},date={now:now},func={after:after,ary:ary,before:before,bind:bind,bindKey:bindKey,curry:curry,curryRight:curryRight,debounce:debounce,defer:defer,delay:delay,flip:flip,memoize:memoize,negate:negate,once:once,overArgs:overArgs,partial:partial,partialRight:partialRight,rearg:rearg,rest:rest,spread:spread,throttle:throttle,unary:unary,wrap:wrap},lang={castArray:castArray,clone:clone,cloneDeep:cloneDeep,cloneDeepWith:cloneDeepWith,cloneWith:cloneWith,conformsTo:conformsTo,eq:eq,gt:gt,gte:gte,isArguments:isArguments,isArray:isArray,isArrayBuffer:isArrayBuffer,isArrayLike:isArrayLike,isArrayLikeObject:isArrayLikeObject,isBoolean:isBoolean,isBuffer:isBuffer,isDate:isDate,isElement:isElement,isEmpty:isEmpty,isEqual:isEqual,isEqualWith:isEqualWith,isError:isError,isFinite:isFinite,isFunction:isFunction,isInteger:isInteger,isLength:isLength,isMap:isMap,isMatch:isMatch,isMatchWith:isMatchWith,isNaN:isNaN,isNative:isNative,isNil:isNil,isNull:isNull,isNumber:isNumber,isObject:isObject,isObjectLike:isObjectLike,isPlainObject:isPlainObject,isRegExp:isRegExp,isSafeInteger:isSafeInteger,isSet:isSet,isString:isString,isSymbol:isSymbol,isTypedArray:isTypedArray,isUndefined:isUndefined,isWeakMap:isWeakMap,isWeakSet:isWeakSet,lt:lt,lte:lte,toArray:toArray,toFinite:toFinite,toInteger:toInteger,toLength:toLength,toNumber:toNumber,toPlainObject:toPlainObject,toSafeInteger:toSafeInteger,toString:toString},math={add:add,ceil:ceil,divide:divide,floor:floor,max:max,maxBy:maxBy,mean:mean,meanBy:meanBy,min:min,minBy:minBy,multiply:multiply,round:round,subtract:subtract,sum:sum,sumBy:sumBy},number={clamp:clamp,inRange:inRange,random:random},object={assign:assign,assignIn:assignIn,assignInWith:assignInWith,assignWith:assignWith,at:at,create:create,defaults:defaults,defaultsDeep:defaultsDeep,entries:toPairs,entriesIn:toPairsIn,extend:assignIn,extendWith:assignInWith,findKey:findKey,findLastKey:findLastKey,forIn:forIn,forInRight:forInRight,forOwn:forOwn,forOwnRight:forOwnRight,functions:functions,functionsIn:functionsIn,get:get,has:has,hasIn:hasIn,invert:invert,invertBy:invertBy,invoke:invoke,keys:keys,keysIn:keysIn,mapKeys:mapKeys,mapValues:mapValues,merge:merge,mergeWith:mergeWith,omit:omit,omitBy:omitBy,pick:pick,pickBy:pickBy,result:result,set:set,setWith:setWith,toPairs:toPairs,toPairsIn:toPairsIn,transform:transform,unset:unset,update:update,updateWith:updateWith,values:values,valuesIn:valuesIn},seq={at:wrapperAt,chain:chain,commit:wrapperCommit,lodash:lodash,next:wrapperNext,plant:wrapperPlant,reverse:wrapperReverse,tap:tap,thru:thru,toIterator:wrapperToIterator,toJSON:wrapperValue,value:wrapperValue,valueOf:wrapperValue,wrapperChain:wrapperChain},string={camelCase:camelCase,capitalize:capitalize,deburr:deburr,endsWith:endsWith,escape:escape$1,escapeRegExp:escapeRegExp,kebabCase:kebabCase,lowerCase:lowerCase,lowerFirst:lowerFirst,pad:pad,padEnd:padEnd,padStart:padStart,parseInt:parseInt$1,repeat:repeat,replace:replace,snakeCase:snakeCase,split:split,startCase:startCase,startsWith:startsWith,template:template,templateSettings:templateSettings,toLower:toLower,toUpper:toUpper,trim:trim,trimEnd:trimEnd,trimStart:trimStart,truncate:truncate,unescape:unescape$1,upperCase:upperCase,upperFirst:upperFirst,words:words},util={attempt:attempt,bindAll:bindAll,cond:cond,conforms:conforms,constant:constant,defaultTo:defaultTo,flow:flow,flowRight:flowRight,identity:identity,iteratee:iteratee,matches:matches,matchesProperty:matchesProperty,method:method,methodOf:methodOf,mixin:mixin$1,noop:noop,nthArg:nthArg,over:over,overEvery:overEvery,overSome:overSome,property:property,propertyOf:propertyOf,range:range,rangeRight:rangeRight,stubArray:stubArray,stubFalse:stubFalse,stubObject:stubObject,stubString:stubString,stubTrue:stubTrue,times:times,toPath:toPath,uniqueId:uniqueId};function lazyClone(){var e=new LazyWrapper(this.__wrapped__);return e.__actions__=copyArray(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=copyArray(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=copyArray(this.__views__),e}function lazyReverse(){var e;return this.__filtered__?((e=new LazyWrapper(this)).__dir__=-1,e.__filtered__=!0):(e=this.clone()).__dir__*=-1,e}var nativeMax$1=Math.max,nativeMin$2=Math.min;function getView(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=nativeMin$2(t,e+a);break;case"takeRight":e=nativeMax$1(e,t-a)}}return{start:e,end:t}}var LAZY_FILTER_FLAG$1=1,LAZY_MAP_FLAG=2,nativeMin$1=Math.min;function lazyValue(){var e=this.__wrapped__.value(),t=this.__dir__,n=isArray(e),r=t<0,i=n?e.length:0,o=getView(0,i,this.__views__),a=o.start,o=o.end,s=o-a,l=r?o:a-1,h=this.__iteratees__,p=h.length,u=0,c=nativeMin$1(s,this.__takeCount__);if(!n||!r&&i==s&&c==s)return baseWrapperValue(e,this.__actions__);var d=[];e:for(;s--&&u<c;){for(var g=-1,f=e[l+=t];++g<p;){var _=h[g],y=_.iteratee,_=_.type,y=y(f);if(_==LAZY_MAP_FLAG)f=y;else if(!y){if(_==LAZY_FILTER_FLAG$1)continue e;break e}}d[u++]=f}return d}var VERSION="4.17.21",WRAP_BIND_KEY_FLAG=2,LAZY_FILTER_FLAG=1,LAZY_WHILE_FLAG=3,MAX_ARRAY_LENGTH=4294967295,arrayProto=Array.prototype,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,symIterator=Symbol?Symbol.iterator:void 0,nativeMax=Math.max,nativeMin=Math.min,mixin=function(o){return function(e,t,n){var r,i;return null!=n||((i=(i=(r=isObject(t))&&keys(t))&&i.length&&baseFunctions(t,i))?i.length:r)||(n=t,t=e,e=this),o(e,t,n)}}(mixin$1);function distance(e,t){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function colorToString(e){return"rgba("+Math.round(255*e[0]).toFixed()+","+Math.round(255*e[1]).toFixed()+","+Math.round(255*e[2]).toFixed()+","+(4==e.length?e[3].toFixed(2):"1.0")+")"}function hex2num(t){t=(t="#"==t.charAt(0)?t.slice(1):t).toUpperCase();var n,r,i="0123456789ABCDEF";let o=new Array(3),a=0;for(let e=0;e<6;e+=2)n=i.indexOf(t.charAt(e)),r=i.indexOf(t.charAt(e+1)),o[a]=16*n+r,a++;return o}function num2hex(t){var n,r,i="0123456789ABCDEF";let o="#";for(let e=0;e<3;e++)n=t[e]/16,r=t[e]%16,o+=i.charAt(n)+i.charAt(r);return o}function compareObjects(e,t){for(var n in e)if(e[n]!=t[n])return!1;return!0}function growBounding(e,t,n){t<e[0]?e[0]=t:t>e[2]&&(e[2]=t),n<e[1]?e[1]=n:n>e[3]&&(e[3]=n)}function isInsideBounding(e,t){return!(e[0]<t[0][0]||e[1]<t[0][1]||e[0]>t[1][0]||e[1]>t[1][1])}function overlapBounding(e,t){var n=e[0]+e[2],r=e[1]+e[3],i=t[0]+t[2],o=t[1]+t[3];return!(e[0]>i||e[1]>o||n<t[0]||r<t[1])}function isInsideRectangle(e,t,n,r,i,o){return n<e&&e<n+i&&r<t&&t<r+o}function CurveEditor(e){this.points=e,this.selected=-1,this.nearest=-1,this.size=null,this.must_update=!0,this.margin=5}function ContextMenu(n,r){r=r||{},this.options=r;let t=this,e=(r.parentMenu&&(r.parentMenu.constructor!==this.constructor?(console.error("parentMenu must be of class ContextMenu, ignoring it"),r.parentMenu=null):(this.parentMenu=r.parentMenu,this.parentMenu.lock=!0,this.parentMenu.current_submenu=this)),null),i=("MouseEvent"!==(e=r.event?r.event.constructor.name:e)&&"CustomEvent"!==e&&"PointerEvent"!==e&&(console.error("Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it. ("+e+")"),r.event=null),document.createElement("div"));function o(e){var t=parseInt(i.style.top);return i.style.top=(t+e.deltaY*r.scroll_speed).toFixed()+"px",e.preventDefault(),!0}if(i.className="litegraph litecontextmenu litemenubar-panel",r.className&&(i.className+=" "+r.className),i.style.minWidth=100,i.style.minHeight=100,i.style.pointerEvents="none",setTimeout(function(){i.style.pointerEvents="auto"},100),LiteGraph$2.pointerListenerAdd(i,"up",function(e){return e.preventDefault(),!0},!0),i.addEventListener("contextmenu",function(e){return 2==e.button&&e.preventDefault(),!1},!0),LiteGraph$2.pointerListenerAdd(i,"down",function(e){if(2==e.button)return t.close(),e.preventDefault(),!0},!0),r.scroll_speed||(r.scroll_speed=.1),i.addEventListener("wheel",o,!0),i.addEventListener("mousewheel",o,!0),this.root=i,r.title){let e=document.createElement("div");e.className="litemenu-title",e.innerHTML=r.title,i.appendChild(e)}for(let t=0;t<n.length;t++){let e=n.constructor==Array?n[t]:t;null!=e&&e.constructor!==String&&(e=void 0===e.content?String(e):e.content);var a=n[t];this.addItem(e,a,r)}LiteGraph$2.pointerListenerAdd(i,"enter",function(e){i.closing_timer&&clearTimeout(i.closing_timer)});let s=document,l=(((s=(s=r.event?r.event.target.ownerDocument:s)||document).fullscreenElement||s.body).appendChild(i),r.left||0),h=r.top||0;var p,u;r.event&&(l=r.event.clientX-10,h=r.event.clientY-10,r.title&&(h-=20),r.parentMenu&&(p=r.parentMenu.root.getBoundingClientRect(),l=p.left+p.width),p=document.body.getBoundingClientRect(),u=i.getBoundingClientRect(),0==p.height&&console.error("document.body height is 0. That is dangerous, set html,body { height: 100%; }"),p.width&&l>p.width-u.width-10&&(l=p.width-u.width-10),p.height&&h>p.height-u.height-10&&(h=p.height-u.height-10)),i.style.left=l+"px",i.style.top=h+"px",r.scale&&(i.style.transform="scale("+r.scale+")")}function DragAndScale(e,t){this.offset=new Float32Array([0,0]),this.scale=1,this.max_scale=10,this.min_scale=.1,this.onredraw=null,this.enabled=!0,this.last_mouse=[0,0],this.element=null,this.visible_area=new Float32Array(4),e&&(this.element=e,t||this.bindEvents(e))}function LLink(e,t,n,r,i,o){this.id=e,this.type=t,this.origin_id=n,this.origin_slot=r,this.target_id=i,this.target_slot=o,this._data=null,this._pos=new Float32Array(2)}function LGraphNode(e){this._ctor(e)}lodash.after=func.after,lodash.ary=func.ary,lodash.assign=object.assign,lodash.assignIn=object.assignIn,lodash.assignInWith=object.assignInWith,lodash.assignWith=object.assignWith,lodash.at=object.at,lodash.before=func.before,lodash.bind=func.bind,lodash.bindAll=util.bindAll,lodash.bindKey=func.bindKey,lodash.castArray=lang.castArray,lodash.chain=seq.chain,lodash.chunk=array.chunk,lodash.compact=array.compact,lodash.concat=array.concat,lodash.cond=util.cond,lodash.conforms=util.conforms,lodash.constant=util.constant,lodash.countBy=collection.countBy,lodash.create=object.create,lodash.curry=func.curry,lodash.curryRight=func.curryRight,lodash.debounce=func.debounce,lodash.defaults=object.defaults,lodash.defaultsDeep=object.defaultsDeep,lodash.defer=func.defer,lodash.delay=func.delay,lodash.difference=array.difference,lodash.differenceBy=array.differenceBy,lodash.differenceWith=array.differenceWith,lodash.drop=array.drop,lodash.dropRight=array.dropRight,lodash.dropRightWhile=array.dropRightWhile,lodash.dropWhile=array.dropWhile,lodash.fill=array.fill,lodash.filter=collection.filter,lodash.flatMap=collection.flatMap,lodash.flatMapDeep=collection.flatMapDeep,lodash.flatMapDepth=collection.flatMapDepth,lodash.flatten=array.flatten,lodash.flattenDeep=array.flattenDeep,lodash.flattenDepth=array.flattenDepth,lodash.flip=func.flip,lodash.flow=util.flow,lodash.flowRight=util.flowRight,lodash.fromPairs=array.fromPairs,lodash.functions=object.functions,lodash.functionsIn=object.functionsIn,lodash.groupBy=collection.groupBy,lodash.initial=array.initial,lodash.intersection=array.intersection,lodash.intersectionBy=array.intersectionBy,lodash.intersectionWith=array.intersectionWith,lodash.invert=object.invert,lodash.invertBy=object.invertBy,lodash.invokeMap=collection.invokeMap,lodash.iteratee=util.iteratee,lodash.keyBy=collection.keyBy,lodash.keys=keys,lodash.keysIn=object.keysIn,lodash.map=collection.map,lodash.mapKeys=object.mapKeys,lodash.mapValues=object.mapValues,lodash.matches=util.matches,lodash.matchesProperty=util.matchesProperty,lodash.memoize=func.memoize,lodash.merge=object.merge,lodash.mergeWith=object.mergeWith,lodash.method=util.method,lodash.methodOf=util.methodOf,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=util.nthArg,lodash.omit=object.omit,lodash.omitBy=object.omitBy,lodash.once=func.once,lodash.orderBy=collection.orderBy,lodash.over=util.over,lodash.overArgs=func.overArgs,lodash.overEvery=util.overEvery,lodash.overSome=util.overSome,lodash.partial=func.partial,lodash.partialRight=func.partialRight,lodash.partition=collection.partition,lodash.pick=object.pick,lodash.pickBy=object.pickBy,lodash.property=util.property,lodash.propertyOf=util.propertyOf,lodash.pull=array.pull,lodash.pullAll=array.pullAll,lodash.pullAllBy=array.pullAllBy,lodash.pullAllWith=array.pullAllWith,lodash.pullAt=array.pullAt,lodash.range=util.range,lodash.rangeRight=util.rangeRight,lodash.rearg=func.rearg,lodash.reject=collection.reject,lodash.remove=array.remove,lodash.rest=func.rest,lodash.reverse=array.reverse,lodash.sampleSize=collection.sampleSize,lodash.set=object.set,lodash.setWith=object.setWith,lodash.shuffle=collection.shuffle,lodash.slice=array.slice,lodash.sortBy=collection.sortBy,lodash.sortedUniq=array.sortedUniq,lodash.sortedUniqBy=array.sortedUniqBy,lodash.split=string.split,lodash.spread=func.spread,lodash.tail=array.tail,lodash.take=array.take,lodash.takeRight=array.takeRight,lodash.takeRightWhile=array.takeRightWhile,lodash.takeWhile=array.takeWhile,lodash.tap=seq.tap,lodash.throttle=func.throttle,lodash.thru=thru,lodash.toArray=lang.toArray,lodash.toPairs=object.toPairs,lodash.toPairsIn=object.toPairsIn,lodash.toPath=util.toPath,lodash.toPlainObject=lang.toPlainObject,lodash.transform=object.transform,lodash.unary=func.unary,lodash.union=array.union,lodash.unionBy=array.unionBy,lodash.unionWith=array.unionWith,lodash.uniq=array.uniq,lodash.uniqBy=array.uniqBy,lodash.uniqWith=array.uniqWith,lodash.unset=object.unset,lodash.unzip=array.unzip,lodash.unzipWith=array.unzipWith,lodash.update=object.update,lodash.updateWith=object.updateWith,lodash.values=object.values,lodash.valuesIn=object.valuesIn,lodash.without=array.without,lodash.words=string.words,lodash.wrap=func.wrap,lodash.xor=array.xor,lodash.xorBy=array.xorBy,lodash.xorWith=array.xorWith,lodash.zip=array.zip,lodash.zipObject=array.zipObject,lodash.zipObjectDeep=array.zipObjectDeep,lodash.zipWith=array.zipWith,lodash.entries=object.toPairs,lodash.entriesIn=object.toPairsIn,lodash.extend=object.assignIn,lodash.extendWith=object.assignInWith,mixin(lodash,lodash),lodash.add=math.add,lodash.attempt=util.attempt,lodash.camelCase=string.camelCase,lodash.capitalize=string.capitalize,lodash.ceil=math.ceil,lodash.clamp=number.clamp,lodash.clone=lang.clone,lodash.cloneDeep=lang.cloneDeep,lodash.cloneDeepWith=lang.cloneDeepWith,lodash.cloneWith=lang.cloneWith,lodash.conformsTo=lang.conformsTo,lodash.deburr=string.deburr,lodash.defaultTo=util.defaultTo,lodash.divide=math.divide,lodash.endsWith=string.endsWith,lodash.eq=lang.eq,lodash.escape=string.escape,lodash.escapeRegExp=string.escapeRegExp,lodash.every=collection.every,lodash.find=collection.find,lodash.findIndex=array.findIndex,lodash.findKey=object.findKey,lodash.findLast=collection.findLast,lodash.findLastIndex=array.findLastIndex,lodash.findLastKey=object.findLastKey,lodash.floor=math.floor,lodash.forEach=collection.forEach,lodash.forEachRight=collection.forEachRight,lodash.forIn=object.forIn,lodash.forInRight=object.forInRight,lodash.forOwn=object.forOwn,lodash.forOwnRight=object.forOwnRight,lodash.get=object.get,lodash.gt=lang.gt,lodash.gte=lang.gte,lodash.has=object.has,lodash.hasIn=object.hasIn,lodash.head=array.head,lodash.identity=identity,lodash.includes=collection.includes,lodash.indexOf=array.indexOf,lodash.inRange=number.inRange,lodash.invoke=object.invoke,lodash.isArguments=lang.isArguments,lodash.isArray=isArray,lodash.isArrayBuffer=lang.isArrayBuffer,lodash.isArrayLike=lang.isArrayLike,lodash.isArrayLikeObject=lang.isArrayLikeObject,lodash.isBoolean=lang.isBoolean,lodash.isBuffer=lang.isBuffer,lodash.isDate=lang.isDate,lodash.isElement=lang.isElement,lodash.isEmpty=lang.isEmpty,lodash.isEqual=lang.isEqual,lodash.isEqualWith=lang.isEqualWith,lodash.isError=lang.isError,lodash.isFinite=lang.isFinite,lodash.isFunction=lang.isFunction,lodash.isInteger=lang.isInteger,lodash.isLength=lang.isLength,lodash.isMap=lang.isMap,lodash.isMatch=lang.isMatch,lodash.isMatchWith=lang.isMatchWith,lodash.isNaN=lang.isNaN,lodash.isNative=lang.isNative,lodash.isNil=lang.isNil,lodash.isNull=lang.isNull,lodash.isNumber=lang.isNumber,lodash.isObject=isObject,lodash.isObjectLike=lang.isObjectLike,lodash.isPlainObject=lang.isPlainObject,lodash.isRegExp=lang.isRegExp,lodash.isSafeInteger=lang.isSafeInteger,lodash.isSet=lang.isSet,lodash.isString=lang.isString,lodash.isSymbol=lang.isSymbol,lodash.isTypedArray=lang.isTypedArray,lodash.isUndefined=lang.isUndefined,lodash.isWeakMap=lang.isWeakMap,lodash.isWeakSet=lang.isWeakSet,lodash.join=array.join,lodash.kebabCase=string.kebabCase,lodash.last=last,lodash.lastIndexOf=array.lastIndexOf,lodash.lowerCase=string.lowerCase,lodash.lowerFirst=string.lowerFirst,lodash.lt=lang.lt,lodash.lte=lang.lte,lodash.max=math.max,lodash.maxBy=math.maxBy,lodash.mean=math.mean,lodash.meanBy=math.meanBy,lodash.min=math.min,lodash.minBy=math.minBy,lodash.stubArray=util.stubArray,lodash.stubFalse=util.stubFalse,lodash.stubObject=util.stubObject,lodash.stubString=util.stubString,lodash.stubTrue=util.stubTrue,lodash.multiply=math.multiply,lodash.nth=array.nth,lodash.noop=util.noop,lodash.now=date.now,lodash.pad=string.pad,lodash.padEnd=string.padEnd,lodash.padStart=string.padStart,lodash.parseInt=string.parseInt,lodash.random=number.random,lodash.reduce=collection.reduce,lodash.reduceRight=collection.reduceRight,lodash.repeat=string.repeat,lodash.replace=string.replace,lodash.result=object.result,lodash.round=math.round,lodash.sample=collection.sample,lodash.size=collection.size,lodash.snakeCase=string.snakeCase,lodash.some=collection.some,lodash.sortedIndex=array.sortedIndex,lodash.sortedIndexBy=array.sortedIndexBy,lodash.sortedIndexOf=array.sortedIndexOf,lodash.sortedLastIndex=array.sortedLastIndex,lodash.sortedLastIndexBy=array.sortedLastIndexBy,lodash.sortedLastIndexOf=array.sortedLastIndexOf,lodash.startCase=string.startCase,lodash.startsWith=string.startsWith,lodash.subtract=math.subtract,lodash.sum=math.sum,lodash.sumBy=math.sumBy,lodash.template=string.template,lodash.times=util.times,lodash.toFinite=lang.toFinite,lodash.toInteger=toInteger,lodash.toLength=lang.toLength,lodash.toLower=string.toLower,lodash.toNumber=lang.toNumber,lodash.toSafeInteger=lang.toSafeInteger,lodash.toString=lang.toString,lodash.toUpper=string.toUpper,lodash.trim=string.trim,lodash.trimEnd=string.trimEnd,lodash.trimStart=string.trimStart,lodash.truncate=string.truncate,lodash.unescape=string.unescape,lodash.uniqueId=util.uniqueId,lodash.upperCase=string.upperCase,lodash.upperFirst=string.upperFirst,lodash.each=collection.forEach,lodash.eachRight=collection.forEachRight,lodash.first=array.head,mixin(lodash,function(){var n={};return baseForOwn(lodash,function(e,t){hasOwnProperty.call(lodash.prototype,t)||(n[t]=e)}),n}(),{chain:!1}),lodash.VERSION=VERSION,(lodash.templateSettings=string.templateSettings).imports._=lodash,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){lodash[e].placeholder=lodash}),arrayEach(["drop","take"],function(n,r){LazyWrapper.prototype[n]=function(e){e=void 0===e?1:nativeMax(toInteger(e),0);var t=this.__filtered__&&!r?new LazyWrapper(this):this.clone();return t.__filtered__?t.__takeCount__=nativeMin(e,t.__takeCount__):t.__views__.push({size:nativeMin(e,MAX_ARRAY_LENGTH),type:n+(t.__dir__<0?"Right":"")}),t},LazyWrapper.prototype[n+"Right"]=function(e){return this.reverse()[n](e).reverse()}}),arrayEach(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==LAZY_FILTER_FLAG||n==LAZY_WHILE_FLAG;LazyWrapper.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:baseIteratee(e),type:n}),t.__filtered__=t.__filtered__||r,t}}),arrayEach(["head","last"],function(e,t){var n="take"+(t?"Right":"");LazyWrapper.prototype[e]=function(){return this[n](1).value()[0]}}),arrayEach(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");LazyWrapper.prototype[e]=function(){return this.__filtered__?new LazyWrapper(this):this[n](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(e){return this.filter(e).head()},LazyWrapper.prototype.findLast=function(e){return this.reverse().find(e)},LazyWrapper.prototype.invokeMap=baseRest(function(t,n){return"function"==typeof t?new LazyWrapper(this):this.map(function(e){return baseInvoke(e,t,n)})}),LazyWrapper.prototype.reject=function(e){return this.filter(negate(baseIteratee(e)))},LazyWrapper.prototype.slice=function(e,t){e=toInteger(e);var n=this;return n.__filtered__&&(0<e||t<0)?new LazyWrapper(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t?(t=toInteger(t))<0?n.dropRight(-t):n.take(t-e):n)},LazyWrapper.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH)},baseForOwn(LazyWrapper.prototype,function(h,e){var p=/^(?:filter|find|map|reject)|While$/.test(e),u=/^(?:head|last)$/.test(e),c=lodash[u?"take"+("last"==e?"Right":""):e],d=u||/^find/.test(e);c&&(lodash.prototype[e]=function(){function e(e){return e=c.apply(lodash,arrayPush([e],r)),u&&s?e[0]:e}var t,n=this.__wrapped__,r=u?[1]:arguments,i=n instanceof LazyWrapper,o=r[0],a=i||isArray(n),s=(a&&p&&"function"==typeof o&&1!=o.length&&(i=a=!1),this.__chain__),o=!!this.__actions__.length,l=d&&!s,i=i&&!o;return!d&&a?(n=i?n:new LazyWrapper(this),(t=h.apply(n,r)).__actions__.push({func:thru,args:[e],thisArg:void 0}),new LodashWrapper(t,s)):l&&i?h.apply(this,r):(t=this.thru(e),l?u?t.value()[0]:t.value():t)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(e){var n=arrayProto[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);lodash.prototype[e]=function(){var e,t=arguments;return i&&!this.__chain__?(e=this.value(),n.apply(isArray(e)?e:[],t)):this[r](function(e){return n.apply(isArray(e)?e:[],t)})}}),baseForOwn(LazyWrapper.prototype,function(e,t){var n,r=lodash[t];r&&(n=r.name+"",hasOwnProperty.call(realNames,n)||(realNames[n]=[]),realNames[n].push({name:t,func:r}))}),realNames[createHybrid(void 0,WRAP_BIND_KEY_FLAG).name]=[{name:"wrapper",func:void 0}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.at=seq.at,lodash.prototype.chain=seq.wrapperChain,lodash.prototype.commit=seq.commit,lodash.prototype.next=seq.next,lodash.prototype.plant=seq.plant,lodash.prototype.reverse=seq.reverse,lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=seq.value,lodash.prototype.first=lodash.prototype.head,symIterator&&(lodash.prototype[symIterator]=seq.toIterator),CurveEditor.sampleCurve=function(t,n){if(n){for(let e=0;e<n.length-1;++e){var r,i=n[e],o=n[e+1];if(!(o[0]<t))return r=o[0]-i[0],Math.abs(r)<1e-5?i[1]:(r=(t-i[0])/r,i[1]*(1-r)+o[1]*r)}return 0}},CurveEditor.prototype.draw=function(t,e,n,r,i,o){var a=this.points;if(a){var s=(this.size=e)[0]-2*this.margin,l=e[1]-2*this.margin;i=i||"#666",t.save(),t.translate(this.margin,this.margin),r&&(t.fillStyle="#111",t.fillRect(0,0,s,l),t.fillStyle="#222",t.fillRect(.5*s,0,1,l),t.strokeStyle="#333",t.strokeRect(0,0,s,l)),t.strokeStyle=i,o&&(t.globalAlpha=.5),t.beginPath();for(let e=0;e<a.length;++e){var h=a[e];t.lineTo(h[0]*s,(1-h[1])*l)}if(t.stroke(),t.globalAlpha=1,!o)for(let e=0;e<a.length;++e){var p=a[e];t.fillStyle=this.selected==e?"#FFF":this.nearest==e?"#DDD":"#AAA",t.beginPath(),t.arc(p[0]*s,(1-p[1])*l,2,0,2*Math.PI),t.fill()}t.restore()}},CurveEditor.prototype.onMouseDown=function(e,t){let n=this.points;var r,i,o;if(n&&!(e[1]<0))return r=this.size[0]-2*this.margin,i=this.size[1]-2*this.margin,o=e[0]-this.margin,e=e[1]-this.margin,t=30/t.ds.scale,this.selected=this.getCloserPoint([o,e],t),-1==this.selected&&(t=[o/r,1-e/i],n.push(t),n.sort(function(e,t){return e[0]-t[0]}),this.selected=n.indexOf(t),this.must_update=!0),-1!=this.selected||void 0},CurveEditor.prototype.onMouseMove=function(t,n){let r=this.points;if(r){var i=this.selected;if(!(i<0)){var o=(t[0]-this.margin)/(this.size[0]-2*this.margin),a=(t[1]-this.margin)/(this.size[1]-2*this.margin),s=[t[0]-this.margin,t[1]-this.margin],n=30/n.ds.scale;this._nearest=this.getCloserPoint(s,n);let e=r[i];e&&(!(s=0==i||i==r.length-1)&&(t[0]<-10||t[0]>this.size[0]+10||t[1]<-10||t[1]>this.size[1]+10)?(r.splice(i,1),this.selected=-1):(e[0]=s?0==i?0:1:Math.clamp(o,0,1),e[1]=1-Math.clamp(a,0,1),r.sort(function(e,t){return e[0]-t[0]}),this.selected=r.indexOf(e),this.must_update=!0))}}},CurveEditor.prototype.onMouseUp=function(e,t){return!(this.selected=-1)},CurveEditor.prototype.getCloserPoint=function(t,n){var r=this.points;if(!r)return-1;n=n||30;var i=this.size[0]-2*this.margin,o=this.size[1]-2*this.margin,a=r.length;let s=[0,0],l=1e6,h=-1;for(let e=0;e<a;++e){var p=r[e],p=(s[0]=p[0]*i,s[1]=(1-p[1])*o,s[0],t[0],vec2.distance(t,s));p>l||n<p||(h=e,l=p)}return h},ContextMenu.trigger=function(e,t,n,r){const i=new CustomEvent("CustomEvent");return i.initCustomEvent(t,!0,!0,n),i.target=r,e.dispatchEvent?e.dispatchEvent(i):e.__events&&e.__events.dispatchEvent(i),i},ContextMenu.isCursorOverElement=function(e,t){var n=e.clientX,e=e.clientY,t=t.getBoundingClientRect();return!!t&&(e>t.top&&e<t.top+t.height&&n>t.left&&n<t.left+t.width)},ContextMenu.prototype.addItem=function(e,t,r){let i=this,n=(r=r||{},document.createElement("div")),o=!(n.className="litemenu-entry submenu");function a(e){let t=this.value,n=!0;if((i.current_submenu&&i.current_submenu.close(e),r.callback&&!0===r.callback.call(this,t,r,e,i,r.node)&&(n=!1),t)&&(t.callback&&!r.ignore_item_callbacks&&!0!==t.disabled&&!0===t.callback.call(this,t,r,e,i,r.extra)&&(n=!1),t.submenu)){if(!t.submenu.options)throw"ContextMenu submenu needs options";new i.constructor(t.submenu.options,{callback:t.submenu.callback,event:e,parentMenu:i,ignore_item_callbacks:t.submenu.ignore_item_callbacks,title:t.submenu.title,extra:t.submenu.extra,autoopen:r.autoopen}),n=!1}n&&!i.lock&&i.close()}return null===t?n.classList.add("separator"):(n.innerHTML=t&&t.title?t.title:e,(n.value=t)&&(t.disabled&&(o=!0,n.classList.add("disabled")),(t.submenu||t.has_submenu)&&n.classList.add("has_submenu")),"function"==typeof t?(n.dataset.value=e,n.onclick_callback=t):n.dataset.value=t,t.className&&(n.className+=" "+t.className)),this.root.appendChild(n),o||n.addEventListener("click",a),r.autoopen&&LiteGraph$2.pointerListenerAdd(n,"enter",function(e){var t=this.value;t&&t.has_submenu&&a.call(this,e)}),n},ContextMenu.prototype.close=function(e,t){this.root.parentNode&&this.root.parentNode.removeChild(this.root),this.parentMenu&&!t&&(this.parentMenu.lock=!1,this.parentMenu.current_submenu=null,void 0===e?this.parentMenu.close():e&&!ContextMenu.isCursorOverElement(e,this.parentMenu.root)&&ContextMenu.trigger(this.parentMenu.root,LiteGraph$2.pointerevents_method+"leave",e)),this.current_submenu&&this.current_submenu.close(e,!0),this.root.closing_timer&&clearTimeout(this.root.closing_timer)},ContextMenu.prototype.getTopMenu=function(){return this.options.parentMenu?this.options.parentMenu.getTopMenu():this},ContextMenu.prototype.getFirstEvent=function(){return this.options.parentMenu?this.options.parentMenu.getFirstEvent():this.options.event},DragAndScale.prototype.bindEvents=function(e){this.last_mouse=new Float32Array(2),this._binded_mouse_callback=this.onMouse.bind(this),LiteGraph.pointerListenerAdd(e,"down",this._binded_mouse_callback),LiteGraph.pointerListenerAdd(e,"move",this._binded_mouse_callback),LiteGraph.pointerListenerAdd(e,"up",this._binded_mouse_callback),e.addEventListener("mousewheel",this._binded_mouse_callback,!1),e.addEventListener("wheel",this._binded_mouse_callback,!1)},DragAndScale.prototype.computeVisibleArea=function(i){if(this.element){let e=this.element.width,t=this.element.height,n=-this.offset[0],r=-this.offset[1];i&&(n+=i[0]/this.scale,r+=i[1]/this.scale,e=i[2],t=i[3]);var i=n+e/this.scale,o=r+t/this.scale;this.visible_area[0]=n,this.visible_area[1]=r,this.visible_area[2]=i-n,this.visible_area[3]=o-r}else this.visible_area[0]=this.visible_area[1]=this.visible_area[2]=this.visible_area[3]=0},DragAndScale.prototype.onMouse=function(n){if(this.enabled){let e=this.element;var r,i,o=e.getBoundingClientRect(),a=n.clientX-o.left,o=n.clientY-o.top,s=(n.canvasx=a,n.canvasy=o,n.dragging=this.dragging,!this.viewport||this.viewport&&a>=this.viewport[0]&&a<this.viewport[0]+this.viewport[2]&&o>=this.viewport[1]&&o<this.viewport[1]+this.viewport[3]);let t=!1;return this.onmouse&&(t=this.onmouse(n)),n.type==LiteGraph.pointerevents_method+"down"&&s?(this.dragging=!0,LiteGraph.pointerListenerRemove(e,"move",this._binded_mouse_callback),LiteGraph.pointerListenerAdd(document,"move",this._binded_mouse_callback),LiteGraph.pointerListenerAdd(document,"up",this._binded_mouse_callback)):n.type==LiteGraph.pointerevents_method+"move"?t||(r=a-this.last_mouse[0],i=o-this.last_mouse[1],this.dragging&&this.mouseDrag(r,i)):n.type==LiteGraph.pointerevents_method+"up"?(this.dragging=!1,LiteGraph.pointerListenerRemove(document,"move",this._binded_mouse_callback),LiteGraph.pointerListenerRemove(document,"up",this._binded_mouse_callback),LiteGraph.pointerListenerAdd(e,"move",this._binded_mouse_callback)):!s||"mousewheel"!=n.type&&"wheel"!=n.type&&"DOMMouseScroll"!=n.type||(n.eventType="mousewheel","wheel"==n.type?n.wheel=-n.deltaY:n.wheel=null!=n.wheelDeltaY?n.wheelDeltaY:-60*n.detail,n.delta=n.wheelDelta?n.wheelDelta/40:n.deltaY?-n.deltaY/3:0,this.changeDeltaScale(1+.05*n.delta)),this.last_mouse[0]=a,this.last_mouse[1]=o,s?(n.preventDefault(),n.stopPropagation(),!1):void 0}},DragAndScale.prototype.toCanvasContext=function(e){e.scale(this.scale,this.scale),e.translate(this.offset[0],this.offset[1])},DragAndScale.prototype.convertOffsetToCanvas=function(e){return[(e[0]+this.offset[0])*this.scale,(e[1]+this.offset[1])*this.scale]},DragAndScale.prototype.convertCanvasToOffset=function(e,t){return(t=t||[0,0])[0]=e[0]/this.scale-this.offset[0],t[1]=e[1]/this.scale-this.offset[1],t},DragAndScale.prototype.mouseDrag=function(e,t){this.offset[0]+=e/this.scale,this.offset[1]+=t/this.scale,this.onredraw&&this.onredraw(this)},DragAndScale.prototype.changeScale=function(e,t){var n;e<this.min_scale?e=this.min_scale:e>this.max_scale&&(e=this.max_scale),e!=this.scale&&this.element&&(n=this.element.getBoundingClientRect())&&(t=t||[.5*n.width,.5*n.height],n=this.convertCanvasToOffset(t),this.scale=e,Math.abs(this.scale-1)<.01&&(this.scale=1),t=[(e=this.convertCanvasToOffset(t))[0]-n[0],e[1]-n[1]],this.offset[0]+=t[0],this.offset[1]+=t[1],this.onredraw&&this.onredraw(this))},DragAndScale.prototype.changeDeltaScale=function(e,t){this.changeScale(this.scale*e,t)},DragAndScale.prototype.reset=function(){this.scale=1,this.offset[0]=0,this.offset[1]=0},LLink.prototype.configure=function(e){e.constructor===Array?(this.id=e[0],this.origin_id=e[1],this.origin_slot=e[2],this.target_id=e[3],this.target_slot=e[4],this.type=e[5]):(this.id=e.id,this.type=e.type,this.origin_id=e.origin_id,this.origin_slot=e.origin_slot,this.target_id=e.target_id,this.target_slot=e.target_slot)},LLink.prototype.serialize=function(){return[this.id,this.origin_id,this.origin_slot,this.target_id,this.target_slot,this.type]},LGraphNode.prototype._ctor=function(e){this.title=e||"Unnamed",this.size=[LiteGraph$2.NODE_WIDTH,60],this.graph=null,this._pos=new Float32Array(10,10),Object.defineProperty(this,"pos",{set:function(e){!e||e.length<2||(this._pos[0]=e[0],this._pos[1]=e[1])},get:function(){return this._pos},enumerable:!0}),this.id=-1,this.type=null,this.inputs=[],this.outputs=[],this.connections=[],this.properties={},this.properties_info=[],this.flags={}},LGraphNode.prototype.configure=function(t){for(var e in this.graph&&this.graph._version++,t)if("properties"==e)for(var n in t.properties)this.properties[n]=t.properties[n],this.onPropertyChanged&&this.onPropertyChanged(n,t.properties[n]);else null!=t[e]&&("object"==typeof t[e]?this[e]&&this[e].configure?this[e].configure(t[e]):this[e]=LiteGraph$2.cloneObject(t[e],this[e]):this[e]=t[e]);if(t.title||(this.title=this.constructor.title),this.inputs)for(let e=0;e<this.inputs.length;++e){var r=this.inputs[e],i=this.graph?this.graph.links[r.link]:null;this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.INPUT,e,!0,i,r),this.onInputAdded&&this.onInputAdded(r)}if(this.outputs)for(let t=0;t<this.outputs.length;++t){var o=this.outputs[t];if(o.links){for(let e=0;e<o.links.length;++e){var a=this.graph?this.graph.links[o.links[e]]:null;this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.OUTPUT,t,!0,a,o)}this.onOutputAdded&&this.onOutputAdded(o)}}if(this.widgets){for(let t=0;t<this.widgets.length;++t){let e=this.widgets[t];e&&e.options&&e.options.property&&this.properties[e.options.property]&&(e.value=JSON.parse(JSON.stringify(this.properties[e.options.property])))}if(t.widgets_values)for(let e=0;e<t.widgets_values.length;++e)this.widgets[e]&&(this.widgets[e].value=t.widgets_values[e])}this.onConfigure&&this.onConfigure(t)},LGraphNode.prototype.serialize=function(){let t={id:this.id,type:this.type,pos:this.pos,size:this.size,flags:LiteGraph$2.cloneObject(this.flags),order:this.order,mode:this.mode};if(this.constructor===LGraphNode&&this.last_serialization)return this.last_serialization;if(this.inputs&&(t.inputs=this.inputs),this.outputs){for(let e=0;e<this.outputs.length;e++)delete this.outputs[e]._data;t.outputs=this.outputs}if(this.title&&this.title!=this.constructor.title&&(t.title=this.title),this.properties&&(t.properties=LiteGraph$2.cloneObject(this.properties)),this.widgets&&this.serialize_widgets){t.widgets_values=[];for(let e=0;e<this.widgets.length;++e)this.widgets[e]?t.widgets_values[e]=this.widgets[e].value:t.widgets_values[e]=null}return t.type||(t.type=this.constructor.type),this.color&&(t.color=this.color),this.bgcolor&&(t.bgcolor=this.bgcolor),this.boxcolor&&(t.boxcolor=this.boxcolor),this.shape&&(t.shape=this.shape),this.onSerialize&&this.onSerialize(t)&&console.warn("node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter"),t},LGraphNode.prototype.clone=function(){let e=LiteGraph$2.createNode(this.type);if(!e)return null;let t=LiteGraph$2.cloneObject(this.serialize());if(t.inputs)for(let e=0;e<t.inputs.length;++e)t.inputs[e].link=null;if(t.outputs)for(let e=0;e<t.outputs.length;++e)t.outputs[e].links&&(t.outputs[e].links.length=0);return delete t.id,e.configure(t),e},LGraphNode.prototype.toString=function(){return JSON.stringify(this.serialize())},LGraphNode.prototype.getTitle=function(){return this.title||this.constructor.title},LGraphNode.prototype.setProperty=function(n,r){if(this.properties||(this.properties={}),r!==this.properties[n]){var e=this.properties[n];if(this.properties[n]=r,this.onPropertyChanged&&!1===this.onPropertyChanged(n,r,e)&&(this.properties[n]=e),this.widgets)for(let t=0;t<this.widgets.length;++t){let e=this.widgets[t];if(e&&e.options.property==n){e.value=r;break}}}},LGraphNode.prototype.setOutputData=function(n,r){if(this.outputs&&!(-1==n||n>=this.outputs.length)){let e=this.outputs[n];if(e&&(e._data=r,this.outputs[n].links))for(let t=0;t<this.outputs[n].links.length;t++){var i=this.outputs[n].links[t];let e=this.graph.links[i];e&&(e.data=r)}}},LGraphNode.prototype.setOutputDataType=function(t,n){if(this.outputs&&!(-1==t||t>=this.outputs.length)){let e=this.outputs[t];if(e&&(e.type=n,this.outputs[t].links))for(let e=0;e<this.outputs[t].links.length;e++){var r=this.outputs[t].links[e];this.graph.links[r].type=n}}},LGraphNode.prototype.getInputData=function(t,e){if(this.inputs&&!(t>=this.inputs.length||null==this.inputs[t].link)){t=this.inputs[t].link,t=this.graph.links[t];if(!t)return null;if(e){let e=this.graph.getNodeById(t.origin_id);e&&(e.updateOutputData?e.updateOutputData(t.origin_slot):e.onExecute&&e.onExecute())}return t.data}},LGraphNode.prototype.getInputDataType=function(e){var t;return this.inputs&&!(e>=this.inputs.length||null==this.inputs[e].link)&&(e=this.inputs[e].link,e=this.graph.links[e])?(t=this.graph.getNodeById(e.origin_id))?(t=t.outputs[e.origin_slot])?t.type:null:e.type:null},LGraphNode.prototype.getInputDataByName=function(e,t){e=this.findInputSlot(e);return-1==e?null:this.getInputData(e,t)},LGraphNode.prototype.isInputConnected=function(e){return!!this.inputs&&(e<this.inputs.length&&null!=this.inputs[e].link)},LGraphNode.prototype.getInputInfo=function(e){return this.inputs&&e<this.inputs.length?this.inputs[e]:null},LGraphNode.prototype.getInputLink=function(e){return this.inputs&&e<this.inputs.length?(e=this.inputs[e],this.graph.links[e.link]):null},LGraphNode.prototype.getInputNode=function(e){return this.inputs&&!(e>=this.inputs.length)&&(e=this.inputs[e])&&null!==e.link&&(e=this.graph.links[e.link])?this.graph.getNodeById(e.origin_id):null},LGraphNode.prototype.getInputOrProperty=function(n){if(!this.inputs||!this.inputs.length)return this.properties?this.properties[n]:null;for(let e=0,t=this.inputs.length;e<t;++e){var r=this.inputs[e];if(n==r.name&&null!=r.link){r=this.graph.links[r.link];if(r)return r.data}}return this.properties[n]},LGraphNode.prototype.getOutputData=function(e){return!this.outputs||e>=this.outputs.length?null:this.outputs[e]._data},LGraphNode.prototype.getOutputInfo=function(e){return this.outputs&&e<this.outputs.length?this.outputs[e]:null},LGraphNode.prototype.isOutputConnected=function(e){return!!this.outputs&&(e<this.outputs.length&&this.outputs[e].links&&this.outputs[e].links.length)},LGraphNode.prototype.isAnyOutputConnected=function(){if(this.outputs)for(let e=0;e<this.outputs.length;++e)if(this.outputs[e].links&&this.outputs[e].links.length)return!0;return!1},LGraphNode.prototype.getOutputNodes=function(e){if(!this.outputs||0==this.outputs.length)return null;if(e>=this.outputs.length)return null;var t=this.outputs[e];if(!t.links||0==t.links.length)return null;let n=[];for(let e=0;e<t.links.length;e++){var r=t.links[e],r=this.graph.links[r];!r||(r=this.graph.getNodeById(r.target_id))&&n.push(r)}return n},LGraphNode.prototype.addOnTriggerInput=function(){var e=this.findInputSlot("onTrigger");return-1==e?(this.addInput("onTrigger",LiteGraph$2.EVENT,{optional:!0,nameLocked:!0}),this.findInputSlot("onTrigger")):e},LGraphNode.prototype.addOnExecutedOutput=function(){var e=this.findOutputSlot("onExecuted");return-1==e?(this.addOutput("onExecuted",LiteGraph$2.ACTION,{optional:!0,nameLocked:!0}),this.findOutputSlot("onExecuted")):e},LGraphNode.prototype.onAfterExecuteNode=function(e,t){var n=this.findOutputSlot("onExecuted");-1!=n&&this.triggerSlot(n,e,null,t)},LGraphNode.prototype.changeMode=function(e){switch(e){case LiteGraph$2.ON_EVENT:break;case LiteGraph$2.ON_TRIGGER:this.addOnTriggerInput(),this.addOnExecutedOutput();break;case LiteGraph$2.NEVER:case LiteGraph$2.ALWAYS:case LiteGraph$2.ON_REQUEST:break;default:return!1}return this.mode=e,!0},LGraphNode.prototype.doExecute=function(e,t){t=t||{},this.onExecute&&(t.action_call||(t.action_call=this.id+"_exec_"+Math.floor(9999*Math.random())),this.graph.nodes_executing[this.id]=!0,this.onExecute(e,t),this.graph.nodes_executing[this.id]=!1,this.exec_version=this.graph.iteration,t&&t.action_call&&(this.action_call=t.action_call,this.graph.nodes_executedAction[this.id]=t.action_call)),this.execute_triggered=2,this.onAfterExecuteNode&&this.onAfterExecuteNode(e,t)},LGraphNode.prototype.actionDo=function(e,t,n){n=n||{},this.onAction&&(n.action_call||(n.action_call=this.id+"_"+(e||"action")+"_"+Math.floor(9999*Math.random())),this.graph.nodes_actioning[this.id]=e||"actioning",this.onAction(e,t,n),this.graph.nodes_actioning[this.id]=!1,n&&n.action_call&&(this.action_call=n.action_call,this.graph.nodes_executedAction[this.id]=n.action_call)),this.action_triggered=2,this.onAfterExecuteNode&&this.onAfterExecuteNode(t,n)},LGraphNode.prototype.trigger=function(t,n,r){if(this.outputs&&this.outputs.length){this.graph&&(this.graph._last_trigger_time=LiteGraph$2.getTime());for(let e=0;e<this.outputs.length;++e){var i=this.outputs[e];!i||i.type!==LiteGraph$2.EVENT||t&&i.name!=t||this.triggerSlot(e,n,null,r)}}},LGraphNode.prototype.triggerSlot=function(e,n,t,r){if(r=r||{},this.outputs){e=this.outputs[e];if(e){var i=e.links;if(i&&i.length){this.graph&&(this.graph._last_trigger_time=LiteGraph$2.getTime());for(let e=0;e<i.length;++e){var o=i[e];if(null==t||t==o){let t=this.graph.links[i[e]];if(t){t._last_time=LiteGraph$2.getTime();let e=this.graph.getNodeById(t.target_id);e&&(e.inputs[t.target_slot],e.mode===LiteGraph$2.ON_TRIGGER?(r.action_call||(r.action_call=this.id+"_trigg_"+Math.floor(9999*Math.random())),e.onExecute&&e.doExecute(n,r)):e.onAction&&(r.action_call||(r.action_call=this.id+"_act_"+Math.floor(9999*Math.random())),o=e.inputs[t.target_slot],e.actionDo(o.name,n,r)))}}}}}}},LGraphNode.prototype.clearTriggeredSlot=function(e,n){if(this.outputs){e=this.outputs[e];if(e){var r=e.links;if(r&&r.length)for(let t=0;t<r.length;++t){var i=r[t];if(null==n||n==i){let e=this.graph.links[r[t]];e&&(e._last_time=0)}}}}},LGraphNode.prototype.setSize=function(e){this.size=e,this.onResize&&this.onResize(this.size)},LGraphNode.prototype.addProperty=function(e,t,n,r){let i={name:e,type:n,default_value:t};if(r)for(var o in r)i[o]=r[o];return this.properties_info||(this.properties_info=[]),this.properties_info.push(i),this.properties||(this.properties={}),this.properties[e]=t,i},LGraphNode.prototype.addOutput=function(e,t,n){let r={name:e,type:t,links:null};if(n)for(var i in n)r[i]=n[i];return this.outputs||(this.outputs=[]),this.outputs.push(r),this.onOutputAdded&&this.onOutputAdded(r),LiteGraph$2.auto_load_slot_types&&LiteGraph$2.registerNodeAndSlotType(this,t,!0),this.setSize(this.computeSize()),this.setDirtyCanvas(!0,!0),r},LGraphNode.prototype.addOutputs=function(n){for(let t=0;t<n.length;++t){var r=n[t];let e={name:r[0],type:r[1],link:null};if(n[2])for(var i in r[2])e[i]=r[2][i];this.outputs||(this.outputs=[]),this.outputs.push(e),this.onOutputAdded&&this.onOutputAdded(e),LiteGraph$2.auto_load_slot_types&&LiteGraph$2.registerNodeAndSlotType(this,r[1],!0)}this.setSize(this.computeSize()),this.setDirtyCanvas(!0,!0)},LGraphNode.prototype.removeOutput=function(t){this.disconnectOutput(t),this.outputs.splice(t,1);for(let e=t;e<this.outputs.length;++e)if(this.outputs[e]&&this.outputs[e].links){var n=this.outputs[e].links;for(let t=0;t<n.length;++t){let e=this.graph.links[n[t]];e&&--e.origin_slot}}this.setSize(this.computeSize()),this.onOutputRemoved&&this.onOutputRemoved(t),this.setDirtyCanvas(!0,!0)},LGraphNode.prototype.addInput=function(e,t,n){let r={name:e,type:t=t||0,link:null};if(n)for(var i in n)r[i]=n[i];return this.inputs||(this.inputs=[]),this.inputs.push(r),this.setSize(this.computeSize()),this.onInputAdded&&this.onInputAdded(r),LiteGraph$2.registerNodeAndSlotType(this,t),this.setDirtyCanvas(!0,!0),r},LGraphNode.prototype.addInputs=function(n){for(let t=0;t<n.length;++t){var r=n[t];let e={name:r[0],type:r[1],link:null};if(n[2])for(var i in r[2])e[i]=r[2][i];this.inputs||(this.inputs=[]),this.inputs.push(e),this.onInputAdded&&this.onInputAdded(e),LiteGraph$2.registerNodeAndSlotType(this,r[1])}this.setSize(this.computeSize()),this.setDirtyCanvas(!0,!0)},LGraphNode.prototype.removeInput=function(e){this.disconnectInput(e);var t=this.inputs.splice(e,1);for(let t=e;t<this.inputs.length;++t)if(this.inputs[t]){let e=this.graph.links[this.inputs[t].link];e&&--e.target_slot}this.setSize(this.computeSize()),this.onInputRemoved&&this.onInputRemoved(e,t[0]),this.setDirtyCanvas(!0,!0)},LGraphNode.prototype.addConnection=function(e,t,n,r){e={name:e,type:t,pos:n,direction:r,links:null};return this.connections.push(e),e},LGraphNode.prototype.computeSize=function(e){if(this.constructor.size)return this.constructor.size.concat();var t=Math.max(this.inputs?this.inputs.length:1,this.outputs?this.outputs.length:1);let n=e||new Float32Array([0,0]),r=(t=Math.max(t,1),LiteGraph$2.NODE_TEXT_SIZE);e=h(this.title);let i=0,o=0;if(this.inputs)for(let e=0,t=this.inputs.length;e<t;++e){var a=this.inputs[e],a=h(a.label||a.name||"");i<a&&(i=a)}if(this.outputs)for(let e=0,t=this.outputs.length;e<t;++e){var s=this.outputs[e],s=h(s.label||s.name||"");o<s&&(o=s)}n[0]=Math.max(i+o+10,e),n[0]=Math.max(n[0],LiteGraph$2.NODE_WIDTH),this.widgets&&this.widgets.length&&(n[0]=Math.max(n[0],1.5*LiteGraph$2.NODE_WIDTH)),n[1]=(this.constructor.slot_start_y||0)+t*LiteGraph$2.NODE_SLOT_HEIGHT;let l=0;if(this.widgets&&this.widgets.length){for(let e=0,t=this.widgets.length;e<t;++e)this.widgets[e].computeSize?l+=this.widgets[e].computeSize(n[0])[1]+4:l+=LiteGraph$2.NODE_WIDGET_HEIGHT+4;l+=8}function h(e){return e?r*e.length*.6:0}return this.widgets_up?n[1]=Math.max(n[1],l):null!=this.widgets_start_y?n[1]=Math.max(n[1],l+this.widgets_start_y):n[1]+=l,this.constructor.min_height&&n[1]<this.constructor.min_height&&(n[1]=this.constructor.min_height),n[1]+=6,n},LGraphNode.prototype.getPropertyInfo=function(t){let n=null;if(this.properties_info)for(let e=0;e<this.properties_info.length;++e)if(this.properties_info[e].name==t){n=this.properties_info[e];break}return this.constructor["@"+t]&&(n=this.constructor["@"+t]),(n=(n=!(n=this.constructor.widgets_info&&this.constructor.widgets_info[t]?this.constructor.widgets_info[t]:n)&&this.onGetPropertyInfo?this.onGetPropertyInfo(t):n)||{}).type||(n.type=typeof this.properties[t]),"combo"==n.widget&&(n.type="enum"),n},LGraphNode.prototype.addWidget=function(e,t,n,r,i){this.widgets||(this.widgets=[]),!i&&r&&r.constructor===Object&&(i=r,r=null),i&&i.constructor===String&&(i={property:i}),r&&r.constructor===String&&((i=i||{}).property=r,r=null),r&&r.constructor!==Function&&(console.warn("addWidget: callback must be a function"),r=null);let o={type:e.toLowerCase(),name:t,value:n,callback:r,options:i||{}};if(void 0!==o.options.y&&(o.y=o.options.y),r||o.options.callback||o.options.property||console.warn("LiteGraph addWidget(...) without a callback or property assigned"),"combo"!=e||o.options.values)return this.widgets.push(o),this.setSize(this.computeSize()),o;throw"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }"},LGraphNode.prototype.addCustomWidget=function(e){return this.widgets||(this.widgets=[]),this.widgets.push(e),e},LGraphNode.prototype.getBounding=function(e){return(e=e||new Float32Array(4))[0]=this.pos[0]-4,e[1]=this.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT,e[2]=this.size[0]+4,e[3]=this.flags.collapsed?LiteGraph$2.NODE_TITLE_HEIGHT:this.size[1]+LiteGraph$2.NODE_TITLE_HEIGHT,this.onBounding&&this.onBounding(e),e},LGraphNode.prototype.isPointInside=function(e,t,n,r){n=n||0;let i=this.graph&&this.graph.isLive()?0:LiteGraph$2.NODE_TITLE_HEIGHT;if(r&&(i=0),this.flags&&this.flags.collapsed){if(isInsideRectangle(e,t,this.pos[0]-n,this.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT-n,(this._collapsed_width||LiteGraph$2.NODE_COLLAPSED_WIDTH)+2*n,LiteGraph$2.NODE_TITLE_HEIGHT+2*n))return!0}else if(this.pos[0]-4-n<e&&this.pos[0]+this.size[0]+4+n>e&&this.pos[1]-i-n<t&&this.pos[1]+this.size[1]+n>t)return!0;return!1},LGraphNode.prototype.getSlotInPosition=function(n,r){var i=new Float32Array(2);if(this.inputs)for(let e=0,t=this.inputs.length;e<t;++e){var o=this.inputs[e];if(this.getConnectionPos(!0,e,i),isInsideRectangle(n,r,i[0]-10,i[1]-5,20,10))return{input:o,slot:e,link_pos:i}}if(this.outputs)for(let e=0,t=this.outputs.length;e<t;++e){var a=this.outputs[e];if(this.getConnectionPos(!1,e,i),isInsideRectangle(n,r,i[0]-10,i[1]-5,20,10))return{output:a,slot:e,link_pos:i}}return null},LGraphNode.prototype.findInputSlot=function(n,r){if(this.inputs)for(let e=0,t=this.inputs.length;e<t;++e)if(n==this.inputs[e].name)return r?this.inputs[e]:e;return-1},LGraphNode.prototype.findOutputSlot=function(n,r){if(r=r||!1,this.outputs)for(let e=0,t=this.outputs.length;e<t;++e)if(n==this.outputs[e].name)return r?this.outputs[e]:e;return-1},LGraphNode.prototype.findInputSlotFree=function(e){e=e||{};let n=Object.assign({returnObj:!1,typesNotAccepted:[]},e);if(this.inputs)for(let e=0,t=this.inputs.length;e<t;++e)if(!(this.inputs[e].link&&null!=this.inputs[e].link||n.typesNotAccepted&&n.typesNotAccepted.includes&&n.typesNotAccepted.includes(this.inputs[e].type)))return n.returnObj?this.inputs[e]:e;return-1},LGraphNode.prototype.findOutputSlotFree=function(e){e=e||{};let n=Object.assign({returnObj:!1,typesNotAccepted:[]},e);if(this.outputs)for(let e=0,t=this.outputs.length;e<t;++e)if(!(this.outputs[e].links&&null!=this.outputs[e].links||n.typesNotAccepted&&n.typesNotAccepted.includes&&n.typesNotAccepted.includes(this.outputs[e].type)))return n.returnObj?this.outputs[e]:e;return-1},LGraphNode.prototype.findInputSlotByType=function(e,t,n,r){return this.findSlotByType(!0,e,t,n,r)},LGraphNode.prototype.findOutputSlotByType=function(e,t,n,r){return this.findSlotByType(!1,e,t,n,r)},LGraphNode.prototype.findSlotByType=function(e,o,a,s,t){a=a||!1,s=s||!1,t=t||!1;var l=(e=e||!1)?this.inputs:this.outputs;if(l){""!=o&&"*"!=o||(o=0);for(let i=0,e=l.length;i<e;++i){let n=(o+"").toLowerCase().split(","),r="0"==l[i].type||"*"==l[i].type?"0":l[i].type;r=(r+"").toLowerCase().split(",");for(let t=0;t<n.length;t++)for(let e=0;e<r.length;e++)if("_event_"==n[t]&&(n[t]=LiteGraph$2.EVENT),"_event_"==r[t]&&(r[t]=LiteGraph$2.EVENT),"*"==n[t]&&(n[t]=0),"*"==r[t]&&(r[t]=0),!(n[t]!=r[e]||s&&l[i].links&&null!==l[i].links))return a?l[i]:i}if(s&&!t)for(let r=0,e=l.length;r<e;++r){let t=(o+"").toLowerCase().split(","),n="0"==l[r].type||"*"==l[r].type?"0":l[r].type;n=(n+"").toLowerCase().split(",");for(let e=0;e<t.length;e++)for(dI=0;dI<n.length;dI++)if("*"==t[e]&&(t[e]=0),"*"==n[e]&&(n[e]=0),t[e]==n[dI])return a?l[r]:r}}return-1},LGraphNode.prototype.connectByType=function(e,t,n,r){r=r||{};var r=Object.assign({createEventInCase:!0,firstFreeIfOutputGeneralInCase:!0,generalTypeInCase:!0},r),i=(t=t&&t.constructor===Number?this.graph.getNodeById(t):t).findInputSlotByType(n,!1,!0);if(0<=i&&null!==i)return this.connect(e,t,i);if(r.createEventInCase&&n==LiteGraph$2.EVENT)return this.connect(e,t,-1);if(r.generalTypeInCase){i=t.findInputSlotByType(0,!1,!0,!0);if(0<=i)return this.connect(e,t,i)}if(r.firstFreeIfOutputGeneralInCase&&(0==n||"*"==n||""==n)){i=t.findInputSlotFree({typesNotAccepted:[LiteGraph$2.EVENT]});if(0<=i)return this.connect(e,t,i)}return console.debug("no way to connect type: ",n," to targetNODE ",t),null},LGraphNode.prototype.connectByTypeOutput=function(e,t,n,r){r=r||{};r=Object.assign({createEventInCase:!0,firstFreeIfInputGeneralInCase:!0,generalTypeInCase:!0},r);if(t&&t.constructor===Number&&(t=this.graph.getNodeById(t)),0<=(source_slot=t.findOutputSlotByType(n,!1,!0))&&null!==source_slot)return t.connect(source_slot,this,e);if(r.generalTypeInCase){var i=t.findOutputSlotByType(0,!1,!0,!0);if(0<=i)return t.connect(i,this,e)}if(r.createEventInCase&&n==LiteGraph$2.EVENT&&LiteGraph$2.do_add_triggers_slots)return i=t.addOnExecutedOutput(),t.connect(i,this,e);if(r.firstFreeIfInputGeneralInCase&&(0==n||"*"==n||""==n)){i=t.findOutputSlotFree({typesNotAccepted:[LiteGraph$2.EVENT]});if(0<=i)return t.connect(i,this,e)}return console.debug("no way to connect byOUT type: ",n," to sourceNODE ",t),null},LGraphNode.prototype.connect=function(e,t,n){if(n=n||0,!this.graph)return console.log("Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them."),null;if(e.constructor===String){if(-1==(e=this.findOutputSlot(e)))return LiteGraph$2.debug&&console.log("Connect: Error, no slot of name "+e),null}else if(!this.outputs||e>=this.outputs.length)return LiteGraph$2.debug&&console.log("Connect: Error, slot number not found"),null;if(!(t=t&&t.constructor===Number?this.graph.getNodeById(t):t))throw"target node is null";if(t==this)return null;if(n.constructor===String){if(-1==(n=t.findInputSlot(n)))return LiteGraph$2.debug&&console.log("Connect: Error, no slot of name "+n),null}else if(n===LiteGraph$2.EVENT){if(!LiteGraph$2.do_add_triggers_slots)return null;t.changeMode(LiteGraph$2.ON_TRIGGER),n=t.findInputSlot("onTrigger")}else if(!t.inputs||n>=t.inputs.length)return LiteGraph$2.debug&&console.log("Connect: Error, slot number not found"),null;let r=!1;var i=t.inputs[n];let o=null,a=this.outputs[e];return this.outputs[e]?!1!==(n=t.onBeforeConnectInput?t.onBeforeConnectInput(n):n)&&null!==n&&LiteGraph$2.isValidConnection(a.type,i.type)?t.onConnectInput&&!1===t.onConnectInput(n,a.type,a,this,e)||this.onConnectOutput&&!1===this.onConnectOutput(e,i.type,i,t,n)?null:(t.inputs[n]&&null!=t.inputs[n].link&&(this.graph.beforeChange(),t.disconnectInput(n,{doProcessChange:!1}),r=!0),null!==a.links&&a.links.length&&a.type===LiteGraph$2.EVENT&&!LiteGraph$2.allow_multi_output_for_events&&(this.graph.beforeChange(),this.disconnectOutput(e,!1,{doProcessChange:!1}),r=!0),o=new LLink(++this.graph.last_link_id,i.type||a.type,this.id,e,t.id,n),this.graph.links[o.id]=o,null==a.links&&(a.links=[]),a.links.push(o.id),t.inputs[n].link=o.id,this.graph&&this.graph._version++,this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.OUTPUT,e,!0,o,a),t.onConnectionsChange&&t.onConnectionsChange(LiteGraph$2.INPUT,n,!0,o,i),this.graph&&this.graph.onNodeConnectionChange&&(this.graph.onNodeConnectionChange(LiteGraph$2.INPUT,t,n,this,e),this.graph.onNodeConnectionChange(LiteGraph$2.OUTPUT,this,e,t,n)),this.setDirtyCanvas(!1,!0),this.graph.afterChange(),this.graph.connectionChange(this,o),o):(this.setDirtyCanvas(!1,!0),r&&this.graph.connectionChange(this,o),null):null},LGraphNode.prototype.disconnectOutput=function(n,r){if(n.constructor===String){if(-1==(n=this.findOutputSlot(n)))return LiteGraph$2.debug&&console.log("Connect: Error, no slot of name "+n),!1}else if(!this.outputs||n>=this.outputs.length)return LiteGraph$2.debug&&console.log("Connect: Error, slot number not found"),!1;let i=this.outputs[n];if(!i||!i.links||0==i.links.length)return!1;if(r){if(!(r=r.constructor===Number?this.graph.getNodeById(r):r))throw"Target Node not found";for(let t=0,e=i.links.length;t<e;t++){var o=i.links[t],a=this.graph.links[o];if(a.target_id==r.id){i.links.splice(t,1);let e=r.inputs[a.target_slot];e.link=null,delete this.graph.links[o],this.graph&&this.graph._version++,r.onConnectionsChange&&r.onConnectionsChange(LiteGraph$2.INPUT,a.target_slot,!1,a,e),this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.OUTPUT,n,!1,a,i),this.graph&&this.graph.onNodeConnectionChange&&this.graph.onNodeConnectionChange(LiteGraph$2.OUTPUT,this,n),this.graph&&this.graph.onNodeConnectionChange&&(this.graph.onNodeConnectionChange(LiteGraph$2.OUTPUT,this,n),this.graph.onNodeConnectionChange(LiteGraph$2.INPUT,r,a.target_slot));break}}}else{for(let e=0,t=i.links.length;e<t;e++){var s=i.links[e],l=this.graph.links[s];if(l){let e=this.graph.getNodeById(l.target_id),t=null;this.graph&&this.graph._version++,e&&((t=e.inputs[l.target_slot]).link=null,e.onConnectionsChange&&e.onConnectionsChange(LiteGraph$2.INPUT,l.target_slot,!1,l,t),this.graph&&this.graph.onNodeConnectionChange&&this.graph.onNodeConnectionChange(LiteGraph$2.INPUT,e,l.target_slot)),delete this.graph.links[s],this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.OUTPUT,n,!1,l,i),this.graph&&this.graph.onNodeConnectionChange&&(this.graph.onNodeConnectionChange(LiteGraph$2.OUTPUT,this,n),this.graph.onNodeConnectionChange(LiteGraph$2.INPUT,e,l.target_slot))}}i.links=null}return this.setDirtyCanvas(!1,!0),this.graph.connectionChange(this),!0},LGraphNode.prototype.disconnectInput=function(t){if(t.constructor===String&&-1==(t=this.findInputSlot(t)))return LiteGraph$2.debug&&console.log("Connect: Error, no slot of name "+t),!1;if(!this.inputs||t>=this.inputs.length)return LiteGraph$2.debug&&console.log("Connect: Error, slot number not found"),!1;var i=this.inputs[t];if(!i)return!1;var o=this.inputs[t].link;if(null!=o){this.inputs[t].link=null;var a=this.graph.links[o];if(a){let e=this.graph.getNodeById(a.origin_id);if(!e)return!1;let n=e.outputs[a.origin_slot];if(!n||!n.links||0==n.links.length)return!1;let r=-1;for(let e=0,t=n.links.length;e<t;e++)if(n.links[e]==o){r=e,n.links.splice(e,1);break}delete this.graph.links[o],this.graph&&this.graph._version++,this.onConnectionsChange&&this.onConnectionsChange(LiteGraph$2.INPUT,t,!1,a,i),e.onConnectionsChange&&e.onConnectionsChange(LiteGraph$2.OUTPUT,r,!1,a,n),this.graph&&this.graph.onNodeConnectionChange&&(this.graph.onNodeConnectionChange(LiteGraph$2.OUTPUT,target_node,r),this.graph.onNodeConnectionChange(LiteGraph$2.INPUT,this,t))}}return this.setDirtyCanvas(!1,!0),this.graph&&this.graph.connectionChange(this),!0},LGraphNode.prototype.getConnectionPos=function(e,t,n){n=n||new Float32Array(2);let r=0;e&&this.inputs&&(r=this.inputs.length),!e&&this.outputs&&(r=this.outputs.length);var i,o=.5*LiteGraph$2.NODE_SLOT_HEIGHT;return this.flags.collapsed?(i=this._collapsed_width||LiteGraph$2.NODE_COLLAPSED_WIDTH,this.horizontal?(n[0]=this.pos[0]+.5*i,n[1]=e?this.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT:this.pos[1]):(n[0]=e?this.pos[0]:this.pos[0]+i,n[1]=this.pos[1]-.5*LiteGraph$2.NODE_TITLE_HEIGHT)):e&&-1==t?(n[0]=this.pos[0]+.5*LiteGraph$2.NODE_TITLE_HEIGHT,n[1]=this.pos[1]+.5*LiteGraph$2.NODE_TITLE_HEIGHT):e&&r>t&&this.inputs[t].pos?(n[0]=this.pos[0]+this.inputs[t].pos[0],n[1]=this.pos[1]+this.inputs[t].pos[1]):!e&&r>t&&this.outputs[t].pos?(n[0]=this.pos[0]+this.outputs[t].pos[0],n[1]=this.pos[1]+this.outputs[t].pos[1]):this.horizontal?(n[0]=this.pos[0]+(t+.5)*(this.size[0]/r),n[1]=e?this.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT:this.pos[1]+this.size[1]):(n[0]=e?this.pos[0]+o:this.pos[0]+this.size[0]+1-o,n[1]=this.pos[1]+(t+.7)*LiteGraph$2.NODE_SLOT_HEIGHT+(this.constructor.slot_start_y||0)),n},LGraphNode.prototype.alignToGrid=function(){this.pos[0]=LiteGraph$2.CANVAS_GRID_SIZE*Math.round(this.pos[0]/LiteGraph$2.CANVAS_GRID_SIZE),this.pos[1]=LiteGraph$2.CANVAS_GRID_SIZE*Math.round(this.pos[1]/LiteGraph$2.CANVAS_GRID_SIZE)},LGraphNode.prototype.trace=function(e){this.console||(this.console=[]),this.console.push(e),this.console.length>LGraphNode.MAX_CONSOLE&&this.console.shift(),this.graph.onNodeTrace&&this.graph.onNodeTrace(this,e)},LGraphNode.prototype.setDirtyCanvas=function(e,t){this.graph&&this.graph.sendActionToCanvas("setDirty",[e,t])},LGraphNode.prototype.loadImage=function(e){let t=new Image,n=(t.src=LiteGraph$2.node_images_path+e,t.ready=!1,this);return t.onload=function(){this.ready=!0,n.setDirtyCanvas(!0)},t},LGraphNode.prototype.captureInput=function(n){if(this.graph&&this.graph.list_of_graphcanvas){var r=this.graph.list_of_graphcanvas;for(let t=0;t<r.length;++t){let e=r[t];!n&&e.node_capturing_input!=this||(e.node_capturing_input=n?this:null)}}},LGraphNode.prototype.collapse=function(e){this.graph._version++,!1===this.constructor.collapsable&&!e||(this.flags.collapsed?this.flags.collapsed=!1:this.flags.collapsed=!0,this.setDirtyCanvas(!0,!0))},LGraphNode.prototype.pin=function(e){this.graph._version++,this.flags.pinned=void 0===e?!this.flags.pinned:e},LGraphNode.prototype.localToScreen=function(e,t,n){return[(e+this.pos[0])*n.scale+n.offset[0],(t+this.pos[1])*n.scale+n.offset[1]]};let canvas_bounding_vec4=new Float32Array(4),link_bounding_vec4=new Float32Array(4),temp_area_vec4=new Float32Array(4),temp_margin_vec4=new Float32Array(4),temp_size_vec2=new Float32Array(2),temp_slot_a_vec2=new Float32Array(2),temp_slot_b_vec2=new Float32Array(2),selIn,selOut,sIn,sOut,sV,filtered_extra;function LGraphCanvas(e,t,n){this.options=n=n||{},this.background_image=LGraphCanvas.DEFAULT_BACKGROUND_IMAGE,e&&e.constructor===String&&(e=document.querySelector(e)),this.ds=new DragAndScale,this.zoom_modify_alpha=!0,this.title_text_font=LiteGraph$2.NODE_TEXT_SIZE+"px Arial",this.inner_text_font="normal "+LiteGraph$2.NODE_SUBTEXT_SIZE+"px Arial",this.node_title_color=LiteGraph$2.NODE_TITLE_COLOR,this.default_link_color=LiteGraph$2.LINK_COLOR,this.default_connection_color={input_off:"#778",input_on:"#7F7",output_off:"#778",output_on:"#7F7"},this.default_connection_color_byType={},this.default_connection_color_byTypeOff={},this.highquality_render=!0,this.use_gradients=!1,this.editor_alpha=1,this.pause_rendering=!1,this.clear_background=!0,this.read_only=!1,this.render_only_selected=!0,this.live_mode=!1,this.show_info=!0,this.allow_dragcanvas=!0,this.allow_dragnodes=!0,this.allow_interaction=!0,this.allow_searchbox=!0,this.allow_reconnect_links=!0,this.align_to_grid=!1,this.drag_mode=!1,this.dragging_rectangle=null,this.filter=null,this.set_canvas_dirty_on_mouse_event=!0,this.always_render_background=!1,this.render_shadows=!0,this.render_canvas_border=!0,this.render_connections_shadows=!1,this.render_connections_border=!0,this.render_curved_connections=!1,this.render_connection_arrows=!1,this.render_collapsed_slots=!0,this.render_execution_order=!1,this.render_title_colored=!0,this.render_link_tooltip=!0,this.links_render_mode=LiteGraph$2.SPLINE_LINK,this.mouse=[0,0],this.graph_mouse=[0,0],this.canvas_mouse=this.graph_mouse,this.onSearchBox=null,this.onSearchBoxSelection=null,this.onMouse=null,this.onDrawBackground=null,this.onDrawForeground=null,this.onDrawOverlay=null,this.onDrawLinkTooltip=null,this.onNodeMoved=null,this.onSelectionChange=null,this.onConnectingChange=null,this.onBeforeChange=null,this.onAfterChange=null,this.connections_width=3,this.round_radius=8,this.current_node=null,this.node_widget=null,this.over_link_center=null,this.last_mouse_position=[0,0],this.visible_area=this.ds.visible_area,this.visible_links=[],this.viewport=n.viewport||null,t&&t.attachCanvas(this),this.setCanvas(e,n.skip_events),this.clear(),n.skip_render||this.startRendering(),this.autoresize=n.autoresize}function LGraphGroup(e){this._ctor(e)}function LGraph(e){LiteGraph$2.debug&&console.log("Graph created"),this.list_of_graphcanvas=null,this.clear(),e&&this.configure(e)}LGraphCanvas.DEFAULT_BACKGROUND_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=",LGraphCanvas.link_type_colors={number:"#AAA",node:"#DCA"},LGraphCanvas.gradients={},LGraphCanvas.prototype.clear=function(){this.frame=0,this.last_draw_time=0,this.render_time=0,this.fps=0,this.dragging_rectangle=null,this.selected_nodes={},this.selected_group=null,this.visible_nodes=[],this.node_dragged=null,this.node_over=null,this.node_capturing_input=null,this.connecting_node=null,this.highlighted_links={},this.dragging_canvas=!1,this.dirty_canvas=!0,this.dirty_bgcanvas=!0,this.dirty_area=null,this.node_in_panel=null,this.node_widget=null,this.last_mouse=[0,0],this.last_mouseclick=0,this.pointer_is_down=!1,this.pointer_is_double=!1,this.visible_area.set([0,0,0,0]),this.onClear&&this.onClear()},LGraphCanvas.prototype.setGraph=function(e,t){this.graph!=e&&(t||this.clear(),!e&&this.graph?this.graph.detachCanvas(this):(e.attachCanvas(this),this._graph_stack&&(this._graph_stack=null),this.setDirty(!0,!0)))},LGraphCanvas.prototype.getTopGraph=function(){return this._graph_stack.length?this._graph_stack[0]:this.graph},LGraphCanvas.prototype.openSubgraph=function(e){if(!e)throw"graph cannot be null";if(this.graph==e)throw"graph cannot be the same";this.clear(),this.graph&&(this._graph_stack||(this._graph_stack=[]),this._graph_stack.push(this.graph)),e.attachCanvas(this),this.checkPanels(),this.setDirty(!0,!0)},LGraphCanvas.prototype.closeSubgraph=function(){if(this._graph_stack&&0!=this._graph_stack.length){var t=this.graph._subgraph_node;let e=this._graph_stack.pop();this.selected_nodes={},this.highlighted_links={},e.attachCanvas(this),this.setDirty(!0,!0),t&&(this.centerOnNode(t),this.selectNodes([t])),this.ds.offset=[0,0],this.ds.scale=1}},LGraphCanvas.prototype.getCurrentGraph=function(){return this.graph},LGraphCanvas.prototype.setCanvas=function(e,t){if(e&&e.constructor===String&&!(e=document.getElementById(e)))throw"Error creating LiteGraph canvas: Canvas not found";if(e!==this.canvas&&(e||!this.canvas||t||this.unbindEvents(),this.canvas=e,this.ds.element=e)){if(e.className+=" lgraphcanvas",e.data=this,e.tabindex="1",this.bgcanvas=null,this.bgcanvas||(this.bgcanvas=document.createElement("canvas"),this.bgcanvas.width=this.canvas.width,this.bgcanvas.height=this.canvas.height),null==e.getContext){if("canvas"!=e.localName)throw"Element supplied for LGraphCanvas must be a <canvas> element, you passed a "+e.localName;throw"This browser doesn't support Canvas"}null==(this.ctx=e.getContext("2d"))&&(e.webgl_enabled||console.warn("This canvas seems to be WebGL, enabling WebGL renderer"),this.enableWebGL()),t||this.bindEvents()}},LGraphCanvas.prototype._doNothing=function(e){return e.preventDefault(),!1},LGraphCanvas.prototype._doReturnTrue=function(e){return e.preventDefault(),!0},LGraphCanvas.prototype.bindEvents=function(){if(this._events_binded)console.warn("LGraphCanvas: events already binded");else{let e=this.canvas;let t=this.getCanvasWindow().document;this._mousedown_callback=this.processMouseDown.bind(this),this._mousewheel_callback=this.processMouseWheel.bind(this),this._mousemove_callback=this.processMouseMove.bind(this),this._mouseup_callback=this.processMouseUp.bind(this),LiteGraph$2.pointerListenerAdd(e,"down",this._mousedown_callback,!0),e.addEventListener("mousewheel",this._mousewheel_callback,!1),LiteGraph$2.pointerListenerAdd(e,"up",this._mouseup_callback,!0),LiteGraph$2.pointerListenerAdd(e,"move",this._mousemove_callback),e.addEventListener("contextmenu",this._doNothing),e.addEventListener("DOMMouseScroll",this._mousewheel_callback,!1),this._key_callback=this.processKey.bind(this),e.addEventListener("keydown",this._key_callback,!0),t.addEventListener("keyup",this._key_callback,!0),this._ondrop_callback=this.processDrop.bind(this),e.addEventListener("dragover",this._doNothing,!1),e.addEventListener("dragend",this._doNothing,!1),e.addEventListener("drop",this._ondrop_callback,!1),e.addEventListener("dragenter",this._doReturnTrue,!1),this._events_binded=!0}},LGraphCanvas.prototype.unbindEvents=function(){if(this._events_binded){let e=this.getCanvasWindow().document;LiteGraph$2.pointerListenerRemove(this.canvas,"move",this._mousedown_callback),LiteGraph$2.pointerListenerRemove(this.canvas,"up",this._mousedown_callback),LiteGraph$2.pointerListenerRemove(this.canvas,"down",this._mousedown_callback),this.canvas.removeEventListener("mousewheel",this._mousewheel_callback),this.canvas.removeEventListener("DOMMouseScroll",this._mousewheel_callback),this.canvas.removeEventListener("keydown",this._key_callback),e.removeEventListener("keyup",this._key_callback),this.canvas.removeEventListener("contextmenu",this._doNothing),this.canvas.removeEventListener("drop",this._ondrop_callback),this.canvas.removeEventListener("dragenter",this._doReturnTrue),this._mousedown_callback=null,this._mousewheel_callback=null,this._key_callback=null,this._ondrop_callback=null,this._events_binded=!1}else console.warn("LGraphCanvas: no events binded")},LGraphCanvas.getFileExtension=function(e){var t=e.indexOf("?"),t=(e=-1!=t?e.substr(0,t):e).lastIndexOf(".");return-1==t?"":e.substr(t+1).toLowerCase()},LGraphCanvas.prototype.enableWebGL=function(){this.gl=this.ctx=enableWebGLCanvas(this.canvas),this.ctx.webgl=!0,this.bgcanvas=this.canvas,this.bgctx=this.gl,this.canvas.webgl_enabled=!0},LGraphCanvas.prototype.setDirty=function(e,t){e&&(this.dirty_canvas=!0),t&&(this.dirty_bgcanvas=!0)},LGraphCanvas.prototype.getCanvasWindow=function(){var e;return this.canvas?(e=this.canvas.ownerDocument).defaultView||e.parentWindow:window},LGraphCanvas.prototype.startRendering=function(){function t(){this.pause_rendering||this.draw();let e=this.getCanvasWindow();this.is_rendering&&e.requestAnimationFrame(t.bind(this))}this.is_rendering||(this.is_rendering=!0,t.call(this))},LGraphCanvas.prototype.stopRendering=function(){this.is_rendering=!1},LGraphCanvas.prototype.blockClick=function(){this.block_click=!0,this.last_mouseclick=0},LGraphCanvas.prototype.processMouseDown=function(a){if(this.set_canvas_dirty_on_mouse_event&&(this.dirty_canvas=!0),this.graph){this.adjustMouseEvent(a);let e=this.getCanvasWindow();e.document,LGraphCanvas.active_canvas=this;var s=a.clientX,l=a.clientY,s=(this.ds.viewport=this.viewport,!this.viewport||this.viewport&&s>=this.viewport[0]&&s<this.viewport[0]+this.viewport[2]&&l>=this.viewport[1]&&l<this.viewport[1]+this.viewport[3]);if(this.options.skip_events||(LiteGraph$2.pointerListenerRemove(this.canvas,"move",this._mousemove_callback),LiteGraph$2.pointerListenerAdd(e.document,"move",this._mousemove_callback,!0),LiteGraph$2.pointerListenerAdd(e.document,"up",this._mouseup_callback,!0)),s){let o=this.graph.getNodeOnPos(a.canvasX,a.canvasY,this.visible_nodes,5),n=!1;var l=LiteGraph$2.getTime(),s=void 0===a.isPrimary||!a.isPrimary,r=l-this.last_mouseclick<300&&s;if(this.mouse[0]=a.clientX,this.mouse[1]=a.clientY,this.graph_mouse[0]=a.canvasX,this.graph_mouse[1]=a.canvasY,this.last_click_position=[this.mouse[0],this.mouse[1]],this.pointer_is_down&&s?this.pointer_is_double=!0:this.pointer_is_double=!1,this.pointer_is_down=!0,this.canvas.focus(),LiteGraph$2.closeAllContextMenus(e),!this.onMouse||1!=this.onMouse(a)){if(1!=a.which||this.pointer_is_double)if(2==a.which){if(LiteGraph$2.middle_click_slot_add_default_node&&o&&this.allow_interaction&&!n&&!this.read_only&&!this.connecting_node&&!o.flags.collapsed&&!this.live_mode){let n=!1,r=!1,i=!1;if(o.outputs)for(let e=0,t=o.outputs.length;e<t;++e){var h=o.outputs[e],p=o.getConnectionPos(!1,e);if(isInsideRectangle(a.canvasX,a.canvasY,p[0]-15,p[1]-10,30,20)){n=h,r=e,i=!0;break}}if(o.inputs)for(let e=0,t=o.inputs.length;e<t;++e){var u=o.inputs[e],c=o.getConnectionPos(!0,e);if(isInsideRectangle(a.canvasX,a.canvasY,c[0]-15,c[1]-10,30,20)){n=u,r=e,i=!1;break}}n&&!1!==r&&(l=.5-(r+1)/(i?o.outputs:o.inputs).length,s=o.getBounding(),s=[i?s[0]+s[2]:s[0],a.canvasY-80],this.createDefaultNodeForSlot({nodeFrom:i?o:null,slotFrom:i?r:null,nodeTo:i?null:o,slotTo:i?null:r,position:s,nodeType:"AUTO",posAdd:[i?30:-30,130*-l],posSizeFix:[i?0:-1,0]}))}}else 3!=a.which&&!this.pointer_is_double||!this.allow_interaction||n||this.read_only||(o&&(Object.keys(this.selected_nodes).length&&(this.selected_nodes[o.id]||a.shiftKey||a.ctrlKey||a.metaKey)?this.selected_nodes[o.id]||this.selectNodes([o],!0):this.selectNodes([o])),this.processContextMenu(o,a));else{a.ctrlKey&&(this.dragging_rectangle=new Float32Array(4),this.dragging_rectangle[0]=a.canvasX,this.dragging_rectangle[1]=a.canvasY,this.dragging_rectangle[2]=1,this.dragging_rectangle[3]=1,n=!0),LiteGraph$2.alt_drag_do_clone_nodes&&a.altKey&&o&&this.allow_interaction&&!n&&!this.read_only&&(cloned=o.clone())&&(cloned.pos[0]+=5,cloned.pos[1]+=5,this.graph.add(cloned,!1,{doCalcSize:!1}),o=cloned,n=!0,block_drag_node||(this.allow_dragnodes&&(this.graph.beforeChange(),this.node_dragged=o),this.selected_nodes[o.id]||this.processNodeSelected(o,a)));let t=!1;if(o&&this.allow_interaction&&!n&&!this.read_only){if(this.live_mode||o.flags.pinned||this.bringToFront(o),!this.connecting_node&&!o.flags.collapsed&&!this.live_mode)if(!n&&!1!==o.resizable&&isInsideRectangle(a.canvasX,a.canvasY,o.pos[0]+o.size[0]-5,o.pos[1]+o.size[1]-5,10,10))this.graph.beforeChange(),this.resizing_node=o,this.canvas.style.cursor="se-resize",n=!0;else{if(o.outputs)for(let e=0,t=o.outputs.length;e<t;++e){var i=o.outputs[e],d=o.getConnectionPos(!1,e);if(isInsideRectangle(a.canvasX,a.canvasY,d[0]-15,d[1]-10,30,20)){this.connecting_node=o,this.connecting_output=i,this.connecting_output.slot_index=e,this.connecting_pos=o.getConnectionPos(!1,e),this.connecting_slot=e,LiteGraph$2.shift_click_do_break_link_from&&a.shiftKey&&o.disconnectOutput(e),r?o.onOutputDblClick&&o.onOutputDblClick(e,a):o.onOutputClick&&o.onOutputClick(e,a),n=!0;break}}if(o.inputs)for(let e=0,t=o.inputs.length;e<t;++e){var g=o.inputs[e],f=o.getConnectionPos(!0,e);isInsideRectangle(a.canvasX,a.canvasY,f[0]-15,f[1]-10,30,20)&&(r?o.onInputDblClick&&o.onInputDblClick(e,a):o.onInputClick&&o.onInputClick(e,a),null!==g.link&&(f=this.graph.links[g.link],LiteGraph$2.click_do_break_link_to&&(o.disconnectInput(e),this.dirty_bgcanvas=!0,n=!0),(this.allow_reconnect_links||a.shiftKey)&&(LiteGraph$2.click_do_break_link_to||o.disconnectInput(e),this.connecting_node=this.graph._nodes_by_id[f.origin_id],this.connecting_slot=f.origin_slot,this.connecting_output=this.connecting_node.outputs[this.connecting_slot],this.connecting_pos=this.connecting_node.getConnectionPos(!1,this.connecting_slot),this.dirty_bgcanvas=!0,n=!0)),n||(this.connecting_node=o,this.connecting_input=g,this.connecting_input.slot_index=e,this.connecting_pos=o.getConnectionPos(!0,e),this.connecting_slot=e,this.dirty_bgcanvas=!0,n=!0))}}if(!n){let e=!1;s=[a.canvasX-o.pos[0],a.canvasY-o.pos[1]],l=this.processNodeWidgets(o,this.graph_mouse,a);if(l&&(e=!0,this.node_widget=[o,l]),r&&this.selected_nodes[o.id]&&(o.onDblClick&&o.onDblClick(a,s,this),this.processNodeDblClicked(o),e=!0),o.onMouseDown&&o.onMouseDown(a,s,this))e=!0;else{if(o.subgraph&&!o.skip_subgraph_button&&!o.flags.collapsed&&s[0]>o.size[0]-LiteGraph$2.NODE_TITLE_HEIGHT&&s[1]<0){let e=this;setTimeout(function(){e.openSubgraph(o.subgraph)},10)}this.live_mode&&(t=!0,e=!0)}e||(this.allow_dragnodes&&(this.graph.beforeChange(),this.node_dragged=o),this.selected_nodes[o.id]||this.processNodeSelected(o,a)),this.dirty_canvas=!0}}else if(!n){if(!this.read_only)for(let e=0;e<this.visible_links.length;++e){var _=this.visible_links[e],y=_._pos;if(!(!y||a.canvasX<y[0]-4||a.canvasX>y[0]+4||a.canvasY<y[1]-4||a.canvasY>y[1]+4)){this.showLinkMenu(_,a),this.over_link_center=null;break}}this.selected_group=this.graph.getGroupOnPos(a.canvasX,a.canvasY),this.selected_group_resizing=!1,this.selected_group&&!this.read_only&&(a.ctrlKey&&(this.dragging_rectangle=null),distance([a.canvasX,a.canvasY],[this.selected_group.pos[0]+this.selected_group.size[0],this.selected_group.pos[1]+this.selected_group.size[1]])*this.ds.scale<10?this.selected_group_resizing=!0:this.selected_group.recomputeInsideNodes()),r&&!this.read_only&&this.allow_searchbox&&(this.showSearchBox(a),a.preventDefault(),a.stopPropagation()),t=!0}!n&&t&&this.allow_dragcanvas&&(this.dragging_canvas=!0)}return this.last_mouse[0]=a.clientX,this.last_mouse[1]=a.clientY,this.last_mouseclick=LiteGraph$2.getTime(),this.last_mouse_dragging=!0,this.graph.change(),e.document.activeElement&&("input"==e.document.activeElement.nodeName.toLowerCase()||"textarea"==e.document.activeElement.nodeName.toLowerCase())||a.preventDefault(),a.stopPropagation(),this.onMouseDown&&this.onMouseDown(a),!1}}}},LGraphCanvas.prototype.processMouseMove=function(r){if(this.autoresize&&this.resize(),this.set_canvas_dirty_on_mouse_event&&(this.dirty_canvas=!0),this.graph){(LGraphCanvas.active_canvas=this).adjustMouseEvent(r);var e,t,i=[r.clientX,r.clientY],o=(this.mouse[0]=i[0],this.mouse[1]=i[1],[i[0]-this.last_mouse[0],i[1]-this.last_mouse[1]]);if(this.last_mouse=i,this.graph_mouse[0]=r.canvasX,this.graph_mouse[1]=r.canvasY,!this.block_click)if(r.dragging=this.last_mouse_dragging,this.node_widget&&(this.processNodeWidgets(this.node_widget[0],this.graph_mouse,r,this.node_widget[1]),this.dirty_canvas=!0),this.dragging_rectangle)this.dragging_rectangle[2]=r.canvasX-this.dragging_rectangle[0],this.dragging_rectangle[3]=r.canvasY-this.dragging_rectangle[1],this.dirty_canvas=!0;else if(this.selected_group&&!this.read_only)this.selected_group_resizing?this.selected_group.size=[r.canvasX-this.selected_group.pos[0],r.canvasY-this.selected_group.pos[1]]:(i=o[0]/this.ds.scale,t=o[1]/this.ds.scale,this.selected_group.move(i,t,r.ctrlKey),this.selected_group._nodes.length&&(this.dirty_canvas=!0)),this.dirty_bgcanvas=!0;else if(this.dragging_canvas)this.ds.offset[0]+=o[0]/this.ds.scale,this.ds.offset[1]+=o[1]/this.ds.scale,this.dirty_canvas=!0,this.dirty_bgcanvas=!0;else if(this.allow_interaction&&!this.read_only){this.connecting_node&&(this.dirty_canvas=!0);let n=this.graph.getNodeOnPos(r.canvasX,r.canvasY,this.visible_nodes);for(let e=0,t=this.graph._nodes.length;e<t;++e)this.graph._nodes[e].mouseOver&&n!=this.graph._nodes[e]&&(this.graph._nodes[e].mouseOver=!1,this.node_over&&this.node_over.onMouseLeave&&this.node_over.onMouseLeave(r),this.node_over=null,this.dirty_canvas=!0);if(n)n.redraw_on_mouse&&(this.dirty_canvas=!0),n.mouseOver||(n.mouseOver=!0,this.node_over=n,this.dirty_canvas=!0,n.onMouseEnter&&n.onMouseEnter(r)),n.onMouseMove&&n.onMouseMove(r,[r.canvasX-n.pos[0],r.canvasY-n.pos[1]],this),this.connecting_node&&(this.connecting_output?(i=this._highlight_input||[0,0],this.isOverNodeBox(n,r.canvasX,r.canvasY)||(-1!=(t=this.isOverNodeInput(n,r.canvasX,r.canvasY,i))&&n.inputs[t]?(e=n.inputs[t].type,LiteGraph$2.isValidConnection(this.connecting_output.type,e)&&(this._highlight_input=i,this._highlight_input_slot=n.inputs[t])):(this._highlight_input=null,this._highlight_input_slot=null))):this.connecting_input&&(e=this._highlight_output||[0,0],this.isOverNodeBox(n,r.canvasX,r.canvasY)||(-1!=(i=this.isOverNodeOutput(n,r.canvasX,r.canvasY,e))&&n.outputs[i]?(t=n.outputs[i].type,LiteGraph$2.isValidConnection(this.connecting_input.type,t)&&(this._highlight_output=e)):this._highlight_output=null))),this.canvas&&(isInsideRectangle(r.canvasX,r.canvasY,n.pos[0]+n.size[0]-5,n.pos[1]+n.size[1]-5,5,5)?this.canvas.style.cursor="se-resize":this.canvas.style.cursor="crosshair");else{let t=null;for(let e=0;e<this.visible_links.length;++e){var a=this.visible_links[e],s=a._pos;if(!(!s||r.canvasX<s[0]-4||r.canvasX>s[0]+4||r.canvasY<s[1]-4||r.canvasY>s[1]+4)){t=a;break}}t!=this.over_link_center&&(this.over_link_center=t,this.dirty_canvas=!0),this.canvas&&(this.canvas.style.cursor="")}if(this.node_capturing_input&&this.node_capturing_input!=n&&this.node_capturing_input.onMouseMove&&this.node_capturing_input.onMouseMove(r,[r.canvasX-this.node_capturing_input.pos[0],r.canvasY-this.node_capturing_input.pos[1]],this),this.node_dragged&&!this.live_mode){for(var l in this.selected_nodes){let e=this.selected_nodes[l];e.pos[0]+=o[0]/this.ds.scale,e.pos[1]+=o[1]/this.ds.scale}this.dirty_canvas=!0,this.dirty_bgcanvas=!0}if(this.resizing_node&&!this.live_mode){let e=[r.canvasX-this.resizing_node.pos[0],r.canvasY-this.resizing_node.pos[1]];i=this.resizing_node.computeSize();e[0]=Math.max(i[0],e[0]),e[1]=Math.max(i[1],e[1]),this.resizing_node.setSize(e),this.canvas.style.cursor="se-resize",this.dirty_canvas=!0,this.dirty_bgcanvas=!0}}return r.preventDefault(),!1}},LGraphCanvas.prototype.processMouseUp=function(t){var e=void 0===t.isPrimary||t.isPrimary;if(!e)return!1;if(this.set_canvas_dirty_on_mouse_event&&(this.dirty_canvas=!0),this.graph){var n=this.getCanvasWindow().document,n=((LGraphCanvas.active_canvas=this).options.skip_events||(LiteGraph$2.pointerListenerRemove(n,"move",this._mousemove_callback,!0),LiteGraph$2.pointerListenerAdd(this.canvas,"move",this._mousemove_callback,!0),LiteGraph$2.pointerListenerRemove(n,"up",this._mouseup_callback,!0)),this.adjustMouseEvent(t),LiteGraph$2.getTime());if(t.click_time=n-this.last_mouseclick,this.last_mouse_dragging=!1,this.last_click_position=null,this.block_click&&(this.block_click=!1),1==t.which){this.node_widget&&this.processNodeWidgets(this.node_widget[0],this.graph_mouse,t),this.node_widget=null,this.selected_group&&(n=this.selected_group.pos[0]-Math.round(this.selected_group.pos[0]),o=this.selected_group.pos[1]-Math.round(this.selected_group.pos[1]),this.selected_group.move(n,o,t.ctrlKey),this.selected_group.pos[0]=Math.round(this.selected_group.pos[0]),this.selected_group.pos[1]=Math.round(this.selected_group.pos[1]),this.selected_group._nodes.length&&(this.dirty_canvas=!0),this.selected_group=null),this.selected_group_resizing=!1;let e=this.graph.getNodeOnPos(t.canvasX,t.canvasY,this.visible_nodes);if(this.dragging_rectangle){if(this.graph){var r=this.graph._nodes,i=new Float32Array(4),n=Math.abs(this.dragging_rectangle[2]),o=Math.abs(this.dragging_rectangle[3]),a=this.dragging_rectangle[2]<0?this.dragging_rectangle[0]-n:this.dragging_rectangle[0],s=this.dragging_rectangle[3]<0?this.dragging_rectangle[1]-o:this.dragging_rectangle[1];if(this.dragging_rectangle[0]=a,this.dragging_rectangle[1]=s,this.dragging_rectangle[2]=n,this.dragging_rectangle[3]=o,!e||10<n&&10<o){let n=[];for(let t=0;t<r.length;++t){let e=r[t];e.getBounding(i),overlapBounding(this.dragging_rectangle,i)&&n.push(e)}n.length&&this.selectNodes(n,t.shiftKey)}else this.selectNodes([e],t.shiftKey||t.ctrlKey)}this.dragging_rectangle=null}else if(this.connecting_node){this.dirty_canvas=!0,this.dirty_bgcanvas=!0;a=(this.connecting_output||this.connecting_input).type;e?this.connecting_output?-1!=(s=this.isOverNodeInput(e,t.canvasX,t.canvasY))?this.connecting_node.connect(this.connecting_slot,e,s):this.connecting_node.connectByType(this.connecting_slot,e,a):this.connecting_input&&(-1!=(n=this.isOverNodeOutput(e,t.canvasX,t.canvasY))?e.connect(n,this.connecting_node,this.connecting_slot):this.connecting_node.connectByTypeOutput(this.connecting_slot,e,a)):LiteGraph$2.release_link_on_empty_shows_menu&&(t.shiftKey&&this.allow_searchbox?this.connecting_output?this.showSearchBox(t,{node_from:this.connecting_node,slot_from:this.connecting_output,type_filter_in:this.connecting_output.type}):this.connecting_input&&this.showSearchBox(t,{node_to:this.connecting_node,slot_from:this.connecting_input,type_filter_out:this.connecting_input.type}):this.connecting_output?this.showConnectionMenu({nodeFrom:this.connecting_node,slotFrom:this.connecting_output,e:t}):this.connecting_input&&this.showConnectionMenu({nodeTo:this.connecting_node,slotTo:this.connecting_input,e:t})),this.connecting_output=null,this.connecting_input=null,this.connecting_pos=null,this.connecting_node=null,this.connecting_slot=-1}else if(this.resizing_node)this.dirty_canvas=!0,this.dirty_bgcanvas=!0,this.graph.afterChange(this.resizing_node),this.resizing_node=null;else if(this.node_dragged){let e=this.node_dragged;e&&t.click_time<300&&isInsideRectangle(t.canvasX,t.canvasY,e.pos[0],e.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT,LiteGraph$2.NODE_TITLE_HEIGHT,LiteGraph$2.NODE_TITLE_HEIGHT)&&e.collapse(),this.dirty_canvas=!0,this.dirty_bgcanvas=!0,this.node_dragged.pos[0]=Math.round(this.node_dragged.pos[0]),this.node_dragged.pos[1]=Math.round(this.node_dragged.pos[1]),(this.graph.config.align_to_grid||this.align_to_grid)&&this.node_dragged.alignToGrid(),this.onNodeMoved&&this.onNodeMoved(this.node_dragged),this.graph.afterChange(this.node_dragged),this.node_dragged=null}else!this.graph.getNodeOnPos(t.canvasX,t.canvasY,this.visible_nodes)&&t.click_time<300&&this.deselectAllNodes(),this.dirty_canvas=!0,this.dragging_canvas=!1,this.node_over&&this.node_over.onMouseUp&&this.node_over.onMouseUp(t,[t.canvasX-this.node_over.pos[0],t.canvasY-this.node_over.pos[1]],this),this.node_capturing_input&&this.node_capturing_input.onMouseUp&&this.node_capturing_input.onMouseUp(t,[t.canvasX-this.node_capturing_input.pos[0],t.canvasY-this.node_capturing_input.pos[1]])}else(2==t.which||3==t.which)&&(this.dirty_canvas=!0,this.dragging_canvas=!1);return e&&(this.pointer_is_down=!1,this.pointer_is_double=!1),this.graph.change(),t.stopPropagation(),t.preventDefault(),!1}},LGraphCanvas.prototype.processMouseWheel=function(t){if(this.graph&&this.allow_dragcanvas){var n=null!=t.wheelDeltaY?t.wheelDeltaY:-60*t.detail,e=(this.adjustMouseEvent(t),t.clientX),r=t.clientY;if(!this.viewport||this.viewport&&e>=this.viewport[0]&&e<this.viewport[0]+this.viewport[2]&&r>=this.viewport[1]&&r<this.viewport[1]+this.viewport[3]){let e=this.ds.scale;return 0<n?e*=1.1:n<0&&(e*=1/1.1),this.ds.changeScale(e,[t.clientX,t.clientY]),this.graph.change(),t.preventDefault(),!1}}},LGraphCanvas.prototype.isOverNodeBox=function(e,t,n){var r=LiteGraph$2.NODE_TITLE_HEIGHT;return!!isInsideRectangle(t,n,e.pos[0]+2,e.pos[1]+2-r,r-4,r-4)},LGraphCanvas.prototype.isOverNodeInput=function(n,r,i,o){if(n.inputs)for(let t=0,e=n.inputs.length;t<e;++t){n.inputs[t];var a=n.getConnectionPos(!0,t);let e=!1;if(e=n.horizontal?isInsideRectangle(r,i,a[0]-5,a[1]-10,10,20):isInsideRectangle(r,i,a[0]-10,a[1]-5,40,10))return o&&(o[0]=a[0],o[1]=a[1]),t}return-1},LGraphCanvas.prototype.isOverNodeOutput=function(n,r,i,o){if(n.outputs)for(let t=0,e=n.outputs.length;t<e;++t){n.outputs[t];var a=n.getConnectionPos(!1,t);let e=!1;if(e=n.horizontal?isInsideRectangle(r,i,a[0]-5,a[1]-10,10,20):isInsideRectangle(r,i,a[0]-10,a[1]-5,40,10))return o&&(o[0]=a[0],o[1]=a[1]),t}return-1},LGraphCanvas.prototype.processKey=function(t){if(this.graph){let e=!1;if("input"!=t.target.localName){if("keydown"==t.type){if(32==t.keyCode&&(this.dragging_canvas=!0,e=!0),27==t.keyCode&&(this.node_panel&&this.node_panel.close(),this.options_panel&&this.options_panel.close(),e=!0),65==t.keyCode&&t.ctrlKey&&(this.selectNodes(),e=!0),"KeyC"!=t.code||!t.metaKey&&!t.ctrlKey||t.shiftKey||this.selected_nodes&&(this.copyToClipboard(),e=!0),"KeyV"!=t.code||!t.metaKey&&!t.ctrlKey||t.shiftKey||this.pasteFromClipboard(),46!=t.keyCode&&8!=t.keyCode||"input"!=t.target.localName&&"textarea"!=t.target.localName&&(this.deleteSelectedNodes(),e=!0),this.selected_nodes)for(var n in this.selected_nodes)this.selected_nodes[n].onKeyDown&&this.selected_nodes[n].onKeyDown(t)}else if("keyup"==t.type&&(32==t.keyCode&&(this.dragging_canvas=!1),this.selected_nodes))for(var r in this.selected_nodes)this.selected_nodes[r].onKeyUp&&this.selected_nodes[r].onKeyUp(t);return this.graph.change(),e?(t.preventDefault(),t.stopImmediatePropagation(),!1):void 0}}},LGraphCanvas.prototype.copyToClipboard=function(){let r={nodes:[],links:[]},t=0,i=[];for(var n in this.selected_nodes){let e=this.selected_nodes[n];e._relative_id=t,i.push(e),t+=1}for(let n=0;n<i.length;++n){let t=i[n],e=t.clone();if(e){if(r.nodes.push(e.serialize()),t.inputs&&t.inputs.length)for(let e=0;e<t.inputs.length;++e){var o,a=t.inputs[e];a&&null!=a.link&&((a=this.graph.links[a.link])&&(o=this.graph.getNodeById(a.origin_id))&&this.selected_nodes[o.id]&&r.links.push([o._relative_id,a.origin_slot,t._relative_id,a.target_slot]))}}else console.warn("node type not found: "+t.type)}localStorage.setItem("litegrapheditor_clipboard",JSON.stringify(r))},LGraphCanvas.prototype.pasteFromClipboard=function(){var e=localStorage.getItem("litegrapheditor_clipboard");if(e){this.graph.beforeChange();var i=JSON.parse(e);let n=!1,t=!1;for(let e=0;e<i.nodes.length;++e)n?(n[0]>i.nodes[e].pos[0]&&(n[0]=i.nodes[e].pos[0],t[0]=e),n[1]>i.nodes[e].pos[1]&&(n[1]=i.nodes[e].pos[1],t[1]=e)):(n=[i.nodes[e].pos[0],i.nodes[e].pos[1]],t=[e,e]);let r=[];for(let t=0;t<i.nodes.length;++t){var o=i.nodes[t];let e=LiteGraph$2.createNode(o.type);e&&(e.configure(o),e.pos[0]+=this.graph_mouse[0]-n[0],e.pos[1]+=this.graph_mouse[1]-n[1],this.graph.add(e,{doProcessChange:!1}),r.push(e))}for(let t=0;t<i.links.length;++t){var a=i.links[t];let e=r[a[0]];var s=r[a[2]];e&&s?e.connect(a[1],s,a[3]):console.warn("Warning, nodes missing on pasting")}this.selectNodes(r),this.graph.afterChange()}},LGraphCanvas.prototype.processDrop=function(i){i.preventDefault(),this.adjustMouseEvent(i);var e=i.clientX,t=i.clientY;if(!this.viewport||this.viewport&&e>=this.viewport[0]&&e<this.viewport[0]+this.viewport[2]&&t>=this.viewport[1]&&t<this.viewport[1]+this.viewport[3]){e=[i.canvasX,i.canvasY];let r=this.graph?this.graph.getNodeOnPos(e[0],e[1]):null;if(r){if(r.onDropFile||r.onDropData){var n=i.dataTransfer.files;if(n&&n.length)for(let e=0;e<n.length;e++){let t=i.dataTransfer.files[0],n=t.name;if(LGraphCanvas.getFileExtension(n),r.onDropFile&&r.onDropFile(t),r.onDropData){let e=new FileReader;e.onload=function(e){e=e.target.result;r.onDropData(e,n,t)};var o=t.type.split("/")[0];"text"==o||""==o?e.readAsText(t):"image"==o?e.readAsDataURL(t):e.readAsArrayBuffer(t)}}}return!(!r.onDropItem||!r.onDropItem(event))||!!this.onDropItem&&this.onDropItem(event)}{let e=null;void((e=this.onDropItem?this.onDropItem(event):e)||this.checkDropItem(i))}}},LGraphCanvas.prototype.checkDropItem=function(t){if(t.dataTransfer.files.length){var n=t.dataTransfer.files[0],r=LGraphCanvas.getFileExtension(n.name).toLowerCase(),r=LiteGraph$2.node_types_by_file_extension[r];if(r){this.graph.beforeChange();let e=LiteGraph$2.createNode(r.type);e.pos=[t.canvasX,t.canvasY],this.graph.add(e),e.onDropFile&&e.onDropFile(n),this.graph.afterChange()}}},LGraphCanvas.prototype.processNodeDblClicked=function(e){this.onShowNodePanel?this.onShowNodePanel(e):this.showShowNodePanel(e),this.onNodeDblClicked&&this.onNodeDblClicked(e),this.setDirty(!0)},LGraphCanvas.prototype.processNodeSelected=function(e,t){this.selectNode(e,t&&(t.shiftKey||t.ctrlKey)),this.onNodeSelected&&this.onNodeSelected(e)},LGraphCanvas.prototype.selectNode=function(e,t){null==e?this.deselectAllNodes():this.selectNodes([e],t)},LGraphCanvas.prototype.selectNodes=function(e,t){for(var n in t||this.deselectAllNodes(),e="string"==typeof(e=e||this.graph._nodes)?[e]:e){let t=e[n];if(!t.is_selected){if(!t.is_selected&&t.onSelected&&t.onSelected(),t.is_selected=!0,(this.selected_nodes[t.id]=t).inputs)for(let e=0;e<t.inputs.length;++e)this.highlighted_links[t.inputs[e].link]=!0;if(t.outputs)for(let e=0;e<t.outputs.length;++e){var r=t.outputs[e];if(r.links)for(let e=0;e<r.links.length;++e)this.highlighted_links[r.links[e]]=!0}}}this.onSelectionChange&&this.onSelectionChange(this.selected_nodes),this.setDirty(!0)},LGraphCanvas.prototype.deselectNode=function(t){if(t.is_selected){if(t.onDeselected&&t.onDeselected(),t.is_selected=!1,this.onNodeDeselected&&this.onNodeDeselected(t),t.inputs)for(let e=0;e<t.inputs.length;++e)delete this.highlighted_links[t.inputs[e].link];if(t.outputs)for(let e=0;e<t.outputs.length;++e){var n=t.outputs[e];if(n.links)for(let e=0;e<n.links.length;++e)delete this.highlighted_links[n.links[e]]}}},LGraphCanvas.prototype.deselectAllNodes=function(){if(this.graph){var n=this.graph._nodes;for(let t=0,e=n.length;t<e;++t){let e=n[t];e.is_selected&&(e.onDeselected&&e.onDeselected(),e.is_selected=!1,this.onNodeDeselected&&this.onNodeDeselected(e))}this.selected_nodes={},this.current_node=null,this.highlighted_links={},this.onSelectionChange&&this.onSelectionChange(this.selected_nodes),this.setDirty(!0)}},LGraphCanvas.prototype.deleteSelectedNodes=function(){for(var n in this.graph.beforeChange(),this.selected_nodes){let t=this.selected_nodes[n];if(!t.block_delete){if(t.inputs&&t.inputs.length&&t.outputs&&t.outputs.length&&LiteGraph$2.isValidConnection(t.inputs[0].type,t.outputs[0].type)&&t.inputs[0].link&&t.outputs[0].links&&t.outputs[0].links.length){var n=t.graph.links[t.inputs[0].link],r=t.graph.links[t.outputs[0].links[0]];let e=t.getInputNode(0);var i=t.getOutputNodes(0)[0];e&&i&&e.connect(n.origin_slot,i,r.target_slot)}this.graph.remove(t),this.onNodeDeselected&&this.onNodeDeselected(t)}}this.selected_nodes={},this.current_node=null,this.highlighted_links={},this.setDirty(!0),this.graph.afterChange()},LGraphCanvas.prototype.centerOnNode=function(e){this.ds.offset[0]=-e.pos[0]-.5*e.size[0]+.5*this.canvas.width/this.ds.scale,this.ds.offset[1]=-e.pos[1]-.5*e.size[1]+.5*this.canvas.height/this.ds.scale,this.setDirty(!0,!0)},LGraphCanvas.prototype.adjustMouseEvent=function(e){let t=0,n=0;var r;n=this.canvas?(r=this.canvas.getBoundingClientRect(),t=e.clientX-r.left,e.clientY-r.top):(t=e.clientX,e.clientY),this.last_mouse_position[0]=t,this.last_mouse_position[1]=n,e.canvasX=t/this.ds.scale-this.ds.offset[0],e.canvasY=n/this.ds.scale-this.ds.offset[1]},LGraphCanvas.prototype.setZoom=function(e,t){this.ds.changeScale(e,t),this.dirty_canvas=!0,this.dirty_bgcanvas=!0},LGraphCanvas.prototype.convertOffsetToCanvas=function(e,t){return this.ds.convertOffsetToCanvas(e,t)},LGraphCanvas.prototype.convertCanvasToOffset=function(e,t){return this.ds.convertCanvasToOffset(e,t)},LGraphCanvas.prototype.convertEventToCanvasOffset=function(e){var t=this.canvas.getBoundingClientRect();return this.convertCanvasToOffset([e.clientX-t.left,e.clientY-t.top])},LGraphCanvas.prototype.bringToFront=function(e){var t=this.graph._nodes.indexOf(e);-1!=t&&(this.graph._nodes.splice(t,1),this.graph._nodes.push(e))},LGraphCanvas.prototype.sendToBack=function(e){var t=this.graph._nodes.indexOf(e);-1!=t&&(this.graph._nodes.splice(t,1),this.graph._nodes.unshift(e))},LGraphCanvas.prototype.computeVisibleNodes=function(n,e){const r=e||[];for(let t=r.length=0,e=(n=n||this.graph._nodes).length;t<e;++t){let e=n[t];(!this.live_mode||e.onDrawBackground||e.onDrawForeground)&&overlapBounding(this.visible_area,e.getBounding(canvas_bounding_vec4))&&r.push(e)}return r},LGraphCanvas.prototype.draw=function(e,t){var n;this.canvas&&0!=this.canvas.width&&0!=this.canvas.height&&(n=LiteGraph$2.getTime(),this.render_time=.001*(n-this.last_draw_time),this.last_draw_time=n,this.graph&&this.ds.computeVisibleArea(this.viewport),(this.dirty_bgcanvas||t||this.always_render_background||this.graph&&this.graph._last_trigger_time&&n-this.graph._last_trigger_time<1e3)&&this.drawBackCanvas(),(this.dirty_canvas||e)&&this.drawFrontCanvas(),this.fps=this.render_time?1/this.render_time:0,this.frame+=1)},LGraphCanvas.prototype.drawFrontCanvas=function(){this.dirty_canvas=!1,this.ctx||(this.ctx=this.bgcanvas.getContext("2d"));let n=this.ctx;if(n){var r=this.canvas,e=(n.start2D&&!this.viewport&&(n.start2D(),n.restore(),n.setTransform(1,0,0,1,0,0)),this.viewport||this.dirty_area);if(e&&(n.save(),n.beginPath(),n.rect(e[0],e[1],e[2],e[3]),n.clip()),this.clear_background&&(e?n.clearRect(e[0],e[1],e[2],e[3]):n.clearRect(0,0,r.width,r.height)),this.bgcanvas==this.canvas?this.drawBackCanvas():n.drawImage(this.bgcanvas,0,0),this.onRender&&this.onRender(r,n),this.show_info&&this.renderInfo(n,e?e[0]:0,e?e[1]:0),this.graph){n.save(),this.ds.toCanvasContext(n);var t=this.computeVisibleNodes(null,this.visible_nodes);for(let e=0;e<t.length;++e){var i=t[e];n.save(),n.translate(i.pos[0],i.pos[1]),this.drawNode(i,n),n.restore()}if(this.render_execution_order&&this.drawExecutionOrder(n),!this.graph.config.links_ontop||this.live_mode||this.drawConnections(n),null!=this.connecting_pos){n.lineWidth=this.connections_width;let e=null;var r=this.connecting_output||this.connecting_input,o=r.type;let t=r.dir;null==t&&(t=this.connecting_output?this.connecting_node.horizontal?LiteGraph$2.DOWN:LiteGraph$2.RIGHT:this.connecting_node.horizontal?LiteGraph$2.UP:LiteGraph$2.LEFT);r=r.shape;e=o===LiteGraph$2.EVENT?LiteGraph$2.EVENT_LINK_COLOR:LiteGraph$2.CONNECTING_LINK_COLOR,this.renderLink(n,this.connecting_pos,[this.graph_mouse[0],this.graph_mouse[1]],null,!1,null,e,t,LiteGraph$2.CENTER),n.beginPath(),o===LiteGraph$2.EVENT||r===LiteGraph$2.BOX_SHAPE?(n.rect(this.connecting_pos[0]-6+.5,this.connecting_pos[1]-5+.5,14,10),n.fill(),n.beginPath(),n.rect(this.graph_mouse[0]-6+.5,this.graph_mouse[1]-5+.5,14,10)):r===LiteGraph$2.ARROW_SHAPE?(n.moveTo(this.connecting_pos[0]+8,this.connecting_pos[1]+.5),n.lineTo(this.connecting_pos[0]-4,this.connecting_pos[1]+6+.5),n.lineTo(this.connecting_pos[0]-4,this.connecting_pos[1]-6+.5),n.closePath()):(n.arc(this.connecting_pos[0],this.connecting_pos[1],4,0,2*Math.PI),n.fill(),n.beginPath(),n.arc(this.graph_mouse[0],this.graph_mouse[1],4,0,2*Math.PI)),n.fill(),n.fillStyle="#ffcc00",this._highlight_input&&(n.beginPath(),this._highlight_input_slot.shape===LiteGraph$2.ARROW_SHAPE?(n.moveTo(this._highlight_input[0]+8,this._highlight_input[1]+.5),n.lineTo(this._highlight_input[0]-4,this._highlight_input[1]+6+.5),n.lineTo(this._highlight_input[0]-4,this._highlight_input[1]-6+.5),n.closePath()):n.arc(this._highlight_input[0],this._highlight_input[1],6,0,2*Math.PI),n.fill()),this._highlight_output&&(n.beginPath(),shape===LiteGraph$2.ARROW_SHAPE?(n.moveTo(this._highlight_output[0]+8,this._highlight_output[1]+.5),n.lineTo(this._highlight_output[0]-4,this._highlight_output[1]+6+.5),n.lineTo(this._highlight_output[0]-4,this._highlight_output[1]-6+.5),n.closePath()):n.arc(this._highlight_output[0],this._highlight_output[1],6,0,2*Math.PI),n.fill())}this.dragging_rectangle&&(n.strokeStyle="#FFF",n.strokeRect(this.dragging_rectangle[0],this.dragging_rectangle[1],this.dragging_rectangle[2],this.dragging_rectangle[3])),this.over_link_center&&this.render_link_tooltip?this.drawLinkTooltip(n,this.over_link_center):this.onDrawLinkTooltip&&this.onDrawLinkTooltip(n,null),this.onDrawForeground&&this.onDrawForeground(n,this.visible_rect),n.restore()}this._graph_stack&&this._graph_stack.length&&this.drawSubgraphPanel(n),this.onDrawOverlay&&this.onDrawOverlay(n),e&&n.restore(),n.finish2D&&n.finish2D()}},LGraphCanvas.prototype.drawSubgraphPanel=function(e){var t=this.graph,n=t._subgraph_node;n?(this.drawSubgraphPanelLeft(t,n,e),this.drawSubgraphPanelRight(t,n,e)):console.warn("subgraph without subnode")},LGraphCanvas.prototype.drawSubgraphPanelLeft=function(n,r,i){var e=r.inputs?r.inputs.length:0,o=Math.floor(1.6*LiteGraph$2.NODE_SLOT_HEIGHT);if(i.fillStyle="#111",i.globalAlpha=.8,i.beginPath(),i.roundRect(10,10,200,(e+1)*o+50,[8]),i.fill(),i.globalAlpha=1,i.fillStyle="#888",i.font="14px Arial",i.textAlign="left",i.fillText("Graph Inputs",20,34),this.drawButton(180,20,20,20,"X","#151515"))this.closeSubgraph();else{let t=50;if(i.font="14px Arial",r.inputs)for(let e=0;e<r.inputs.length;++e){var a=r.inputs[e];if(!a.not_subgraph_input){if(this.drawButton(20,t+2,180,o-2)){var s=r.constructor.input_node_type||"graph/input";this.graph.beforeChange();let e=LiteGraph$2.createNode(s);e?(n.add(e),this.block_click=!1,this.last_click_position=null,this.selectNodes([e]),this.node_dragged=e,this.dragging_canvas=!1,e.setProperty("name",a.name),e.setProperty("type",a.type),this.node_dragged.pos[0]=this.graph_mouse[0]-5,this.node_dragged.pos[1]=this.graph_mouse[1]-5,this.graph.afterChange()):console.error("graph input node not found:",s)}i.fillStyle="#9C9",i.beginPath(),i.arc(184,t+.5*o,5,0,2*Math.PI),i.fill(),i.fillStyle="#AAA",i.fillText(a.name,30,t+.75*o),i.fillStyle="#777",i.fillText(a.type,130,t+.75*o),t+=o}}this.drawButton(20,t+2,180,o-2,"+","#151515","#222")&&this.showSubgraphPropertiesDialog(r)}},LGraphCanvas.prototype.drawSubgraphPanelRight=function(n,r,i){var e=r.outputs?r.outputs.length:0,o=this.bgcanvas.width,a=200,s=Math.floor(1.6*LiteGraph$2.NODE_SLOT_HEIGHT),e=(i.fillStyle="#111",i.globalAlpha=.8,i.beginPath(),i.roundRect(o-a-10,10,a,(e+1)*s+50,[8]),i.fill(),i.globalAlpha=1,i.fillStyle="#888",i.font="14px Arial",i.textAlign="left","Graph Outputs"),t=i.measureText(e).width;if(i.fillText(e,o-t-20,34),this.drawButton(o-a,20,20,20,"X","#151515"))this.closeSubgraph();else{let t=50;if(i.font="14px Arial",r.outputs)for(let e=0;e<r.outputs.length;++e){var l=r.outputs[e];if(!l.not_subgraph_input){if(this.drawButton(o-a,t+2,180,s-2)){var h=r.constructor.output_node_type||"graph/output";this.graph.beforeChange();let e=LiteGraph$2.createNode(h);e?(n.add(e),this.block_click=!1,this.last_click_position=null,this.selectNodes([e]),this.node_dragged=e,this.dragging_canvas=!1,e.setProperty("name",l.name),e.setProperty("type",l.type),this.node_dragged.pos[0]=this.graph_mouse[0]-5,this.node_dragged.pos[1]=this.graph_mouse[1]-5,this.graph.afterChange()):console.error("graph input node not found:",h)}i.fillStyle="#9C9",i.beginPath(),i.arc(o-a+16,t+.5*s,5,0,2*Math.PI),i.fill(),i.fillStyle="#AAA",i.fillText(l.name,o-a+30,t+.75*s),i.fillStyle="#777",i.fillText(l.type,o-a+130,t+.75*s),t+=s}}this.drawButton(o-a,t+2,180,s-2,"+","#151515","#222")&&this.showSubgraphPropertiesDialogRight(r)}},LGraphCanvas.prototype.drawButton=function(e,t,n,r,i,o,a,s){let l=this.ctx;o=o||LiteGraph$2.NODE_DEFAULT_COLOR,a=a||"#555",s=s||LiteGraph$2.NODE_TEXT_COLOR;var h=t+LiteGraph$2.NODE_TITLE_HEIGHT+2,p=this.mouse,u=LiteGraph$2.isInsideRectangle(p[0],p[1],e,h,n,r),p=(p=this.last_click_position)&&LiteGraph$2.isInsideRectangle(p[0],p[1],e,h,n,r),h=(l.fillStyle=u?a:o,p&&(l.fillStyle="#AAA"),l.beginPath(),l.roundRect(e,t,n,r,[4]),l.fill(),null!=i&&i.constructor==String&&(l.fillStyle=s,l.textAlign="center",l.font=(.65*r|0)+"px Arial",l.fillText(i,e+.5*n,t+.75*r),l.textAlign="left"),p&&!this.block_click);return p&&this.blockClick(),h},LGraphCanvas.prototype.isAreaClicked=function(e,t,n,r,i){var o=this.mouse,o=(LiteGraph$2.isInsideRectangle(o[0],o[1],e,t,n,r),(o=this.last_click_position)&&LiteGraph$2.isInsideRectangle(o[0],o[1],e,t,n,r)),e=o&&!this.block_click;return o&&i&&this.blockClick(),e},LGraphCanvas.prototype.renderInfo=function(e,t,n){t=t||10,n=n||this.canvas.height-80,e.save(),e.translate(t,n),e.font="10px Arial",e.fillStyle="#888",e.textAlign="left",this.graph?(e.fillText("T: "+this.graph.globaltime.toFixed(2)+"s",5,13),e.fillText("I: "+this.graph.iteration,5,26),e.fillText("N: "+this.graph._nodes.length+" ["+this.visible_nodes.length+"]",5,39),e.fillText("V: "+this.graph._version,5,52),e.fillText("FPS:"+this.fps.toFixed(2),5,65)):e.fillText("No graph selected",5,13),e.restore()},LGraphCanvas.prototype.drawBackCanvas=function(){let n=this.bgcanvas,r=(n.width==this.canvas.width&&n.height==this.canvas.height||(n.width=this.canvas.width,n.height=this.canvas.height),this.bgctx||(this.bgctx=this.bgcanvas.getContext("2d")),this.bgctx);r.start&&r.start();var e=this.viewport||[0,0,r.canvas.width,r.canvas.height];if(this.clear_background&&r.clearRect(e[0],e[1],e[2],e[3]),this._graph_stack&&this._graph_stack.length){r.save(),this._graph_stack[this._graph_stack.length-1];let e=this.graph._subgraph_node,t=(r.strokeStyle=e.bgcolor,r.lineWidth=10,r.strokeRect(1,1,n.width-2,n.height-2),r.lineWidth=1,r.font="40px Arial",r.textAlign="center",r.fillStyle=e.bgcolor||"#AAA","");for(let e=1;e<this._graph_stack.length;++e)t+=this._graph_stack[e]._subgraph_node.getTitle()+" >> ";r.fillText(t+e.getTitle(),.5*n.width,40),r.restore()}let t=!1;if(this.onRenderBackground&&(t=this.onRenderBackground(n,r)),this.viewport||(r.restore(),r.setTransform(1,0,0,1,0,0)),this.visible_links.length=0,this.graph){if(r.save(),this.ds.toCanvasContext(r),this.background_image&&.5<this.ds.scale&&!t){if(this.zoom_modify_alpha?r.globalAlpha=(1-.5/this.ds.scale)*this.editor_alpha:r.globalAlpha=this.editor_alpha,r.imageSmoothingEnabled=r.imageSmoothingEnabled=!1,!this._bg_img||this._bg_img.name!=this.background_image){this._bg_img=new Image,this._bg_img.name=this.background_image,this._bg_img.src=this.background_image;let e=this;this._bg_img.onload=function(){e.draw(!0,!0)}}let e=null;null==this._pattern&&0<this._bg_img.width?(e=r.createPattern(this._bg_img,"repeat"),this._pattern_img=this._bg_img,this._pattern=e):e=this._pattern,e&&(r.fillStyle=e,r.fillRect(this.visible_area[0],this.visible_area[1],this.visible_area[2],this.visible_area[3]),r.fillStyle="transparent"),r.globalAlpha=1,r.imageSmoothingEnabled=r.imageSmoothingEnabled=!0}this.graph._groups.length&&!this.live_mode&&this.drawGroups(n,r),this.onDrawBackground&&this.onDrawBackground(r,this.visible_area),this.onBackgroundRender&&(console.error("WARNING! onBackgroundRender deprecated, now is named onDrawBackground "),this.onBackgroundRender=null),this.render_canvas_border&&(r.strokeStyle="#235",r.strokeRect(0,0,n.width,n.height)),this.render_connections_shadows?(r.shadowColor="#000",r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=6):r.shadowColor="rgba(0,0,0,0)",this.live_mode||this.drawConnections(r),r.shadowColor="rgba(0,0,0,0)",r.restore()}r.finish&&r.finish(),this.dirty_bgcanvas=!1,this.dirty_canvas=!0},LGraphCanvas.prototype.drawNode=function(o,a){var t=(this.current_node=o).color||o.constructor.color||LiteGraph$2.NODE_DEFAULT_COLOR;let n=o.bgcolor||o.constructor.bgcolor||LiteGraph$2.NODE_DEFAULT_BGCOLOR;var s=this.ds.scale<.6;if(o.mouseOver,this.live_mode)o.flags.collapsed||(a.shadowColor="transparent",o.onDrawForeground&&o.onDrawForeground(a,this,this.canvas));else{var l=this.editor_alpha;if(a.globalAlpha=l,this.render_shadows&&!s?(a.shadowColor=LiteGraph$2.DEFAULT_SHADOW_COLOR,a.shadowOffsetX=2*this.ds.scale,a.shadowOffsetY=2*this.ds.scale,a.shadowBlur=3*this.ds.scale):a.shadowColor="transparent",!o.flags.collapsed||!o.onDrawCollapsed||1!=o.onDrawCollapsed(a,this)){var r=o._shape||LiteGraph$2.BOX_SHAPE;let e=temp_size_vec2;temp_size_vec2.set(o.size);var h,p=o.horizontal,u=(o.flags.collapsed&&(a.font=this.inner_text_font,null!=(h=o.getTitle?o.getTitle():o.title)&&(o._collapsed_width=Math.min(o.size[0],a.measureText(h).width+2*LiteGraph$2.NODE_TITLE_HEIGHT),e[0]=o._collapsed_width,e[1]=0)),o.clip_area&&(a.save(),a.beginPath(),r==LiteGraph$2.BOX_SHAPE?a.rect(0,0,e[0],e[1]):r==LiteGraph$2.ROUND_SHAPE?a.roundRect(0,0,e[0],e[1],[10]):r==LiteGraph$2.CIRCLE_SHAPE&&a.arc(.5*e[0],.5*e[1],.5*e[0],0,2*Math.PI),a.clip()),o.has_errors&&(n="red"),this.drawNodeShape(o,a,e,t,n,o.is_selected,o.mouseOver),a.shadowColor="transparent",o.onDrawForeground&&o.onDrawForeground(a,this,this.canvas),a.textAlign=p?"center":"left",a.font=this.inner_text_font,!s),c=this.connecting_output,d=this.connecting_input;a.lineWidth=1;let i=0;var g=new Float32Array(2);if(o.flags.collapsed){if(this.render_collapsed_slots){let t=null,n=null;if(o.inputs)for(let e=0;e<o.inputs.length;e++){var f=o.inputs[e];if(null!=f.link){t=f;break}}if(o.outputs)for(let e=0;e<o.outputs.length;e++){var _=o.outputs[e];_.links&&_.links.length&&(n=_)}if(t){let e=0,t=-.5*LiteGraph$2.NODE_TITLE_HEIGHT;p&&(e=.5*o._collapsed_width,t=-LiteGraph$2.NODE_TITLE_HEIGHT),a.fillStyle="#686",a.beginPath(),a.arc(e,t,4,0,2*Math.PI),a.fill()}if(n){let e=o._collapsed_width,t=-.5*LiteGraph$2.NODE_TITLE_HEIGHT;p&&(e=.5*o._collapsed_width,t=0),a.fillStyle="#686",a.strokeStyle="black",a.beginPath(),n.type===LiteGraph$2.EVENT||n.shape===LiteGraph$2.BOX_SHAPE?a.rect(e-7+.5,t-4,14,8):n.shape===LiteGraph$2.ARROW_SHAPE?(a.moveTo(e+6,t),a.lineTo(e-6,t-4),a.lineTo(e-6,t+4),a.closePath()):a.arc(e,t,4,0,2*Math.PI),a.fill()}}}else{if(o.inputs)for(let n=0;n<o.inputs.length;n++){var y=o.inputs[n],v=y.type;let e=y.shape,t=(a.globalAlpha=l,this.connecting_output&&!LiteGraph$2.isValidConnection(y.type,c.type)&&(a.globalAlpha=.4*l),a.fillStyle=null!=y.link?y.color_on||this.default_connection_color_byType[v]||this.default_connection_color.input_on:y.color_off||this.default_connection_color_byTypeOff[v]||this.default_connection_color_byType[v]||this.default_connection_color.input_off,o.getConnectionPos(!0,n,g));t[0]-=o.pos[0],t[1]-=o.pos[1],i<t[1]+.5*LiteGraph$2.NODE_SLOT_HEIGHT&&(i=t[1]+.5*LiteGraph$2.NODE_SLOT_HEIGHT),a.beginPath(),"array"==v&&(e=LiteGraph$2.GRID_SHAPE),y.type===LiteGraph$2.EVENT||y.shape===LiteGraph$2.BOX_SHAPE?p?a.rect(t[0]-5+.5,t[1]-8+.5,10,14):a.rect(t[0]-6+.5,t[1]-5+.5,14,10):e===LiteGraph$2.ARROW_SHAPE?(a.moveTo(t[0]+8,t[1]+.5),a.lineTo(t[0]-4,t[1]+6+.5),a.lineTo(t[0]-4,t[1]-6+.5),a.closePath()):e===LiteGraph$2.GRID_SHAPE?(a.rect(t[0]-4,t[1]-4,2,2),a.rect(t[0]-1,t[1]-4,2,2),a.rect(t[0]+2,t[1]-4,2,2),a.rect(t[0]-4,t[1]-1,2,2),a.rect(t[0]-1,t[1]-1,2,2),a.rect(t[0]+2,t[1]-1,2,2),a.rect(t[0]-4,t[1]+2,2,2),a.rect(t[0]-1,t[1]+2,2,2),a.rect(t[0]+2,t[1]+2,2,2)):s?a.rect(t[0]-4,t[1]-4,8,8):a.arc(t[0],t[1],4,0,2*Math.PI),a.fill(),!u||(v=null!=y.label?y.label:y.name)&&(a.fillStyle=LiteGraph$2.NODE_TEXT_COLOR,p||y.dir==LiteGraph$2.UP?a.fillText(v,t[0],t[1]-10):a.fillText(v,t[0]+10,t[1]+5))}if(a.textAlign=p?"center":"right",a.strokeStyle="black",o.outputs)for(let r=0;r<o.outputs.length;r++){var b=o.outputs[r],m=b.type;let e=b.shape,t=(this.connecting_input&&!LiteGraph$2.isValidConnection(m,d.type)&&(a.globalAlpha=.4*l),o.getConnectionPos(!1,r,g)),n=(t[0]-=o.pos[0],t[1]-=o.pos[1],i<t[1]+.5*LiteGraph$2.NODE_SLOT_HEIGHT&&(i=t[1]+.5*LiteGraph$2.NODE_SLOT_HEIGHT),a.fillStyle=b.links&&b.links.length?b.color_on||this.default_connection_color_byType[m]||this.default_connection_color.output_on:b.color_off||this.default_connection_color_byTypeOff[m]||this.default_connection_color_byType[m]||this.default_connection_color.output_off,a.beginPath(),"array"==m&&(e=LiteGraph$2.GRID_SHAPE),!0);m===LiteGraph$2.EVENT||e===LiteGraph$2.BOX_SHAPE?p?a.rect(t[0]-5+.5,t[1]-8+.5,10,14):a.rect(t[0]-6+.5,t[1]-5+.5,14,10):e===LiteGraph$2.ARROW_SHAPE?(a.moveTo(t[0]+8,t[1]+.5),a.lineTo(t[0]-4,t[1]+6+.5),a.lineTo(t[0]-4,t[1]-6+.5),a.closePath()):e===LiteGraph$2.GRID_SHAPE?(a.rect(t[0]-4,t[1]-4,2,2),a.rect(t[0]-1,t[1]-4,2,2),a.rect(t[0]+2,t[1]-4,2,2),a.rect(t[0]-4,t[1]-1,2,2),a.rect(t[0]-1,t[1]-1,2,2),a.rect(t[0]+2,t[1]-1,2,2),a.rect(t[0]-4,t[1]+2,2,2),a.rect(t[0]-1,t[1]+2,2,2),a.rect(t[0]+2,t[1]+2,2,2),n=!1):s?a.rect(t[0]-4,t[1]-4,8,8):a.arc(t[0],t[1],4,0,2*Math.PI),a.fill(),!s&&n&&a.stroke(),!u||(m=null!=b.label?b.label:b.name)&&(a.fillStyle=LiteGraph$2.NODE_TEXT_COLOR,p||b.dir==LiteGraph$2.DOWN?a.fillText(m,t[0],t[1]-8):a.fillText(m,t[0]-10,t[1]+5))}if(a.textAlign="left",a.globalAlpha=1,o.widgets){let e=i;(p||o.widgets_up)&&(e=2),null!=o.widgets_start_y&&(e=o.widgets_start_y),this.drawNodeWidgets(o,e,a,this.node_widget&&this.node_widget[0]==o?this.node_widget[1]:null)}}o.clip_area&&a.restore(),a.globalAlpha=1}}},LGraphCanvas.prototype.drawLinkTooltip=function(n,r){var i=r._pos;if(n.fillStyle="black",n.beginPath(),n.arc(i[0],i[1],3,0,2*Math.PI),n.fill(),null!=r.data&&(!this.onDrawLinkTooltip||1!=this.onDrawLinkTooltip(n,r,this))){let e=r.data,t=null;null!=(t=e.constructor===Number?e.toFixed(2):e.constructor===String?'"'+e+'"':e.constructor===Boolean?String(e):e.toToolTip?e.toToolTip():"["+e.constructor.name+"]")&&(t=t.substr(0,30),n.font="14px Courier New",r=n.measureText(t).width+20,n.shadowColor="black",n.shadowOffsetX=2,n.shadowOffsetY=2,n.shadowBlur=3,n.fillStyle="#454",n.beginPath(),n.roundRect(i[0]-.5*r,i[1]-15-24,r,24,[3]),n.moveTo(i[0]-10,i[1]-15),n.lineTo(i[0]+10,i[1]-15),n.lineTo(i[0],i[1]-5),n.fill(),n.shadowColor="transparent",n.textAlign="center",n.fillStyle="#CEC",n.fillText(t,i[0],i[1]-15-24*.3))}},LGraphCanvas.prototype.drawNodeShape=function(t,n,r,i,o,a,s){n.strokeStyle=i,n.fillStyle=o;var o=LiteGraph$2.NODE_TITLE_HEIGHT,l=this.ds.scale<.5,h=t._shape||t.constructor.shape||LiteGraph$2.DEFAULT_SHAPE,p=t.constructor.title_mode;let e=!0,u=(p==LiteGraph$2.TRANSPARENT_TITLE||p==LiteGraph$2.NO_TITLE?e=!1:p==LiteGraph$2.AUTOHIDE_TITLE&&s&&(e=!0),temp_area_vec4);u[0]=0,u[1]=e?-o:0,u[2]=r[0]+1,u[3]=e?r[1]+o:r[1];s=n.globalAlpha;if(n.beginPath(),h==LiteGraph$2.BOX_SHAPE||l?n.fillRect(u[0],u[1],u[2],u[3]):h==LiteGraph$2.ROUND_SHAPE||h==LiteGraph$2.CARD_SHAPE?n.roundRect(u[0],u[1],u[2],u[3],h==LiteGraph$2.CARD_SHAPE?[this.round_radius,this.round_radius,0,0]:[this.round_radius]):h==LiteGraph$2.CIRCLE_SHAPE&&n.arc(.5*r[0],.5*r[1],.5*r[0],0,2*Math.PI),n.fill(),!t.flags.collapsed&&e&&(n.shadowColor="transparent",n.fillStyle="rgba(0,0,0,0.2)",n.fillRect(0,-1,u[2],2)),n.shadowColor="transparent",t.onDrawBackground&&t.onDrawBackground(n,this,this.canvas,this.graph_mouse),e||p==LiteGraph$2.TRANSPARENT_TITLE){if(t.onDrawTitleBar)t.onDrawTitleBar(n,o,r,this.ds.scale,i);else if(p!=LiteGraph$2.TRANSPARENT_TITLE&&(t.constructor.title_color||this.render_title_colored)){var c=t.constructor.title_color||i;if(t.flags.collapsed&&(n.shadowColor=LiteGraph$2.DEFAULT_SHADOW_COLOR),this.use_gradients){let e=LGraphCanvas.gradients[c];e||((e=LGraphCanvas.gradients[c]=n.createLinearGradient(0,0,400,0)).addColorStop(0,c),e.addColorStop(1,"#000")),n.fillStyle=e}else n.fillStyle=c;n.beginPath(),h==LiteGraph$2.BOX_SHAPE||l?n.rect(0,-o,r[0]+1,o):h!=LiteGraph$2.ROUND_SHAPE&&h!=LiteGraph$2.CARD_SHAPE||n.roundRect(0,-o,r[0]+1,o,t.flags.collapsed?[this.round_radius]:[this.round_radius,this.round_radius,0,0]),n.fill(),n.shadowColor="transparent"}let e=!1;LiteGraph$2.node_box_coloured_by_mode&&LiteGraph$2.NODE_MODES_COLORS[t.mode]&&(e=LiteGraph$2.NODE_MODES_COLORS[t.mode]),LiteGraph$2.node_box_coloured_when_on&&(e=t.action_triggered?"#FFF":t.execute_triggered?"#AAA":e);var d;if(t.onDrawTitleBox?t.onDrawTitleBox(n,o,r,this.ds.scale):h==LiteGraph$2.ROUND_SHAPE||h==LiteGraph$2.CIRCLE_SHAPE||h==LiteGraph$2.CARD_SHAPE?(l&&(n.fillStyle="black",n.beginPath(),n.arc(.5*o,-.5*o,6,0,2*Math.PI),n.fill()),n.fillStyle=t.boxcolor||e||LiteGraph$2.NODE_DEFAULT_BOXCOLOR,l?n.fillRect(.5*o-5,-.5*o-5,10,10):(n.beginPath(),n.arc(.5*o,-.5*o,5,0,2*Math.PI),n.fill())):(l&&(n.fillStyle="black",n.fillRect(.5*(o-10)-1,-.5*(o+10)-1,12,12)),n.fillStyle=t.boxcolor||e||LiteGraph$2.NODE_DEFAULT_BOXCOLOR,n.fillRect(.5*(o-10),-.5*(o+10),10,10)),n.globalAlpha=s,t.onDrawTitleText&&t.onDrawTitleText(n,o,r,this.ds.scale,this.title_text_font,a),!l){n.font=this.title_text_font;let e=String(t.getTitle());e&&(n.fillStyle=a?LiteGraph$2.NODE_SELECTED_TITLE_COLOR:t.constructor.title_text_color||this.node_title_color,t.flags.collapsed?(n.textAlign="left",n.measureText(e),n.fillText(e.substr(0,20),o,LiteGraph$2.NODE_TITLE_TEXT_Y-o),n.textAlign="left"):(n.textAlign="left",n.fillText(e,o,LiteGraph$2.NODE_TITLE_TEXT_Y-o)))}t.flags.collapsed||!t.subgraph||t.skip_subgraph_button||(c=LiteGraph$2.NODE_TITLE_HEIGHT,s=t.size[0]-c,d=LiteGraph$2.isInsideRectangle(this.graph_mouse[0]-t.pos[0],this.graph_mouse[1]-t.pos[1],2+s,2-c,c-4,c-4),n.fillStyle=d?"#888":"#555",h==LiteGraph$2.BOX_SHAPE||l?n.fillRect(2+s,2-c,c-4,c-4):(n.beginPath(),n.roundRect(2+s,2-c,c-4,c-4,[4]),n.fill()),n.fillStyle="#333",n.beginPath(),n.moveTo(s+.2*c,.6*-c),n.lineTo(s+.8*c,.6*-c),n.lineTo(s+.5*c,.3*-c),n.fill()),t.onDrawTitle&&t.onDrawTitle(n)}a&&(t.onBounding&&t.onBounding(u),p==LiteGraph$2.TRANSPARENT_TITLE&&(u[1]-=o,u[3]+=o),n.lineWidth=1,n.globalAlpha=.8,n.beginPath(),h==LiteGraph$2.BOX_SHAPE?n.rect(-6+u[0],-6+u[1],12+u[2],12+u[3]):h==LiteGraph$2.ROUND_SHAPE||h==LiteGraph$2.CARD_SHAPE&&t.flags.collapsed?n.roundRect(-6+u[0],-6+u[1],12+u[2],12+u[3],[2*this.round_radius]):h==LiteGraph$2.CARD_SHAPE?n.roundRect(-6+u[0],-6+u[1],12+u[2],12+u[3],[2*this.round_radius,2,2*this.round_radius,2]):h==LiteGraph$2.CIRCLE_SHAPE&&n.arc(.5*r[0],.5*r[1],.5*r[0]+6,0,2*Math.PI),n.strokeStyle=LiteGraph$2.NODE_BOX_OUTLINE_COLOR,n.stroke(),n.strokeStyle=i,n.globalAlpha=1),0<t.execute_triggered&&t.execute_triggered--,0<t.action_triggered&&t.action_triggered--},LGraphCanvas.prototype.drawConnections=function(i){var o=LiteGraph$2.getTime(),e=this.visible_area,n=(temp_margin_vec4[0]=e[0]-20,temp_margin_vec4[1]=e[1]-20,temp_margin_vec4[2]=e[2]+40,temp_margin_vec4[3]=e[3]+40,i.lineWidth=this.connections_width,i.fillStyle="#AAA",i.strokeStyle="#AAA",i.globalAlpha=this.editor_alpha,this.graph._nodes);for(let e=0,t=n.length;e<t;++e){let r=n[e];if(r.inputs&&r.inputs.length)for(let n=0;n<r.inputs.length;++n){var a=r.inputs[n];if(a&&null!=a.link){a=a.link,a=this.graph.links[a];if(a){let t=this.graph.getNodeById(a.origin_id);if(null!=t){var s=a.origin_slot;let e=null;e=-1==s?[t.pos[0]+10,t.pos[1]+10]:t.getConnectionPos(!1,s,temp_slot_a_vec2);var l,h,p,u=r.getConnectionPos(!0,n,temp_slot_b_vec2);link_bounding_vec4[0]=e[0],link_bounding_vec4[1]=e[1],link_bounding_vec4[2]=u[0]-e[0],link_bounding_vec4[3]=u[1]-e[1],link_bounding_vec4[2]<0&&(link_bounding_vec4[0]+=link_bounding_vec4[2],link_bounding_vec4[2]=Math.abs(link_bounding_vec4[2])),link_bounding_vec4[3]<0&&(link_bounding_vec4[1]+=link_bounding_vec4[3],link_bounding_vec4[3]=Math.abs(link_bounding_vec4[3])),overlapBounding(link_bounding_vec4,temp_margin_vec4)&&(s=t.outputs[s],l=r.inputs[n],s&&l&&(s=s.dir||(t.horizontal?LiteGraph$2.DOWN:LiteGraph$2.RIGHT),l=l.dir||(r.horizontal?LiteGraph$2.UP:LiteGraph$2.LEFT),this.renderLink(i,e,u,a,!1,0,null,s,l),a&&a._last_time&&o-a._last_time<1e3&&(h=2-.002*(o-a._last_time),p=i.globalAlpha,i.globalAlpha=p*h,this.renderLink(i,e,u,a,!0,h,"white",s,l),i.globalAlpha=p)))}}}}}i.globalAlpha=1},LGraphCanvas.prototype.renderLink=function(i,o,a,n,e,t,r,s,l,h){n&&this.visible_links.push(n),r=(r=!r&&n?n.color||LGraphCanvas.link_type_colors[n.type]:r)||this.default_link_color,null!=n&&this.highlighted_links[n.id]&&(r="#FFF"),s=s||LiteGraph$2.RIGHT,l=l||LiteGraph$2.LEFT;var p=distance(o,a);this.render_connections_border&&.6<this.ds.scale&&(i.lineWidth=this.connections_width+4),i.lineJoin="round",1<(h=h||1)&&(i.lineWidth=.5),i.beginPath();for(let e=0;e<h;e+=1){var u=5*(e-.5*(h-1));if(this.links_render_mode==LiteGraph$2.SPLINE_LINK){i.moveTo(o[0],o[1]+u);let e=0,t=0,n=0,r=0;switch(s){case LiteGraph$2.LEFT:e=-.25*p;break;case LiteGraph$2.RIGHT:e=.25*p;break;case LiteGraph$2.UP:t=-.25*p;break;case LiteGraph$2.DOWN:t=.25*p}switch(l){case LiteGraph$2.LEFT:n=-.25*p;break;case LiteGraph$2.RIGHT:n=.25*p;break;case LiteGraph$2.UP:r=-.25*p;break;case LiteGraph$2.DOWN:r=.25*p}i.bezierCurveTo(o[0]+e,o[1]+t+u,a[0]+n,a[1]+r+u,a[0],a[1]+u)}else if(this.links_render_mode==LiteGraph$2.LINEAR_LINK){i.moveTo(o[0],o[1]+u);let e=0,t=0,n=0,r=0;switch(s){case LiteGraph$2.LEFT:e=-1;break;case LiteGraph$2.RIGHT:e=1;break;case LiteGraph$2.UP:t=-1;break;case LiteGraph$2.DOWN:t=1}switch(l){case LiteGraph$2.LEFT:n=-1;break;case LiteGraph$2.RIGHT:n=1;break;case LiteGraph$2.UP:r=-1;break;case LiteGraph$2.DOWN:r=1}i.lineTo(o[0]+15*e,o[1]+15*t+u),i.lineTo(a[0]+15*n,a[1]+15*r+u),i.lineTo(a[0],a[1]+u)}else{if(this.links_render_mode!=LiteGraph$2.STRAIGHT_LINK)return;{i.moveTo(o[0],o[1]);let e=o[0],t=o[1],n=a[0],r=a[1];s==LiteGraph$2.RIGHT?e+=10:t+=10,l==LiteGraph$2.LEFT?n-=10:r-=10,i.lineTo(e,t),i.lineTo(.5*(e+n),t),i.lineTo(.5*(e+n),r),i.lineTo(n,r),i.lineTo(a[0],a[1])}}}this.render_connections_border&&.6<this.ds.scale&&!e&&(i.strokeStyle="rgba(0,0,0,0.5)",i.stroke()),i.lineWidth=this.connections_width,i.fillStyle=i.strokeStyle=r,i.stroke();e=this.computeConnectionPoint(o,a,.5,s,l);if(n&&n._pos&&(n._pos[0]=e[0],n._pos[1]=e[1]),.6<=this.ds.scale&&this.highquality_render&&l!=LiteGraph$2.CENTER){if(this.render_connection_arrows){var n=this.computeConnectionPoint(o,a,.25,s,l),c=this.computeConnectionPoint(o,a,.26,s,l),d=this.computeConnectionPoint(o,a,.75,s,l),g=this.computeConnectionPoint(o,a,.76,s,l);let e=0,t=0;t=this.render_curved_connections?(e=-Math.atan2(c[0]-n[0],c[1]-n[1]),-Math.atan2(g[0]-d[0],g[1]-d[1])):e=a[1]>o[1]?0:Math.PI,i.save(),i.translate(n[0],n[1]),i.rotate(e),i.beginPath(),i.moveTo(-5,-3),i.lineTo(0,7),i.lineTo(5,-3),i.fill(),i.restore(),i.save(),i.translate(d[0],d[1]),i.rotate(t),i.beginPath(),i.moveTo(-5,-3),i.lineTo(0,7),i.lineTo(5,-3),i.fill(),i.restore()}i.beginPath(),i.arc(e[0],e[1],5,0,2*Math.PI),i.fill()}if(t){i.fillStyle=r;for(let e=0;e<5;++e){var f=(.001*LiteGraph$2.getTime()+.2*e)%1,f=this.computeConnectionPoint(o,a,f,s,l);i.beginPath(),i.arc(f[0],f[1],5,0,2*Math.PI),i.fill()}}},LGraphCanvas.prototype.computeConnectionPoint=function(e,t,n,r,i){r=r||LiteGraph$2.RIGHT,i=i||LiteGraph$2.LEFT;var o=distance(e,t),a=e;let s=[e[0],e[1]],l=[t[0],t[1]];e=t;switch(r){case LiteGraph$2.LEFT:s[0]+=-.25*o;break;case LiteGraph$2.RIGHT:s[0]+=.25*o;break;case LiteGraph$2.UP:s[1]+=-.25*o;break;case LiteGraph$2.DOWN:s[1]+=.25*o}switch(i){case LiteGraph$2.LEFT:l[0]+=-.25*o;break;case LiteGraph$2.RIGHT:l[0]+=.25*o;break;case LiteGraph$2.UP:l[1]+=-.25*o;break;case LiteGraph$2.DOWN:l[1]+=.25*o}t=(1-n)*(1-n)*(1-n),r=(1-n)*(1-n)*3*n,i=3*(1-n)*(n*n),n*=n*n;return[t*a[0]+r*s[0]+i*l[0]+n*e[0],t*a[1]+r*s[1]+i*l[1]+n*e[1]]},LGraphCanvas.prototype.drawExecutionOrder=function(t){t.shadowColor="transparent",t.globalAlpha=.25,t.textAlign="center",t.strokeStyle="white",t.globalAlpha=.75;var n=this.visible_nodes;for(let e=0;e<n.length;++e){var r=n[e];t.fillStyle="black",t.fillRect(r.pos[0]-LiteGraph$2.NODE_TITLE_HEIGHT,r.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT,LiteGraph$2.NODE_TITLE_HEIGHT,LiteGraph$2.NODE_TITLE_HEIGHT),0==r.order&&t.strokeRect(r.pos[0]-LiteGraph$2.NODE_TITLE_HEIGHT+.5,r.pos[1]-LiteGraph$2.NODE_TITLE_HEIGHT+.5,LiteGraph$2.NODE_TITLE_HEIGHT,LiteGraph$2.NODE_TITLE_HEIGHT),t.fillStyle="#FFF",t.fillText(r.order,r.pos[0]+-.5*LiteGraph$2.NODE_TITLE_HEIGHT,r.pos[1]-6)}t.globalAlpha=1},LGraphCanvas.prototype.drawNodeWidgets=function(r,i,o,a){if(!r.widgets||!r.widgets.length)return 0;var s=r.size[0],l=r.widgets,h=(i+=2,LiteGraph$2.NODE_WIDGET_HEIGHT),p=.5<this.ds.scale,u=(o.save(),o.globalAlpha=this.editor_alpha,LiteGraph$2.WIDGET_OUTLINE_COLOR),c=LiteGraph$2.WIDGET_BGCOLOR,d=LiteGraph$2.WIDGET_TEXT_COLOR,g=LiteGraph$2.WIDGET_SECONDARY_TEXT_COLOR;for(let t=0;t<l.length;++t){let n=l[t],e=i;n.y&&(e=n.y),n.last_y=e,o.strokeStyle=u,o.fillStyle="#222",o.textAlign="left",n.disabled&&(o.globalAlpha*=.5);var f=n.width||s;switch(n.type){case"button":n.clicked&&(o.fillStyle="#AAA",n.clicked=!1,this.dirty_canvas=!0),o.fillRect(15,e,f-30,h),p&&!n.disabled&&o.strokeRect(15,e,f-30,h),p&&(o.textAlign="center",o.fillStyle=d,o.fillText(n.name,.5*f,e+.7*h));break;case"toggle":o.textAlign="left",o.strokeStyle=u,o.fillStyle=c,o.beginPath(),p?o.roundRect(15,e,f-30,h,[.5*h]):o.rect(15,e,f-30,h),o.fill(),p&&!n.disabled&&o.stroke(),o.fillStyle=n.value?"#89A":"#333",o.beginPath(),o.arc(f-30,e+.5*h,.36*h,0,2*Math.PI),o.fill(),p&&(o.fillStyle=g,null!=n.name&&o.fillText(n.name,30,e+.7*h),o.fillStyle=n.value?d:g,o.textAlign="right",o.fillText(n.value?n.options.on||"true":n.options.off||"false",f-40,e+.7*h));break;case"slider":o.fillStyle=c,o.fillRect(15,e,f-30,h);var _=n.options.max-n.options.min,y=(n.value-n.options.min)/_;o.fillStyle=a==n?"#89A":"#678",o.fillRect(15,e,y*(f-30),h),p&&!n.disabled&&o.strokeRect(15,e,f-30,h),n.marker&&(y=(n.marker-n.options.min)/_,o.fillStyle="#AA9",o.fillRect(15+y*(f-30),e,2,h)),p&&(o.textAlign="center",o.fillStyle=d,o.fillText(n.name+"  "+Number(n.value).toFixed(3),.5*f,e+.7*h));break;case"number":case"combo":if(o.textAlign="left",o.strokeStyle=u,o.fillStyle=c,o.beginPath(),p?o.roundRect(15,e,f-30,h,[.5*h]):o.rect(15,e,f-30,h),o.fill(),p)if(n.disabled||o.stroke(),o.fillStyle=d,n.disabled||(o.beginPath(),o.moveTo(31,e+5),o.lineTo(21,e+.5*h),o.lineTo(31,e+h-5),o.fill(),o.beginPath(),o.moveTo(f-15-16,e+5),o.lineTo(f-15-6,e+.5*h),o.lineTo(f-15-16,e+h-5),o.fill()),o.fillStyle=g,o.fillText(n.name,35,e+.7*h),o.fillStyle=d,o.textAlign="right","number"==n.type)o.fillText(Number(n.value).toFixed(void 0!==n.options.precision?n.options.precision:3),f-30-20,e+.7*h);else{let t=n.value;if(n.options.values){let e=n.options.values;(e=e.constructor===Function?e():e)&&e.constructor!==Array&&(t=e[n.value])}o.fillText(t,f-30-20,e+.7*h)}break;case"string":case"text":o.textAlign="left",o.strokeStyle=u,o.fillStyle=c,o.beginPath(),p?o.roundRect(15,e,f-30,h,[.5*h]):o.rect(15,e,f-30,h),o.fill(),p&&(n.disabled||o.stroke(),o.save(),o.beginPath(),o.rect(15,e,f-30,h),o.clip(),o.fillStyle=g,null!=n.name&&o.fillText(n.name,30,e+.7*h),o.fillStyle=d,o.textAlign="right",o.fillText(String(n.value).substr(0,30),f-30,e+.7*h),o.restore());break;default:n.draw&&n.draw(o,r,f,e,h)}i+=(n.computeSize?n.computeSize(f)[1]:h)+4,o.globalAlpha=this.editor_alpha}o.restore(),o.textAlign="left"},LGraphCanvas.prototype.processNodeWidgets=function(n,r,s,i){if(n.widgets&&n.widgets.length){var l=r[0]-n.pos[0],o=r[1]-n.pos[1],h=n.size[0];let a=this;var p=this.getCanvasWindow();for(let e=0;e<n.widgets.length;++e){let t=n.widgets[e];if(t&&!t.disabled){var u=t.computeSize?t.computeSize(h)[1]:LiteGraph$2.NODE_WIDGET_HEIGHT,c=t.width||h;if(t==i||!(l<6||c-12<l||o<t.last_y||o>t.last_y+u||void 0===t.last_y)){u=t.value;switch(t.type){case"button":s.type===LiteGraph$2.pointerevents_method+"down"&&(t.callback&&setTimeout(function(){t.callback(t,a,n,r,s)},20),t.clicked=!0,this.dirty_canvas=!0);break;case"slider":t.options.max,t.options.min;var d=Math.clamp((l-15)/(c-30),0,1);t.value=t.options.min+(t.options.max-t.options.min)*d,t.callback&&setTimeout(function(){_(t,t.value)},20),this.dirty_canvas=!0;break;case"number":case"combo":d=t.value;if(s.type==LiteGraph$2.pointerevents_method+"move"&&"number"==t.type)t.value+=.1*s.deltaX*(t.options.step||1),null!=t.options.min&&t.value<t.options.min&&(t.value=t.options.min),null!=t.options.max&&t.value>t.options.max&&(t.value=t.options.max);else if(s.type==LiteGraph$2.pointerevents_method+"down"){let i=t.options.values,o=(i&&i.constructor===Function&&(i=t.options.values(t,n)),null);"number"!=t.type&&(o=i.constructor===Array?i:Object.keys(i));var g=l<40?-1:c-40<l?1:0;if("number"==t.type)t.value+=.1*g*(t.options.step||1),null!=t.options.min&&t.value<t.options.min&&(t.value=t.options.min),null!=t.options.max&&t.value>t.options.max&&(t.value=t.options.max);else if(g){let e=-1;this.last_mouseclick=0,(e=(e=i.constructor===Object?o.indexOf(String(t.value))+g:o.indexOf(t.value)+g)>=o.length?o.length-1:e)<0&&(e=0),i.constructor===Array?t.value=i[e]:t.value=e}else{let r=i!=o?Object.values(i):i;function f(e,t,n){return i!=o&&(e=r.indexOf(e)),this.value=e,_(this,e),!(a.dirty_canvas=!0)}new LiteGraph$2.ContextMenu(r,{scale:Math.max(1,this.ds.scale),event:s,className:"dark",callback:f.bind(t)},p)}}else s.type==LiteGraph$2.pointerevents_method+"up"&&"number"==t.type&&s.click_time<200&&0==(l<40?-1:c-40<l?1:0)&&this.prompt("Value",t.value,function(e){this.value=Number(e),_(this,this.value)}.bind(t),s);d!=t.value&&setTimeout(function(){_(this,this.value)}.bind(t),20),this.dirty_canvas=!0;break;case"toggle":s.type==LiteGraph$2.pointerevents_method+"down"&&(t.value=!t.value,setTimeout(function(){_(t,t.value)},20));break;case"string":case"text":s.type==LiteGraph$2.pointerevents_method+"down"&&this.prompt("Value",t.value,function(e){this.value=e,_(this,e)}.bind(t),s,!!t.options&&t.options.multiline);break;default:t.mouse&&(this.dirty_canvas=t.mouse(s,[l,o],n))}return u!=t.value&&(n.onWidgetChanged&&n.onWidgetChanged(t.name,t.value,u,t),n.graph._version++),t}}}function _(e,t){e.value=t,e.options&&e.options.property&&void 0!==n.properties[e.options.property]&&n.setProperty(e.options.property,t),e.callback&&e.callback(e.value,a,n,r,s)}}return null},LGraphCanvas.prototype.drawGroups=function(e,t){if(this.graph){var n=this.graph._groups;t.save(),t.globalAlpha=.5*this.editor_alpha;for(let e=0;e<n.length;++e){var r,i,o=n[e];overlapBounding(this.visible_area,o._bounding)&&(t.fillStyle=o.color||"#335",t.strokeStyle=o.color||"#335",r=o._pos,i=o._size,t.globalAlpha=.25*this.editor_alpha,t.beginPath(),t.rect(r[0]+.5,r[1]+.5,i[0],i[1]),t.fill(),t.globalAlpha=this.editor_alpha,t.stroke(),t.beginPath(),t.moveTo(r[0]+i[0],r[1]+i[1]),t.lineTo(r[0]+i[0]-10,r[1]+i[1]),t.lineTo(r[0]+i[0],r[1]+i[1]-10),t.fill(),i=o.font_size||LiteGraph$2.DEFAULT_GROUP_FONT_SIZE,t.font=i+"px Arial",t.textAlign="left",t.fillText(o.title,r[0]+4,r[1]+i))}t.restore()}},LGraphCanvas.prototype.adjustNodesSize=function(){let t=this.graph._nodes;for(let e=0;e<t.length;++e)t[e].size=t[e].computeSize();this.setDirty(!0,!0)},LGraphCanvas.prototype.resize=function(e,t){var n;e||t||(e=(n=this.canvas.parentNode).offsetWidth,t=n.offsetHeight),this.canvas.width==e&&this.canvas.height==t||(this.canvas.width=e,this.canvas.height=t,this.bgcanvas.width=this.canvas.width,this.bgcanvas.height=this.canvas.height,this.setDirty(!0,!0))},LGraphCanvas.prototype.switchLiveMode=function(e){if(e){let e=this,t=this.live_mode?1.1:.9,n=(this.live_mode&&(this.live_mode=!1,this.editor_alpha=.1),setInterval(function(){e.editor_alpha*=t,e.dirty_canvas=!0,e.dirty_bgcanvas=!0,t<1&&e.editor_alpha<.01&&(clearInterval(n),t<1&&(e.live_mode=!0)),1<t&&.99<e.editor_alpha&&(clearInterval(n),e.editor_alpha=1)},1))}else this.live_mode=!this.live_mode,this.dirty_canvas=!0,this.dirty_bgcanvas=!0},LGraphCanvas.prototype.onNodeSelectionChange=function(e){},LGraphCanvas.onGroupAdd=function(e,t,n){let r=LGraphCanvas.active_canvas,i=(r.getCanvasWindow(),new LiteGraph$2.LGraphGroup);i.pos=r.convertEventToCanvasOffset(n),r.graph.add(i)},LGraphCanvas.onMenuAdd=function(e,t,r,n,s){let l=LGraphCanvas.active_canvas,h=l.getCanvasWindow(),p=l.graph;if(p)return function i(o,e){let t=LiteGraph$2.getNodeTypesCategories(l.filter||p.filter).filter(function(e){return e.startsWith(o)}),a=[],n=(t.map(function(n){if(n){var r=new RegExp("^("+o+")"),n=n.replace(r,"").split("/")[0];let t=""===o?n+"/":o+n+"/",e=n;-1!=e.indexOf("::")&&(e=e.split("::")[1]),-1===a.findIndex(function(e){return e.value===t})&&a.push({value:t,content:e,has_submenu:!0,callback:function(e,t,n,r){i(e.value,r)}})}}),LiteGraph$2.getNodeTypesInCategory(o.slice(0,-1),l.filter||p.filter));n.map(function(e){e.skip_list||(e={value:e.type,content:e.title,has_submenu:!1,callback:function(e,t,n,r){r=r.getFirstEvent(),l.graph.beforeChange();let i=LiteGraph$2.createNode(e.value);i&&(i.pos=l.convertEventToCanvasOffset(r),l.graph.add(i)),s&&s(i),l.graph.afterChange()}},a.push(e))}),new LiteGraph$2.ContextMenu(a,{event:r,parentMenu:e},h)}("",n),!1},LGraphCanvas.onMenuCollapseAll=function(){},LGraphCanvas.onMenuNodeEdit=function(){},LGraphCanvas.showMenuNodeOptionalInputs=function(e,t,n,o,a){if(a){let r=this,e=LGraphCanvas.active_canvas;var s,l=e.getCanvasWindow();t=a.optional_inputs;let i=[];if(t=a.onGetInputs?a.onGetInputs():t)for(let e=0;e<t.length;e++){let n=t[e];if(n){let e=n[0],t=(n[2]||(n[2]={}),n[2].label&&(e=n[2].label),n[2].removable=!0,{content:e,value:n});n[1]==LiteGraph$2.ACTION&&(t.className="event"),i.push(t)}else i.push(null)}if(!a.onMenuNodeInputs||(s=a.onMenuNodeInputs(i))&&(i=s),i.length)return new LiteGraph$2.ContextMenu(i,{event:n,callback:function(e,t,n){a&&(e.callback&&e.callback.call(r,a,e,t,n),e.value&&(a.graph.beforeChange(),a.addInput(e.value[0],e.value[1],e.value[2]),a.onNodeInputAdd&&a.onNodeInputAdd(e.value),a.setDirtyCanvas(!0,!0),a.graph.afterChange()))},parentMenu:o,node:a},l),!1;console.log("no input entries")}},LGraphCanvas.showMenuNodeOptionalOutputs=function(e,t,n,s,l){if(l){let a=this,e=LGraphCanvas.active_canvas;var i,o=e.getCanvasWindow();t=l.optional_outputs;let r=[];if(t=l.onGetOutputs?l.onGetOutputs():t)for(let e=0;e<t.length;e++){let n=t[e];if(n){if(!l.flags||!l.flags.skip_repeated_outputs||-1==l.findOutputSlot(n[0])){let e=n[0],t=(n[2]||(n[2]={}),n[2].label&&(e=n[2].label),n[2].removable=!0,{content:e,value:n});n[1]==LiteGraph$2.EVENT&&(t.className="event"),r.push(t)}}else r.push(null)}if(this.onMenuNodeOutputs&&(r=this.onMenuNodeOutputs(r)),LiteGraph$2.do_add_triggers_slots&&-1==l.findOutputSlot("onExecuted")&&r.push({content:"On Executed",value:["onExecuted",LiteGraph$2.EVENT,{nameLocked:!0}],className:"event"}),!l.onMenuNodeOutputs||(i=l.onMenuNodeOutputs(r))&&(r=i),r.length)return new LiteGraph$2.ContextMenu(r,{event:n,callback:function t(e,n,r){if(!l)return;e.callback&&e.callback.call(a,l,e,n,r);if(!e.value)return;let i=e.value[1];{if(i&&(i.constructor===Object||i.constructor===Array)){let e=[];for(var o in i)e.push({content:o,value:i[o]});return new LiteGraph$2.ContextMenu(e,{event:n,callback:t,parentMenu:s,node:l}),!1}l.graph.beforeChange(),l.addOutput(e.value[0],e.value[1],e.value[2]),l.onNodeOutputAdd&&l.onNodeOutputAdd(e.value),l.setDirtyCanvas(!0,!0),l.graph.afterChange()}},parentMenu:s,node:l},o),!1}},LGraphCanvas.onShowMenuNodeProperties=function(e,t,n,r,a){if(a&&a.properties){let o=LGraphCanvas.active_canvas;var i,s=o.getCanvasWindow();let t=[];for(i in a.properties){let e=void 0!==a.properties[i]?a.properties[i]:" ";"object"==typeof e&&(e=JSON.stringify(e));var l=a.getPropertyInfo(i);"enum"!=l.type&&"combo"!=l.type||(e=LGraphCanvas.getPropertyPrintableValue(e,l.values)),e=LGraphCanvas.decodeHTML(e),t.push({content:"<span class='property_name'>"+(l.label||i)+"</span><span class='property_value'>"+e+"</span>",value:i})}if(t.length)return new LiteGraph$2.ContextMenu(t,{event:n,callback:function(e,t,n,r){var i;a&&(i=this.getBoundingClientRect(),o.showEditPropertyValue(a,e.value,{position:[i.left,i.top]}))},parentMenu:r,allow_html:!0,node:a},s),!1}},LGraphCanvas.decodeHTML=function(e){let t=document.createElement("div");return t.innerText=e,t.innerHTML},LGraphCanvas.onMenuResizeNode=function(e,t,n,r,i){if(i){function o(e){e.size=e.computeSize(),e.onResize&&e.onResize(e.size)}var a=LGraphCanvas.active_canvas;if(!a.selected_nodes||Object.keys(a.selected_nodes).length<=1)o(i);else for(var s in a.selected_nodes)o(a.selected_nodes[s]);i.setDirtyCanvas(!0,!0)}},LGraphCanvas.prototype.showLinkMenu=function(r,e){let i=this,o=i.graph.getNodeById(r.origin_id),a=i.graph.getNodeById(r.target_id),s=!1,l=(o&&o.outputs&&o.outputs[r.origin_slot]&&(s=o.outputs[r.origin_slot].type),!1);a&&a.outputs&&a.outputs[r.target_slot]&&(l=a.inputs[r.target_slot].type);let h=new LiteGraph$2.ContextMenu(["Add Node",null,"Delete",null],{event:e,title:null!=r.data?r.data.constructor.name:null,callback:function(e,t,n){switch(e){case"Add Node":LGraphCanvas.onMenuAdd(null,null,n,h,function(e){e.inputs&&e.inputs.length&&e.outputs&&e.outputs.length&&o.connectByType(r.origin_slot,e,s)&&(e.connectByType(r.target_slot,a,l),e.pos[0]-=.5*e.size[0])});break;case"Delete":i.graph.removeLink(r.id)}}});return!1},LGraphCanvas.prototype.createDefaultNodeForSlot=function(e){e=e||{};let r=Object.assign({nodeFrom:null,slotFrom:null,nodeTo:null,slotTo:null,position:[],nodeType:null,posAdd:[0,0],posSizeFix:[0,0]},e);var i=r.nodeFrom&&null!==r.slotFrom,e=!i&&r.nodeTo&&null!==r.slotTo;if(i||e)if(r.nodeType){let e=i?r.nodeFrom:r.nodeTo,t=i?r.slotFrom:r.slotTo,n=!1;switch(typeof t){case"string":n=i?e.findOutputSlot(t,!1):e.findInputSlot(t,!1),t=(i?e.outputs:e.inputs)[t];break;case"object":n=i?e.findOutputSlot(t.name):e.findInputSlot(t.name);break;case"number":n=t,t=(i?e.outputs:e.inputs)[t];break;default:return console.warn("Cant get slot information "+t),!1}!1!==t&&!1!==n||console.warn("createDefaultNodeForSlot bad slotX "+t+" "+n);var o=t.type==LiteGraph$2.EVENT?"_event_":t.type,a=i?LiteGraph$2.slot_types_default_out:LiteGraph$2.slot_types_default_in;if(a&&a[o]){if(t.link,nodeNewType=!1,"object"==typeof a[o]||"array"==typeof a[o]){for(var s in a[o])if(r.nodeType==a[o][s]||"AUTO"==r.nodeType){nodeNewType=a[o][s];break}}else r.nodeType!=a[o]&&"AUTO"!=r.nodeType||(nodeNewType=a[o]);if(nodeNewType){let e=!1,t=("object"==typeof nodeNewType&&nodeNewType.node&&(nodeNewType=(e=nodeNewType).node),LiteGraph$2.createNode(nodeNewType));if(t){if(e){if(e.properties)for(var l in e.properties)t.addProperty(l,e.properties[l]);if(e.inputs)for(var h in t.inputs=[],e.inputs)t.addOutput(e.inputs[h][0],e.inputs[h][1]);if(e.outputs)for(var p in t.outputs=[],e.outputs)t.addOutput(e.outputs[p][0],e.outputs[p][1]);e.title&&(t.title=e.title),e.json&&t.configure(e.json)}return this.graph.add(t),t.pos=[r.position[0]+r.posAdd[0]+(r.posSizeFix[0]?r.posSizeFix[0]*t.size[0]:0),r.position[1]+r.posAdd[1]+(r.posSizeFix[1]?r.posSizeFix[1]*t.size[1]:0)],i?r.nodeFrom.connectByType(n,t,o):r.nodeTo.connectByTypeOutput(n,t,o),!0}console.log("failed creating "+nodeNewType)}}}else console.warn("No type to createDefaultNodeForSlot");else console.warn("No data passed to createDefaultNodeForSlot "+r.nodeFrom+" "+r.slotFrom+" "+r.nodeTo+" "+r.slotTo);return!1},LGraphCanvas.prototype.showConnectionMenu=function(e){e=e||{};let s=Object.assign({nodeFrom:null,slotFrom:null,nodeTo:null,slotTo:null,e:null},e),l=this,h=s.nodeFrom&&s.slotFrom;e=!h&&s.nodeTo&&s.slotTo;if(h||e){let e=h?s.nodeFrom:s.nodeTo,r=h?s.slotFrom:s.slotTo,i=!1;switch(typeof r){case"string":i=h?e.findOutputSlot(r,!1):e.findInputSlot(r,!1),r=(h?e.outputs:e.inputs)[r];break;case"object":i=h?e.findOutputSlot(r.name):e.findInputSlot(r.name);break;case"number":i=r,r=(h?e.outputs:e.inputs)[r];break;default:return console.warn("Cant get slot information "+r),!1}let t=["Add Node",null],o=(l.allow_searchbox&&(t.push("Search"),t.push(null)),r.type==LiteGraph$2.EVENT?"_event_":r.type);var n=h?LiteGraph$2.slot_types_default_out:LiteGraph$2.slot_types_default_in;if(n&&n[o])if("object"==typeof n[o]||"array"==typeof n[o])for(var p in n[o])t.push(n[o][p]);else t.push(n[o]);let a=new LiteGraph$2.ContextMenu(t,{event:s.e,title:(r&&""!=r.name?r.name+(o?" | ":""):"")+(r&&o?o:""),callback:function(e,t,n){switch(e){case"Add Node":LGraphCanvas.onMenuAdd(null,null,n,a,function(e){h?s.nodeFrom.connectByType(i,e,o):s.nodeTo.connectByTypeOutput(i,e,o)});break;case"Search":h?l.showSearchBox(n,{node_from:s.nodeFrom,slot_from:r,type_filter_in:o}):l.showSearchBox(n,{node_to:s.nodeTo,slot_from:r,type_filter_out:o});break;default:l.createDefaultNodeForSlot(Object.assign(s,{position:[s.e.canvasX,s.e.canvasY],nodeType:e}))}}})}else console.warn("No data passed to showConnectionMenu");return!1},LGraphCanvas.onShowPropertyEditor=function(t,e,n,r,i){let o=t.property||"title";var a=i[o];let s=document.createElement("div"),l=(s.is_modified=!1,s.className="graphdialog",s.innerHTML="<span class='name'></span><input autofocus type='text' class='value'/><button>OK</button>",s.close=function(){s.parentNode&&s.parentNode.removeChild(s)},s.querySelector(".name")),h=(l.innerText=o,s.querySelector(".value")),p=(h&&(h.value=a,h.addEventListener("blur",function(e){this.focus()}),h.addEventListener("keydown",function(e){if(s.is_modified=!0,27==e.keyCode)s.close();else if(13==e.keyCode)f();else if(13!=e.keyCode&&"textarea"!=e.target.localName)return;e.preventDefault(),e.stopPropagation()})),LGraphCanvas.active_canvas.canvas);a=p.getBoundingClientRect();let u=-20,c=-20,d=(a&&(u-=a.left,c-=a.top),event?(s.style.left=event.clientX+u+"px",s.style.top=event.clientY+c+"px"):(s.style.left=.5*p.width+u+"px",s.style.top=.5*p.height+c+"px"),s.querySelector("button")),g=(d.addEventListener("click",f),p.parentNode.appendChild(s),h&&h.focus(),null);function f(){var e;h&&(e=h.value,"Number"==t.type?e=Number(e):"Boolean"==t.type&&(e=Boolean(e)),i[o]=e,s.parentNode&&s.parentNode.removeChild(s),i.setDirtyCanvas(!0,!0))}s.addEventListener("mouseleave",function(e){LiteGraph$2.dialog_close_on_mouse_leave&&!s.is_modified&&LiteGraph$2.dialog_close_on_mouse_leave&&(g=setTimeout(s.close,LiteGraph$2.dialog_close_on_mouse_leave_delay))}),s.addEventListener("mouseenter",function(e){LiteGraph$2.dialog_close_on_mouse_leave&&g&&clearTimeout(g)})},LGraphCanvas.prototype.prompt=function(e,t,n,r,i){let o=this,a=(e=e||"",document.createElement("div"));a.is_modified=!1,a.className="graphdialog rounded",a.innerHTML=i?"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>":"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>",a.close=function(){o.prompt_box=null,a.parentNode&&a.parentNode.removeChild(a)};let s=LGraphCanvas.active_canvas.canvas,l=(s.parentNode.appendChild(a),1<this.ds.scale&&(a.style.transform="scale("+this.ds.scale+")"),null),h=!1,p=(LiteGraph$2.pointerListenerAdd(a,"leave",function(e){h||LiteGraph$2.dialog_close_on_mouse_leave&&!a.is_modified&&LiteGraph$2.dialog_close_on_mouse_leave&&(l=setTimeout(a.close,LiteGraph$2.dialog_close_on_mouse_leave_delay))}),LiteGraph$2.pointerListenerAdd(a,"enter",function(e){LiteGraph$2.dialog_close_on_mouse_leave&&l&&clearTimeout(l)}),a.querySelectorAll("select")),u=(p&&p.forEach(function(e){e.addEventListener("click",function(e){h++}),e.addEventListener("blur",function(e){h=0}),e.addEventListener("change",function(e){h=-1})}),o.prompt_box&&o.prompt_box.close(),(o.prompt_box=a).querySelector(".name")),c=(u.innerText=e,a.querySelector(".value")),d=(c.value=t,c),g=(d.addEventListener("keydown",function(e){if(a.is_modified=!0,27!=e.keyCode){if(13!=e.keyCode||"textarea"==e.target.localName)return;n&&n(this.value)}a.close(),e.preventDefault(),e.stopPropagation()}),a.querySelector("button"));g.addEventListener("click",function(e){n&&n(d.value),o.setDirty(!0),a.close()});i=s.getBoundingClientRect();let f=-20,_=-20;return i&&(f-=i.left,_-=i.top),r?(a.style.left=r.clientX+f+"px",a.style.top=r.clientY+_+"px"):(a.style.left=.5*s.width+f+"px",a.style.top=.5*s.height+_+"px"),setTimeout(function(){d.focus()},10),a},LGraphCanvas.search_limit=-1,LGraphCanvas.prototype.showSearchBox=function(a,p){var e={slot_from:null,node_from:null,node_to:null,do_type_filter:LiteGraph$2.search_filter_enabled,type_filter_in:!1,type_filter_out:!1,show_general_if_none_on_typefilter:!0,show_general_after_typefiltered:!0,hide_on_mouse_leave:LiteGraph$2.search_hide_on_mouse_leave,show_all_if_empty:!0,show_all_on_open:LiteGraph$2.search_show_all_on_open};p=Object.assign(e,p||{});let u=this,c=LGraphCanvas.active_canvas,t=c.canvas,n=t.ownerDocument||document,s=document.createElement("div");if(s.className="litegraph litesearchbox graphdialog",s.innerHTML="<span class='name'>Search</span><input autofocus type='text' class='value'/>",p.do_type_filter&&(s.innerHTML+=`
    <select class='slot_in_type_filter'><option value=''></option></select>
    <select class='slot_out_type_filter'><option value=''></option></select>`),s.innerHTML+="<div class='helper'></div>",n.fullscreenElement?n.fullscreenElement.appendChild(s):(n.body.appendChild(s),n.body.style.overflow="hidden"),p.do_type_filter&&(selIn=s.querySelector(".slot_in_type_filter"),selOut=s.querySelector(".slot_out_type_filter")),s.close=function(){u.search_box=null,this.blur(),t.focus(),n.body.style.overflow="",setTimeout(function(){u.canvas.focus()},20),s.parentNode&&s.parentNode.removeChild(s)},p.hide_on_mouse_leave){let t=!1,n=null;LiteGraph$2.pointerListenerAdd(s,"enter",function(e){n&&(clearTimeout(n),n=null)}),LiteGraph$2.pointerListenerAdd(s,"leave",function(e){t||(n=setTimeout(function(){s.close()},500))}),p.do_type_filter&&(selIn.addEventListener("click",function(e){t++}),selIn.addEventListener("blur",function(e){t=0}),selIn.addEventListener("change",function(e){t=-1}),selOut.addEventListener("click",function(e){t++}),selOut.addEventListener("blur",function(e){t=0}),selOut.addEventListener("change",function(e){t=-1}))}u.search_box&&u.search_box.close();let d=(u.search_box=s).querySelector(".helper"),r=null,g=null,i=null,f=s.querySelector("input");if(f&&(f.addEventListener("blur",function(e){this.focus()}),f.addEventListener("keydown",function(e){if(38==e.keyCode)m(!1);else if(40==e.keyCode)m(!0);else if(27==e.keyCode)s.close();else{if(13!=e.keyCode)return g&&clearInterval(g),void(g=setTimeout(L,250));i?b(i.innerHTML):r?b(r):s.close()}return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!0})),p.do_type_filter){if(selIn){var o=LiteGraph$2.slot_types_in,l=o.length;p.type_filter_in!=LiteGraph$2.EVENT&&p.type_filter_in!=LiteGraph$2.ACTION||(p.type_filter_in="_event_");for(let t=0;t<l;t++){let e=document.createElement("option");e.value=o[t],e.innerHTML=o[t],selIn.appendChild(e),!1!==p.type_filter_in&&(p.type_filter_in+"").toLowerCase()==(o[t]+"").toLowerCase()&&(e.selected=!0)}selIn.addEventListener("change",function(){L()})}if(selOut){var h=LiteGraph$2.slot_types_out,_=h.length;p.type_filter_out!=LiteGraph$2.EVENT&&p.type_filter_out!=LiteGraph$2.ACTION||(p.type_filter_out="_event_");for(let t=0;t<_;t++){let e=document.createElement("option");e.value=h[t],e.innerHTML=h[t],selOut.appendChild(e),!1!==p.type_filter_out&&(p.type_filter_out+"").toLowerCase()==(h[t]+"").toLowerCase()&&(e.selected=!0)}selOut.addEventListener("change",function(){L()})}}var e=t.getBoundingClientRect(),y=(a?a.clientX:e.left+.5*e.width)-80,v=(a?a.clientY:e.top+.5*e.height)-20;function b(e){if(e)if(u.onSearchBoxSelection)u.onSearchBoxSelection(e,a,c);else{var n=LiteGraph$2.searchbox_extras[e.toLowerCase()];n&&(e=n.type),c.graph.beforeChange();let t=LiteGraph$2.createNode(e);if(t&&(t.pos=c.convertEventToCanvasOffset(a),c.graph.add(t,!1)),n&&n.data){if(n.data.properties)for(var r in n.data.properties)t.addProperty(r,n.data.properties[r]);if(n.data.inputs)for(var i in t.inputs=[],n.data.inputs)t.addOutput(n.data.inputs[i][0],n.data.inputs[i][1]);if(n.data.outputs)for(var o in t.outputs=[],n.data.outputs)t.addOutput(n.data.outputs[o][0],n.data.outputs[o][1]);n.data.title&&(t.title=n.data.title),n.data.json&&t.configure(n.data.json)}if(p.node_from){let e=!1;switch(typeof p.slot_from){case"string":e=p.node_from.findOutputSlot(p.slot_from);break;case"object":-1==(e=p.slot_from.name?p.node_from.findOutputSlot(p.slot_from.name):-1)&&void 0!==p.slot_from.slot_index&&(e=p.slot_from.slot_index);break;case"number":e=p.slot_from;break;default:e=0}p.node_from.outputs[e],!1!==e&&-1<e&&p.node_from.connectByType(e,t,p.node_from.outputs[e].type)}if(p.node_to){let e=!1;switch(typeof p.slot_from){case"string":e=p.node_to.findInputSlot(p.slot_from);break;case"object":-1==(e=p.slot_from.name?p.node_to.findInputSlot(p.slot_from.name):-1)&&void 0!==p.slot_from.slot_index&&(e=p.slot_from.slot_index);break;case"number":e=p.slot_from;break;default:e=0}p.node_to.inputs[e],!1!==e&&-1<e&&p.node_to.connectByTypeOutput(e,t,p.node_to.inputs[e].type)}c.graph.afterChange()}s.close()}function m(e){var t=i;i&&i.classList.remove("selected"),(i=i?(i=e?i.nextSibling:i.previousSibling)||t:e?d.childNodes[0]:d.childNodes[d.childNodes.length])&&(i.classList.add("selected"),i.scrollIntoView({block:"end",behavior:"smooth"}))}function L(){g=null;let i=f.value;if(r=null,d.innerHTML="",i||p.show_all_if_empty)if(u.onSearchBox){var t=u.onSearchBox(d,i,c);if(t)for(let e=0;e<t.length;++e)h(t[e])}else{let t=0,r=(i=i.toLowerCase(),c.filter||c.graph.filter);for(var o in sOut=p.do_type_filter&&u.search_box?(sIn=u.search_box.querySelector(".slot_in_type_filter"),u.search_box.querySelector(".slot_out_type_filter")):sIn=!1,LiteGraph$2.searchbox_extras){let e=LiteGraph$2.searchbox_extras[o];if(p.show_all_if_empty&&!i||-1!==e.desc.toLowerCase().indexOf(i)){o=LiteGraph$2.registered_node_types[e.type];if((!o||o.filter==r)&&l(e.type)&&(h(e.desc,"searchbox_extra"),-1!==LGraphCanvas.search_limit&&t++>LGraphCanvas.search_limit))break}}let n=null;if(Array.prototype.filter){let e=Object.keys(LiteGraph$2.registered_node_types);n=e.filter(l)}else for(var e in n=[],LiteGraph$2.registered_node_types)l(e)&&n.push(e);for(let e=0;e<n.length&&(h(n[e]),!(-1!==LGraphCanvas.search_limit&&t++>LGraphCanvas.search_limit));e++);if(p.show_general_after_typefiltered&&(sIn.value||sOut.value)){for(var a in filtered_extra=[],LiteGraph$2.registered_node_types)l(a,{inTypeOverride:!(!sIn||!sIn.value)&&"*",outTypeOverride:!(!sOut||!sOut.value)&&"*"})&&filtered_extra.push(a);for(let e=0;e<filtered_extra.length&&(h(filtered_extra[e],"generic_type"),!(-1!==LGraphCanvas.search_limit&&t++>LGraphCanvas.search_limit));e++);}if((sIn.value||sOut.value)&&0==d.childNodes.length&&p.show_general_if_none_on_typefilter){for(var s in filtered_extra=[],LiteGraph$2.registered_node_types)l(s,{skipFilter:!0})&&filtered_extra.push(s);for(let e=0;e<filtered_extra.length&&(h(filtered_extra[e],"not_in_filter"),!(-1!==LGraphCanvas.search_limit&&t++>LGraphCanvas.search_limit));e++);}function l(e,t){t=t||{};var t=Object.assign({skipFilter:!1,inTypeOverride:!1,outTypeOverride:!1},t),n=LiteGraph$2.registered_node_types[e];if(r&&n.filter!=r)return!1;if((!p.show_all_if_empty||i)&&-1===e.toLowerCase().indexOf(i))return!1;if(p.do_type_filter&&!t.skipFilter){n=e;if(sV=sIn.value,!1!==t.inTypeOverride&&(sV=t.inTypeOverride),sIn&&sV&&LiteGraph$2.registered_slot_in_types[sV]&&LiteGraph$2.registered_slot_in_types[sV].nodes){e=LiteGraph$2.registered_slot_in_types[sV].nodes.includes(n);if(!1===e)return!1}if(sV=sOut.value,!1!==t.outTypeOverride&&(sV=t.outTypeOverride),sOut&&sV&&LiteGraph$2.registered_slot_out_types[sV]&&LiteGraph$2.registered_slot_out_types[sV].nodes){e=LiteGraph$2.registered_slot_out_types[sV].nodes.includes(n);if(!1===e)return!1}}return!0}}function h(e,t){let n=document.createElement("div");r=r||e,n.innerText=e,n.dataset.type=escape(e),n.className="litegraph lite-search-item",t&&(n.className+=" "+t),n.addEventListener("click",function(e){b(unescape(this.dataset.type))}),d.appendChild(n)}}return s.style.left=y+"px",s.style.top=v+"px",a.layerY>e.height-200&&(d.style.maxHeight=e.height-a.layerY-20+"px"),f.focus(),p.show_all_on_open&&L(),s},LGraphCanvas.prototype.showEditPropertyValue=function(a,s,l){if(a&&void 0!==a.properties[s]){l=l||{};let t=a.getPropertyInfo(s),n=t.type,r="";if("string"==n||"number"==n||"array"==n||"object"==n)r="<input autofocus type='text' class='value'/>";else if("enum"!=n&&"combo"!=n||!t.values){if("boolean"!=n&&"toggle"!=n)return void console.warn("unknown type: "+n);r="<input autofocus type='checkbox' class='value' "+(a.properties[s]?"checked":"")+"/>"}else{for(var h in r="<select autofocus type='text' class='value'>",t.values){let e=h;t.values.constructor===Array&&(e=t.values[h]),r+="<option value='"+e+"' "+(e==a.properties[s]?"selected":"")+">"+t.values[h]+"</option>"}r+="</select>"}let i=this.createDialog("<span class='name'>"+(t.label||s)+"</span>"+r+"<button>OK</button>",l),o=!1;if("enum"!=n&&"combo"!=n||!t.values){if("boolean"==n||"toggle"==n)(o=i.querySelector("input"))&&o.addEventListener("click",function(e){i.modified(),u(!!o.checked)});else if(o=i.querySelector("input")){o.addEventListener("blur",function(e){this.focus()});let e=void 0!==a.properties[s]?a.properties[s]:"";"string"!==n&&(e=JSON.stringify(e)),o.value=e,o.addEventListener("keydown",function(e){if(27==e.keyCode)i.close();else if(13==e.keyCode)p();else if(13!=e.keyCode)return void i.modified();e.preventDefault(),e.stopPropagation()})}}else(o=i.querySelector("select")).addEventListener("change",function(e){i.modified(),u(e.target.value)});o&&o.focus();let e=i.querySelector("button");return e.addEventListener("click",p),i;function p(){u(o.value)}function u(e){t&&t.values&&t.values.constructor===Object&&null!=t.values[e]&&(e=t.values[e]),"number"==typeof a.properties[s]&&(e=Number(e)),"array"!=n&&"object"!=n||(e=JSON.parse(e)),a.properties[s]=e,a.graph&&a.graph._version++,a.onPropertyChanged&&a.onPropertyChanged(s,e),l.onclose&&l.onclose(),i.close(),a.setDirtyCanvas(!0,!0)}}},LGraphCanvas.prototype.createDialog=function(e,t){def_options={checkForInput:!1,closeOnLeave:!0,closeOnLeave_checkModified:!0},t=Object.assign(def_options,t||{});let n=document.createElement("div");n.className="graphdialog",n.innerHTML=e,n.is_modified=!1;e=this.canvas.getBoundingClientRect();let r=-20,i=-20;if(e&&(r-=e.left,i-=e.top),t.position?(r+=t.position[0],i+=t.position[1]):t.event?(r+=t.event.clientX,i+=t.event.clientY):(r+=.5*this.canvas.width,i+=.5*this.canvas.height),n.style.left=r+"px",n.style.top=i+"px",this.canvas.parentNode.appendChild(n),t.checkForInput){let e=[];(e=n.querySelectorAll("input"))&&e.forEach(function(e){e.addEventListener("keydown",function(e){if(n.modified(),27==e.keyCode)n.close();else if(13!=e.keyCode)return;e.preventDefault(),e.stopPropagation()}),e.focus()})}n.modified=function(){n.is_modified=!0},n.close=function(){n.parentNode&&n.parentNode.removeChild(n)};let o=null,a=!1,s=(n.addEventListener("mouseleave",function(e){a||(t.closeOnLeave||LiteGraph$2.dialog_close_on_mouse_leave)&&!n.is_modified&&LiteGraph$2.dialog_close_on_mouse_leave&&(o=setTimeout(n.close,LiteGraph$2.dialog_close_on_mouse_leave_delay))}),n.addEventListener("mouseenter",function(e){(t.closeOnLeave||LiteGraph$2.dialog_close_on_mouse_leave)&&o&&clearTimeout(o)}),n.querySelectorAll("select"));return s&&s.forEach(function(e){e.addEventListener("click",function(e){a++}),e.addEventListener("blur",function(e){a=0}),e.addEventListener("change",function(e){a=-1})}),n},LGraphCanvas.prototype.createPanel=function(e,t){let h=(t=t||{}).window||window,p=document.createElement("div");if(p.className="litegraph dialog",p.innerHTML="<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div style='display:none;' class='dialog-alt-content'></div><div class='dialog-footer'></div>",p.header=p.querySelector(".dialog-header"),t.width&&(p.style.width=t.width+(t.width.constructor===Number?"px":"")),t.height&&(p.style.height=t.height+(t.height.constructor===Number?"px":"")),t.closable){let e=document.createElement("span");e.innerHTML="&#10005;",e.classList.add("close"),e.addEventListener("click",function(){p.close()}),p.header.appendChild(e)}return p.title_element=p.querySelector(".dialog-title"),p.title_element.innerText=e,p.content=p.querySelector(".dialog-content"),p.alt_content=p.querySelector(".dialog-alt-content"),p.footer=p.querySelector(".dialog-footer"),p.close=function(){p.onClose&&"function"==typeof p.onClose&&p.onClose(),p.parentNode.removeChild(p),this.parentNode&&this.parentNode.removeChild(this)},p.toggleAltContent=function(e){void 0===e&&(p.alt_content.style.display,p.alt_content.style.display),p.alt_content.style.display=vTo,p.content.style.display=vAlt},p.toggleFooterVisibility=function(e){void 0===e&&p.footer.style.display,p.footer.style.display=vTo},p.clear=function(){this.content.innerHTML=""},p.addHTML=function(e,t,n){let r=document.createElement("div");return t&&(r.className=t),r.innerHTML=e,(n?p.footer:p.content).appendChild(r),r},p.addButton=function(e,t,n){let r=document.createElement("button");return r.innerText=e,r.options=n,r.classList.add("btn"),r.addEventListener("click",t),p.footer.appendChild(r),r},p.addSeparator=function(){let e=document.createElement("div");e.className="separator",p.content.appendChild(e)},p.addWidget=function(t,e,n,o,r){o=o||{};let i=String(n),a=("number"==(t=t.toLowerCase())&&(i=n.toFixed(3)),document.createElement("div")),s=(a.className="property",a.innerHTML="<span class='property_name'></span><span class='property_value'></span>",a.querySelector(".property_name").innerText=o.label||e,a.querySelector(".property_value"));function l(e,t){o.callback&&o.callback(e,t,o),r&&r(e,t,o)}return s.innerText=i,a.dataset.property=e,a.dataset.type=o.type||t,a.options=o,a.value=n,"code"==t?a.addEventListener("click",function(e){p.inner_showCodePad(this.dataset.property)}):"boolean"==t?(a.classList.add("boolean"),n&&a.classList.add("bool-on"),a.addEventListener("click",function(){var e=this.dataset.property;this.value=!this.value,this.classList.toggle("bool-on"),this.querySelector(".property_value").innerText=this.value?"true":"false",l(e,this.value)})):"string"==t||"number"==t?(s.setAttribute("contenteditable",!0),s.addEventListener("keydown",function(e){"Enter"!=e.code||"string"==t&&e.shiftKey||(e.preventDefault(),this.blur())}),s.addEventListener("blur",function(){let e=this.innerText;var t=this.parentNode.dataset.property,n=this.parentNode.dataset.type;l(t,e="number"==n?Number(e):e)})):"enum"!=t&&"combo"!=t||(e=LGraphCanvas.getPropertyPrintableValue(n,o.values),s.innerText=e,s.addEventListener("click",function(e){var t=o.values||[];let r=this.parentNode.dataset.property,i=this;new LiteGraph$2.ContextMenu(t,{event:e,className:"dark",callback:function(e,t,n){return i.innerText=e,l(r,e),!1}},h)})),p.content.appendChild(a),a},p.onOpen&&"function"==typeof p.onOpen&&p.onOpen(),p},LGraphCanvas.getPropertyPrintableValue=function(t,n){if(!n)return String(t);if(n.constructor===Array)return String(t);if(n.constructor===Object){let e="";for(var r in n)if(n[r]==t){e=r;break}return String(t)+" ("+e+")"}},LGraphCanvas.prototype.closePanels=function(){let e=document.querySelector("#node-panel");e&&e.close(),(e=document.querySelector("#option-panel"))&&e.close()},LGraphCanvas.prototype.showShowGraphOptionsPanel=function(e,t,n,r){if(this.constructor&&"HTMLDivElement"==this.constructor.name){if(!(t&&t.event&&t.event.target&&t.event.target.lgraphcanvas))return void console.warn("Canvas not found");t.event.target.lgraphcanvas}graphcanvas.closePanels();t=graphcanvas.getCanvasWindow();panel=graphcanvas.createPanel("Options",{closable:!0,window:t,onOpen:function(){graphcanvas.OPTIONPANEL_IS_OPEN=!0},onClose:function(){graphcanvas.OPTIONPANEL_IS_OPEN=!1,graphcanvas.options_panel=null}}),(graphcanvas.options_panel=panel).id="option-panel",panel.classList.add("settings");{function i(e,t,n){n&&n.key&&(e=n.key),n.values&&(t=Object.values(n.values).indexOf(t)),graphcanvas[e]=t}panel.content.innerHTML="";let e=LiteGraph$2.availableCanvasOptions;for(pI in e.sort(),e){var o=e[pI];panel.addWidget("boolean",o,graphcanvas[o],{key:o,on:"True",off:"False"},i)}graphcanvas.links_render_mode,panel.addWidget("combo","Render mode",LiteGraph$2.LINK_RENDER_MODES[graphcanvas.links_render_mode],{key:"links_render_mode",values:LiteGraph$2.LINK_RENDER_MODES},i),panel.addSeparator(),panel.footer.innerHTML=""}graphcanvas.canvas.parentNode.appendChild(panel)},LGraphCanvas.prototype.showShowNodePanel=function(o){this.SELECTED_NODE=o,this.closePanels();var e=this.getCanvasWindow();let a=this,s=this.createPanel(o.title||"",{closable:!0,window:e,onOpen:function(){a.NODEPANEL_IS_OPEN=!0},onClose:function(){a.NODEPANEL_IS_OPEN=!1,a.node_panel=null}});function l(){s.content.innerHTML="",s.addHTML("<span class='node_type'>"+o.type+"</span><span class='node_desc'>"+(o.constructor.desc||"")+"</span><span class='separator'></span>"),s.addHTML("<h3>Properties</h3>");function e(e,t){switch(a.graph.beforeChange(o),e){case"Title":o.title=t;break;case"Mode":var n=Object.values(LiteGraph$2.NODE_MODES).indexOf(t);0<=n&&LiteGraph$2.NODE_MODES[n]?o.changeMode(n):console.warn("unexpected mode: "+t);break;case"Color":LGraphCanvas.node_colors[t]?(o.color=LGraphCanvas.node_colors[t].color,o.bgcolor=LGraphCanvas.node_colors[t].bgcolor):console.warn("unexpected color: "+t);break;default:o.setProperty(e,t)}a.graph.afterChange(),a.dirty_canvas=!0}s.addWidget("string","Title",o.title,{},e),s.addWidget("combo","Mode",LiteGraph$2.NODE_MODES[o.mode],{values:LiteGraph$2.NODE_MODES},e);let t="";for(var n in void 0!==o.color&&(t=Object.keys(LGraphCanvas.node_colors).filter(function(e){return LGraphCanvas.node_colors[e].color==o.color})),s.addWidget("combo","Color",t,{values:Object.keys(LGraphCanvas.node_colors)},e),o.properties){var r=o.properties[n],i=o.getPropertyInfo(n);i.type,o.onAddPropertyToPanel&&o.onAddPropertyToPanel(n,s)||s.addWidget(i.widget||i.type,n,r,i,e)}s.addSeparator(),o.onShowCustomPanelInfo&&o.onShowCustomPanelInfo(s),s.footer.innerHTML="",s.addButton("Delete",function(){o.block_delete||(o.graph.remove(o),s.close())}).classList.add("delete")}(a.node_panel=s).id="node-panel",s.node=o,s.classList.add("settings"),s.inner_showCodePad=function(t){s.classList.remove("settings"),s.classList.add("centered"),s.alt_content.innerHTML="<textarea class='code'></textarea>";function n(){s.toggleAltContent(!1),s.toggleFooterVisibility(!0),r.parentNode.removeChild(r),s.classList.add("settings"),s.classList.remove("centered"),l()}let r=s.alt_content.querySelector("textarea");r.value=o.properties[t],r.addEventListener("keydown",function(e){"Enter"==e.code&&e.ctrlKey&&(o.setProperty(t,r.value),n())}),s.toggleAltContent(!0),s.toggleFooterVisibility(!1),r.style.height="calc(100% - 40px)";var e=s.addButton("Assign",function(){o.setProperty(t,r.value),n()});s.alt_content.appendChild(e);let i=s.addButton("Close",n);i.style.float="right",s.alt_content.appendChild(i)},l(),this.canvas.parentNode.appendChild(s)},LGraphCanvas.prototype.showSubgraphPropertiesDialog=function(i){console.log("showing subgraph properties dialog");let e=this.canvas.parentNode.querySelector(".subgraph_dialog"),r=(e&&e.close(),this.createPanel("Subgraph Inputs",{closable:!0,width:500}));function o(){if(r.clear(),i.inputs)for(let t=0;t<i.inputs.length;++t){var n=i.inputs[t];if(!n.not_subgraph_input){let e=r.addHTML("<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>","subgraph_property");e.dataset.name=n.name,e.dataset.slot=t,e.querySelector(".name").innerText=n.name,e.querySelector(".type").innerText=n.type,e.querySelector("button").addEventListener("click",function(e){i.removeInput(Number(this.parentNode.dataset.slot)),o()})}}}r.node=i,r.classList.add("subgraph_dialog");let t=r.addHTML(" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>","subgraph_property extra",!0);return t.querySelector("button").addEventListener("click",function(e){let t=this.parentNode;var n=t.querySelector(".name").value,r=t.querySelector(".type").value;n&&-1==i.findInputSlot(n)&&(i.addInput(n,r),t.querySelector(".name").value="",t.querySelector(".type").value="",o())}),o(),this.canvas.parentNode.appendChild(r),r},LGraphCanvas.prototype.showSubgraphPropertiesDialogRight=function(r){let e=this.canvas.parentNode.querySelector(".subgraph_dialog"),i=(e&&e.close(),this.createPanel("Subgraph Outputs",{closable:!0,width:500}));function o(){if(i.clear(),r.outputs)for(let t=0;t<r.outputs.length;++t){var n=r.outputs[t];if(!n.not_subgraph_output){let e=i.addHTML("<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>","subgraph_property");e.dataset.name=n.name,e.dataset.slot=t,e.querySelector(".name").innerText=n.name,e.querySelector(".type").innerText=n.type,e.querySelector("button").addEventListener("click",function(e){r.removeOutput(Number(this.parentNode.dataset.slot)),o()})}}}i.node=r,i.classList.add("subgraph_dialog");let t=i.addHTML(" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>","subgraph_property extra",!0);function n(){let e=this.parentNode;var t=e.querySelector(".name").value,n=e.querySelector(".type").value;t&&-1==r.findOutputSlot(t)&&(r.addOutput(t,n),e.querySelector(".name").value="",e.querySelector(".type").value="",o())}return t.querySelector(".name").addEventListener("keydown",function(e){13==e.keyCode&&n.apply(this)}),t.querySelector("button").addEventListener("click",function(e){n.apply(this)}),o(),this.canvas.parentNode.appendChild(i),i},LGraphCanvas.prototype.checkPanels=function(){if(this.canvas){var n=this.canvas.parentNode.querySelectorAll(".litegraph.dialog");for(let t=0;t<n.length;++t){let e=n[t];!e.node||e.node.graph&&e.graph==this.graph||e.close()}}},LGraphCanvas.onMenuNodeCollapse=function(e,t,n,r,i){i.graph.beforeChange();function o(e){e.collapse()}var a=LGraphCanvas.active_canvas;if(!a.selected_nodes||Object.keys(a.selected_nodes).length<=1)o(i);else for(var s in a.selected_nodes)o(a.selected_nodes[s]);i.graph.afterChange()},LGraphCanvas.onMenuNodePin=function(e,t,n,r,i){i.pin()},LGraphCanvas.onMenuNodeMode=function(e,t,n,r,o){return new LiteGraph$2.ContextMenu(LiteGraph$2.NODE_MODES,{event:n,callback:function(n){if(o){let t=Object.values(LiteGraph$2.NODE_MODES).indexOf(n);function e(e){0<=t&&LiteGraph$2.NODE_MODES[t]?e.changeMode(t):(console.warn("unexpected mode: "+n),e.changeMode(LiteGraph$2.ALWAYS))}var r=LGraphCanvas.active_canvas;if(!r.selected_nodes||Object.keys(r.selected_nodes).length<=1)e(o);else for(var i in r.selected_nodes)e(r.selected_nodes[i])}},parentMenu:r,node:o}),!1},LGraphCanvas.onMenuNodeColors=function(e,t,n,r,o){if(!o)throw"no node for color";let i=[];for(var a in i.push({value:null,content:"<span style='display: block; padding-left: 4px;'>No color</span>"}),LGraphCanvas.node_colors){var s=LGraphCanvas.node_colors[a],s={value:a,content:"<span style='display: block; color: #999; padding-left: 4px; border-left: 8px solid "+s.color+"; background-color:"+s.bgcolor+"'>"+a+"</span>"};i.push(s)}return new LiteGraph$2.ContextMenu(i,{event:n,callback:function(e){if(o){let t=e.value?LGraphCanvas.node_colors[e.value]:null;function n(e){t?e.constructor===LiteGraph$2.LGraphGroup?e.color=t.groupcolor:(e.color=t.color,e.bgcolor=t.bgcolor):(delete e.color,delete e.bgcolor)}var r=LGraphCanvas.active_canvas;if(!r.selected_nodes||Object.keys(r.selected_nodes).length<=1)n(o);else for(var i in r.selected_nodes)n(r.selected_nodes[i]);o.setDirtyCanvas(!0,!0)}},parentMenu:r,node:o}),!1},LGraphCanvas.onMenuNodeShapes=function(e,t,n,r,i){if(i)return new LiteGraph$2.ContextMenu(LiteGraph$2.VALID_SHAPES,{event:n,callback:function(t){if(i){i.graph.beforeChange();function e(e){e.shape=t}var n=LGraphCanvas.active_canvas;if(!n.selected_nodes||Object.keys(n.selected_nodes).length<=1)e(i);else for(var r in n.selected_nodes)e(n.selected_nodes[r]);i.graph.afterChange(),i.setDirtyCanvas(!0)}},parentMenu:r,node:i}),!1;throw"no node passed"},LGraphCanvas.onMenuNodeRemove=function(e,t,n,r,i){if(!i)throw"no node passed";let o=i.graph;o.beforeChange();function a(e){!1!==e.removable&&o.remove(e)}var s=LGraphCanvas.active_canvas;if(!s.selected_nodes||Object.keys(s.selected_nodes).length<=1)a(i);else for(var l in s.selected_nodes)a(s.selected_nodes[l]);o.afterChange(),i.setDirtyCanvas(!0,!0)},LGraphCanvas.onMenuNodeToSubgraph=function(e,t,n,r,i){let o=i.graph,a=LGraphCanvas.active_canvas;if(a){let e=Object.values(a.selected_nodes||{}),t=(e.length||(e=[i]),LiteGraph$2.createNode("graph/subgraph"));t.pos=i.pos.concat(),o.add(t),t.buildFromNodes(e),a.deselectAllNodes(),i.setDirtyCanvas(!0,!0)}},LGraphCanvas.onMenuNodeClone=function(e,t,n,r,i){i.graph.beforeChange();let o={};function a(t){if(0!=t.clonable){let e=t.clone();e&&(e.pos=[t.pos[0]+5,t.pos[1]+5],t.graph.add(e),o[e.id]=e)}}let s=LGraphCanvas.active_canvas;if(!s.selected_nodes||Object.keys(s.selected_nodes).length<=1)a(i);else for(var l in s.selected_nodes)a(s.selected_nodes[l]);Object.keys(o).length&&s.selectNodes(o),i.graph.afterChange(),i.setDirtyCanvas(!0,!0)},LGraphCanvas.node_colors={red:{color:"#322",bgcolor:"#533",groupcolor:"#A88"},brown:{color:"#332922",bgcolor:"#593930",groupcolor:"#b06634"},green:{color:"#232",bgcolor:"#353",groupcolor:"#8A8"},blue:{color:"#223",bgcolor:"#335",groupcolor:"#88A"},pale_blue:{color:"#2a363b",bgcolor:"#3f5159",groupcolor:"#3f789e"},cyan:{color:"#233",bgcolor:"#355",groupcolor:"#8AA"},purple:{color:"#323",bgcolor:"#535",groupcolor:"#a1309b"},yellow:{color:"#432",bgcolor:"#653",groupcolor:"#b58b2a"},black:{color:"#222",bgcolor:"#000",groupcolor:"#444"}},LGraphCanvas.prototype.getCanvasMenuOptions=function(){let e=null;var t;return this.getMenuOptions?e=this.getMenuOptions():(e=[{content:"Add Node",has_submenu:!0,callback:LGraphCanvas.onMenuAdd},{content:"Add Group",callback:LGraphCanvas.onGroupAdd}],this._graph_stack&&0<this._graph_stack.length&&e.push(null,{content:"Close subgraph",callback:this.closeSubgraph.bind(this)})),e=this.getExtraMenuOptions&&(t=this.getExtraMenuOptions(this,e))?e.concat(t):e},LGraphCanvas.prototype.getNodeMenuOptions=function(t){let n=null;var e;if(t.getMenuOptions?n=t.getMenuOptions(this):(!(n=[{content:"Inputs",has_submenu:!0,disabled:!0,callback:LGraphCanvas.showMenuNodeOptionalInputs},{content:"Outputs",has_submenu:!0,disabled:!0,callback:LGraphCanvas.showMenuNodeOptionalOutputs},null,{content:"Properties",has_submenu:!0,callback:LGraphCanvas.onShowMenuNodeProperties},null,{content:"Title",callback:LGraphCanvas.onShowPropertyEditor},{content:"Mode",has_submenu:!0,callback:LGraphCanvas.onMenuNodeMode}])!==t.resizable&&n.push({content:"Resize",callback:LGraphCanvas.onMenuResizeNode}),n.push({content:"Collapse",callback:LGraphCanvas.onMenuNodeCollapse},{content:"Pin",callback:LGraphCanvas.onMenuNodePin},{content:"Colors",has_submenu:!0,callback:LGraphCanvas.onMenuNodeColors},{content:"Shapes",has_submenu:!0,callback:LGraphCanvas.onMenuNodeShapes},null)),!t.onGetInputs||(e=t.onGetInputs())&&e.length&&(n[0].disabled=!1),!t.onGetOutputs||(e=t.onGetOutputs())&&e.length&&(n[1].disabled=!1),t.getExtraMenuOptions){let e=t.getExtraMenuOptions(this,n);e&&(e.push(null),n=e.concat(n))}return!1!==t.clonable&&n.push({content:"Clone",callback:LGraphCanvas.onMenuNodeClone}),n.push(null,{content:"Remove",disabled:!(!1!==t.removable&&!t.block_delete),callback:LGraphCanvas.onMenuNodeRemove}),t.graph&&t.graph.onGetNodeMenuOptions&&t.graph.onGetNodeMenuOptions(n,t),n},LGraphCanvas.prototype.getGroupMenuOptions=function(e){return[{content:"Title",callback:LGraphCanvas.onShowPropertyEditor},{content:"Color",has_submenu:!0,callback:LGraphCanvas.onMenuNodeColors},{content:"Font size",property:"font_size",type:"Number",callback:LGraphCanvas.onShowPropertyEditor},null,{content:"Remove",callback:LGraphCanvas.onMenuNodeRemove}]},LGraphCanvas.prototype.processContextMenu=function(s,e){let l=this,t=LGraphCanvas.active_canvas;var n,r=t.getCanvasWindow();let i=null,o={event:e,callback:function(i,o,e){if(i)if("Remove Slot"==i.content){var a=i.slot;s.graph.beforeChange(),a.input?s.removeInput(a.slot):a.output&&s.removeOutput(a.slot),s.graph.afterChange()}else if("Disconnect Links"==i.content){a=i.slot;s.graph.beforeChange(),a.output?s.disconnectOutput(a.slot):a.input&&s.disconnectInput(a.slot),s.graph.afterChange()}else if("Rename Slot"==i.content){a=i.slot;let e=a.input?s.getInputInfo(a.slot):s.getOutputInfo(a.slot),t=l.createDialog("<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>",o),n=t.querySelector("input"),r=(n&&e&&(n.value=e.label||""),function(){s.graph.beforeChange(),n.value&&(e&&(e.label=n.value),l.setDirty(!0)),t.close(),s.graph.afterChange()});t.querySelector("button").addEventListener("click",r),n.addEventListener("keydown",function(e){if(t.is_modified=!0,27==e.keyCode)t.close();else if(13==e.keyCode)r();else if(13!=e.keyCode&&"textarea"!=e.target.localName)return;e.preventDefault(),e.stopPropagation()}),n.focus()}},extra:s},a=(s&&(o.title=s.type),null);s&&(a=s.getSlotInPosition(e.canvasX,e.canvasY),LGraphCanvas.active_node=s),a?(i=[],s.getSlotMenuOptions?i=s.getSlotMenuOptions(a):(a&&a.output&&a.output.links&&a.output.links.length&&i.push({content:"Disconnect Links",slot:a}),(n=a.input||a.output).removable&&i.push(n.locked?"Cannot remove":{content:"Remove Slot",slot:a}),n.nameLocked||i.push({content:"Rename Slot",slot:a})),o.title=(a.input||a.output).type||"*",a.input&&a.input.type==LiteGraph$2.ACTION&&(o.title="Action"),a.output&&a.output.type==LiteGraph$2.EVENT&&(o.title="Event")):s?i=this.getNodeMenuOptions(s):(i=this.getCanvasMenuOptions(),(n=this.graph.getGroupOnPos(e.canvasX,e.canvasY))&&i.push(null,{content:"Edit Group",has_submenu:!0,submenu:{title:"Group",extra:n,options:this.getGroupMenuOptions(n)}})),i&&new LiteGraph$2.ContextMenu(i,o,r)},"undefined"!=typeof window&&window.CanvasRenderingContext2D&&!window.CanvasRenderingContext2D.prototype.roundRect&&(window.CanvasRenderingContext2D.prototype.roundRect=function(e,t,n,r,i,o){let a=0,s=0,l=0,h=0;if(0===i)this.rect(e,t,n,r);else{if(void 0===o&&(o=i),null!=i&&i.constructor===Array)if(1==i.length)a=s=l=h=i[0];else if(2==i.length)a=h=i[0],s=l=i[1];else{if(4!=i.length)return;a=i[0],s=i[1],l=i[2],h=i[3]}else a=i||0,s=i||0,l=o||0,h=o||0;this.moveTo(e+a,t),this.lineTo(e+n-s,t),this.quadraticCurveTo(e+n,t,e+n,t+s),this.lineTo(e+n,t+r-h),this.quadraticCurveTo(e+n,t+r,e+n-h,t+r),this.lineTo(e+h,t+r),this.quadraticCurveTo(e,t+r,e,t+r-l),this.lineTo(e,t+l),this.quadraticCurveTo(e,t,e+a,t)}}),LGraphGroup.prototype._ctor=function(e){this.title=e||"Group",this.font_size=24,this.color=LGraphCanvas.node_colors.pale_blue?LGraphCanvas.node_colors.pale_blue.groupcolor:"#AAA",this._bounding=new Float32Array([10,10,140,80]),this._pos=this._bounding.subarray(0,2),this._size=this._bounding.subarray(2,4),this._nodes=[],this.graph=null,Object.defineProperty(this,"pos",{set:function(e){!e||e.length<2||(this._pos[0]=e[0],this._pos[1]=e[1])},get:function(){return this._pos},enumerable:!0}),Object.defineProperty(this,"size",{set:function(e){!e||e.length<2||(this._size[0]=Math.max(140,e[0]),this._size[1]=Math.max(80,e[1]))},get:function(){return this._size},enumerable:!0})},LGraphGroup.prototype.configure=function(e){this.title=e.title,this._bounding.set(e.bounding),this.color=e.color,this.font=e.font},LGraphGroup.prototype.serialize=function(){var e=this._bounding;return{title:this.title,bounding:[Math.round(e[0]),Math.round(e[1]),Math.round(e[2]),Math.round(e[3])],color:this.color,font:this.font}},LGraphGroup.prototype.move=function(n,r,e){if(this._pos[0]+=n,this._pos[1]+=r,!e)for(let t=0;t<this._nodes.length;++t){let e=this._nodes[t];e.pos[0]+=n,e.pos[1]+=r}},LGraphGroup.prototype.recomputeInsideNodes=function(){this._nodes.length=0;var n=this.graph._nodes,r=new Float32Array(4);for(let t=0;t<n.length;++t){let e=n[t];e.getBounding(r),overlapBounding(this._bounding,r)&&this._nodes.push(e)}},LGraphGroup.prototype.isPointInside=LGraphNode.prototype.isPointInside,LGraphGroup.prototype.setDirtyCanvas=LGraphNode.prototype.setDirtyCanvas,LGraph.supported_types=["number","string","boolean"],LGraph.STATUS_STOPPED=1,LGraph.STATUS_RUNNING=2,LGraph.prototype.getSupportedTypes=function(){return this.supported_types||LGraph.supported_types},LGraph.prototype.clear=function(){if(this.stop(),this.status=LGraph.STATUS_STOPPED,this.last_node_id=0,this.last_link_id=0,this._version=-1,this._nodes)for(let t=0;t<this._nodes.length;++t){let e=this._nodes[t];e.onRemoved&&e.onRemoved()}this._nodes=[],this._nodes_by_id={},this._nodes_in_order=[],this._nodes_executable=null,this._groups=[],this.links={},this.iteration=0,this.config={},this.vars={},this.extra={},this.globaltime=0,this.runningtime=0,this.fixedtime=0,this.fixedtime_lapse=.01,this.elapsed_time=.01,this.last_update_time=0,this.starttime=0,this.catch_errors=!0,this.nodes_executing=[],this.nodes_actioning=[],this.nodes_executedAction=[],this.inputs={},this.outputs={},this.change(),this.sendActionToCanvas("clear")},LGraph.prototype.attachCanvas=function(e){if(e.constructor!=LGraphCanvas)throw"attachCanvas expects a LGraphCanvas instance";e.graph&&e.graph!=this&&e.graph.detachCanvas(e),(e.graph=this).list_of_graphcanvas||(this.list_of_graphcanvas=[]),this.list_of_graphcanvas.push(e)},LGraph.prototype.detachCanvas=function(e){var t;!this.list_of_graphcanvas||-1!=(t=this.list_of_graphcanvas.indexOf(e))&&(e.graph=null,this.list_of_graphcanvas.splice(t,1))},LGraph.prototype.start=function(e){if(this.status!=LGraph.STATUS_RUNNING){this.status=LGraph.STATUS_RUNNING,this.onPlayEvent&&this.onPlayEvent(),this.sendEventToAllNodes("onStart"),this.starttime=LiteGraph$2.getTime(),this.last_update_time=this.starttime;let t=this;0==(e=e||0)&&"undefined"!=typeof window&&window.requestAnimationFrame?(this.execution_timer_id=-1,function e(){-1==t.execution_timer_id&&(window.requestAnimationFrame(e),t.onBeforeStep&&t.onBeforeStep(),t.runStep(1,!t.catch_errors),t.onAfterStep&&t.onAfterStep())}()):this.execution_timer_id=setInterval(function(){t.onBeforeStep&&t.onBeforeStep(),t.runStep(1,!t.catch_errors),t.onAfterStep&&t.onAfterStep()},e)}},LGraph.prototype.stop=function(){this.status!=LGraph.STATUS_STOPPED&&(this.status=LGraph.STATUS_STOPPED,this.onStopEvent&&this.onStopEvent(),null!=this.execution_timer_id&&(-1!=this.execution_timer_id&&clearInterval(this.execution_timer_id),this.execution_timer_id=null),this.sendEventToAllNodes("onStop"))},LGraph.prototype.runStep=function(t,n,r){t=t||1;var i=LiteGraph$2.getTime(),o=(this.globaltime=.001*(i-this.starttime),this._nodes_executable||this._nodes);if(o){if(r=r||o.length,n){for(let e=0;e<t;e++){for(let t=0;t<r;++t){let e=o[t];e.mode==LiteGraph$2.ALWAYS&&e.onExecute&&e.doExecute()}this.fixedtime+=this.fixedtime_lapse,this.onExecuteStep&&this.onExecuteStep()}this.onAfterExecute&&this.onAfterExecute()}else try{for(let e=0;e<t;e++){for(let t=0;t<r;++t){let e=o[t];e.mode==LiteGraph$2.ALWAYS&&e.onExecute&&e.onExecute()}this.fixedtime+=this.fixedtime_lapse,this.onExecuteStep&&this.onExecuteStep()}this.onAfterExecute&&this.onAfterExecute(),this.errors_in_execution=!1}catch(e){if(this.errors_in_execution=!0,LiteGraph$2.throw_errors)throw e;LiteGraph$2.debug&&console.log("Error during execution: "+e),this.stop()}n=LiteGraph$2.getTime();let e=n-i;0==e&&(e=1),this.execution_time=.001*e,this.globaltime+=.001*e,this.iteration+=1,this.elapsed_time=.001*(n-this.last_update_time),this.last_update_time=n,this.nodes_executing=[],this.nodes_actioning=[],this.nodes_executedAction=[]}},LGraph.prototype.updateExecutionOrder=function(){this._nodes_in_order=this.computeExecutionOrder(!1),this._nodes_executable=[];for(let e=0;e<this._nodes_in_order.length;++e)this._nodes_in_order[e].onExecute&&this._nodes_executable.push(this._nodes_in_order[e])},LGraph.prototype.computeExecutionOrder=function(n,i){let t=[],o=[],a={},r={},s={};for(let e=0,t=this._nodes.length;e<t;++e){let r=this._nodes[e];if(!n||r.onExecute){let n=0;if((a[r.id]=r).inputs)for(let e=0,t=r.inputs.length;e<t;e++)r.inputs[e]&&null!=r.inputs[e].link&&(n+=1);0==n?(o.push(r),i&&(r._level=1)):(i&&(r._level=0),s[r.id]=n)}}for(;;){if(0==o.length)break;var l=o.shift();if(t.push(l),delete a[l.id],l.outputs)for(let e=0;e<l.outputs.length;e++){var h=l.outputs[e];if(null!=h&&null!=h.links&&0!=h.links.length)for(let e=0;e<h.links.length;e++){var p=h.links[e],p=this.links[p];if(p&&!r[p.id]){let e=this.getNodeById(p.target_id);null==e?r[p.id]=!0:(i&&(!e._level||e._level<=l._level)&&(e._level=l._level+1),r[p.id]=!0,--s[e.id],0==s[e.id]&&o.push(e))}}}}for(var e in a)t.push(a[e]);t.length!=this._nodes.length&&LiteGraph$2.debug&&console.warn("something went wrong, nodes missing");var u=t.length;for(let e=0;e<u;++e)t[e].order=e;t=t.sort(function(e,t){var n=e.constructor.priority||e.priority||0,r=t.constructor.priority||t.priority||0;return n==r?e.order-t.order:n-r});for(let e=0;e<u;++e)t[e].order=e;return t},LGraph.prototype.getAncestors=function(e){let n=[],r=[e],i={};for(;r.length;){let t=r.shift();if(t.inputs){i[t.id]||t==e||(i[t.id]=!0,n.push(t));for(let e=0;e<t.inputs.length;++e){var o=t.getInputNode(e);o&&-1==n.indexOf(o)&&r.push(o)}}}return n.sort(function(e,t){return e.order-t.order}),n},LGraph.prototype.arrange=function(i,o){i=i||100;var t=this.computeExecutionOrder(!1,!0);let n=[];for(let e=0;e<t.length;++e){var r=t[e],a=r._level||1;n[a]||(n[a]=[]),n[a].push(r)}let s=i;for(let e=0;e<n.length;++e){var l=n[e];if(l){let n=100,r=i+LiteGraph$2.NODE_TITLE_HEIGHT;for(let t=0;t<l.length;++t){let e=l[t];e.pos[0]=o==LiteGraph$2.VERTICAL_LAYOUT?r:s,e.pos[1]=o==LiteGraph$2.VERTICAL_LAYOUT?s:r,max_size_index=o==LiteGraph$2.VERTICAL_LAYOUT?1:0,e.size[max_size_index]>n&&(n=e.size[max_size_index]),node_size_index=o==LiteGraph$2.VERTICAL_LAYOUT?0:1,r+=e.size[node_size_index]+i+LiteGraph$2.NODE_TITLE_HEIGHT}s+=n+i}}this.setDirtyCanvas(!0,!0)},LGraph.prototype.getTime=function(){return this.globaltime},LGraph.prototype.getFixedTime=function(){return this.fixedtime},LGraph.prototype.getElapsedTime=function(){return this.elapsed_time},LGraph.prototype.sendEventToAllNodes=function(n,r,i){i=i||LiteGraph$2.ALWAYS;var o=this._nodes_in_order||this._nodes;if(o)for(let t=0,e=o.length;t<e;++t){let e=o[t];e.constructor===LiteGraph$2.Subgraph&&"onExecute"!=n?e.mode==i&&e.sendEventToAllNodes(n,r,i):e[n]&&e.mode==i&&(void 0===r?e[n]():r&&r.constructor===Array?e[n].apply(e,r):e[n](r))}},LGraph.prototype.sendActionToCanvas=function(n,r){if(this.list_of_graphcanvas)for(let t=0;t<this.list_of_graphcanvas.length;++t){let e=this.list_of_graphcanvas[t];e[n]&&e[n].apply(e,r)}},LGraph.prototype.add=function(e,t){if(e){if(e.constructor!==LGraphGroup){if(-1!=e.id&&null!=this._nodes_by_id[e.id]&&(console.warn("LiteGraph: there is already a node with this ID, changing it"),e.id=++this.last_node_id),this._nodes.length>=LiteGraph$2.MAX_NUMBER_OF_NODES)throw"LiteGraph: max number of nodes in a graph reached";return null==e.id||-1==e.id?e.id=++this.last_node_id:this.last_node_id<e.id&&(this.last_node_id=e.id),(e.graph=this)._version++,this._nodes.push(e),(this._nodes_by_id[e.id]=e).onAdded&&e.onAdded(this),this.config.align_to_grid&&e.alignToGrid(),t||this.updateExecutionOrder(),this.onNodeAdded&&this.onNodeAdded(e),this.setDirtyCanvas(!0),this.change(),e}this._groups.push(e),this.setDirtyCanvas(!0),this.change(),(e.graph=this)._version++}},LGraph.prototype.remove=function(n){if(n.constructor===LiteGraph$2.LGraphGroup)-1!=(e=this._groups.indexOf(n))&&this._groups.splice(e,1),n.graph=null,this._version++,this.setDirtyCanvas(!0,!0),this.change();else if(null!=this._nodes_by_id[n.id]&&!n.ignore_remove){if(this.beforeChange(),n.inputs)for(let e=0;e<n.inputs.length;e++)null!=n.inputs[e].link&&n.disconnectInput(e);if(n.outputs)for(let e=0;e<n.outputs.length;e++){var t=n.outputs[e];null!=t.links&&t.links.length&&n.disconnectOutput(e)}if(n.onRemoved&&n.onRemoved(),n.graph=null,this._version++,this.list_of_graphcanvas)for(let t=0;t<this.list_of_graphcanvas.length;++t){let e=this.list_of_graphcanvas[t];e.selected_nodes[n.id]&&delete e.selected_nodes[n.id],e.node_dragged==n&&(e.node_dragged=null)}var e=this._nodes.indexOf(n);-1!=e&&this._nodes.splice(e,1),delete this._nodes_by_id[n.id],this.onNodeRemoved&&this.onNodeRemoved(n),this.sendActionToCanvas("checkPanels"),this.setDirtyCanvas(!0,!0),this.afterChange(),this.change(),this.updateExecutionOrder()}},LGraph.prototype.getNodeById=function(e){return null==e?null:this._nodes_by_id[e]},LGraph.prototype.findNodesByClass=function(n,r){for(let e=(r=r||[]).length=0,t=this._nodes.length;e<t;++e)this._nodes[e].constructor===n&&r.push(this._nodes[e]);return r},LGraph.prototype.findNodesByType=function(n,r){n=n.toLowerCase();for(let e=(r=r||[]).length=0,t=this._nodes.length;e<t;++e)this._nodes[e].type.toLowerCase()==n&&r.push(this._nodes[e]);return r},LGraph.prototype.findNodeByTitle=function(n){for(let e=0,t=this._nodes.length;e<t;++e)if(this._nodes[e].title==n)return this._nodes[e];return null},LGraph.prototype.findNodesByTitle=function(n){let r=[];for(let e=0,t=this._nodes.length;e<t;++e)this._nodes[e].title==n&&r.push(this._nodes[e]);return r},LGraph.prototype.getNodeOnPos=function(n,r,i,o){for(let t=(i=i||this._nodes).length-1;0<=t;t--){let e=i[t];if(e.isPointInside(n,r,o))return e}return null},LGraph.prototype.getGroupOnPos=function(n,r){for(let t=this._groups.length-1;0<=t;t--){let e=this._groups[t];if(e.isPointInside(n,r,2,!0))return e}return null},LGraph.prototype.checkNodeTypes=function(){for(let n=0;n<this._nodes.length;n++){let t=this._nodes[n];var e=LiteGraph$2.registered_node_types[t.type];if(t.constructor!=e){console.log("node being replaced by newer version: "+t.type);let e=LiteGraph$2.createNode(t.type);(this._nodes[n]=e).configure(t.serialize()),(e.graph=this)._nodes_by_id[e.id]=e,t.inputs&&(e.inputs=t.inputs.concat()),t.outputs&&(e.outputs=t.outputs.concat())}}this.updateExecutionOrder()},LGraph.prototype.onAction=function(n,r,i){this._input_nodes=this.findNodesByClass(LiteGraph$2.GraphInput,this._input_nodes);for(let t=0;t<this._input_nodes.length;++t){let e=this._input_nodes[t];if(e.properties.name==n){e.actionDo(n,r,i);break}}},LGraph.prototype.trigger=function(e,t){this.onTrigger&&this.onTrigger(e,t)},LGraph.prototype.addInput=function(e,t,n){this.inputs[e]||(this.beforeChange(),this.inputs[e]={name:e,type:t,value:n},this._version++,this.afterChange(),this.onInputAdded&&this.onInputAdded(e,t),this.onInputsOutputsChange&&this.onInputsOutputsChange())},LGraph.prototype.setInputData=function(e,t){let n=this.inputs[e];n&&(n.value=t)},LGraph.prototype.getInputData=function(e){e=this.inputs[e];return e?e.value:null},LGraph.prototype.renameInput=function(e,t){if(t!=e)return!!this.inputs[e]&&(this.inputs[t]?(console.error("there is already one input with that name"),!1):(this.inputs[t]=this.inputs[e],delete this.inputs[e],this._version++,this.onInputRenamed&&this.onInputRenamed(e,t),void(this.onInputsOutputsChange&&this.onInputsOutputsChange())))},LGraph.prototype.changeInputType=function(e,t){if(!this.inputs[e])return!1;this.inputs[e].type&&String(this.inputs[e].type).toLowerCase()==String(t).toLowerCase()||(this.inputs[e].type=t,this._version++,this.onInputTypeChanged&&this.onInputTypeChanged(e,t))},LGraph.prototype.removeInput=function(e){return!!this.inputs[e]&&(delete this.inputs[e],this._version++,this.onInputRemoved&&this.onInputRemoved(e),this.onInputsOutputsChange&&this.onInputsOutputsChange(),!0)},LGraph.prototype.addOutput=function(e,t,n){this.outputs[e]={name:e,type:t,value:n},this._version++,this.onOutputAdded&&this.onOutputAdded(e,t),this.onInputsOutputsChange&&this.onInputsOutputsChange()},LGraph.prototype.setOutputData=function(e,t){let n=this.outputs[e];n&&(n.value=t)},LGraph.prototype.getOutputData=function(e){e=this.outputs[e];return e?e.value:null},LGraph.prototype.renameOutput=function(e,t){return!!this.outputs[e]&&(this.outputs[t]?(console.error("there is already one output with that name"),!1):(this.outputs[t]=this.outputs[e],delete this.outputs[e],this._version++,this.onOutputRenamed&&this.onOutputRenamed(e,t),void(this.onInputsOutputsChange&&this.onInputsOutputsChange())))},LGraph.prototype.changeOutputType=function(e,t){if(!this.outputs[e])return!1;this.outputs[e].type&&String(this.outputs[e].type).toLowerCase()==String(t).toLowerCase()||(this.outputs[e].type=t,this._version++,this.onOutputTypeChanged&&this.onOutputTypeChanged(e,t))},LGraph.prototype.removeOutput=function(e){return!!this.outputs[e]&&(delete this.outputs[e],this._version++,this.onOutputRemoved&&this.onOutputRemoved(e),this.onInputsOutputsChange&&this.onInputsOutputsChange(),!0)},LGraph.prototype.triggerInput=function(e,t){let n=this.findNodesByTitle(e);for(let e=0;e<n.length;++e)n[e].onTrigger(t)},LGraph.prototype.setCallback=function(e,t){let n=this.findNodesByTitle(e);for(let e=0;e<n.length;++e)n[e].setTrigger(t)},LGraph.prototype.beforeChange=function(e){this.onBeforeChange&&this.onBeforeChange(this,e),this.sendActionToCanvas("onBeforeChange",this)},LGraph.prototype.afterChange=function(e){this.onAfterChange&&this.onAfterChange(this,e),this.sendActionToCanvas("onAfterChange",this)},LGraph.prototype.connectionChange=function(e,t){this.updateExecutionOrder(),this.onConnectionChange&&this.onConnectionChange(e),this._version++,this.sendActionToCanvas("onConnectionChange")},LGraph.prototype.isLive=function(){if(this.list_of_graphcanvas)for(let e=0;e<this.list_of_graphcanvas.length;++e)if(this.list_of_graphcanvas[e].live_mode)return!0;return!1},LGraph.prototype.clearTriggeredSlots=function(){for(var t in this.links){let e=this.links[t];e&&e._last_time&&(e._last_time=0)}},LGraph.prototype.change=function(){LiteGraph$2.debug&&console.log("Graph changed"),this.sendActionToCanvas("setDirty",[!0,!0]),this.on_change&&this.on_change(this)},LGraph.prototype.setDirtyCanvas=function(e,t){this.sendActionToCanvas("setDirty",[e,t])},LGraph.prototype.removeLink=function(t){t=this.links[t];if(t){let e=this.getNodeById(t.target_id);e&&e.disconnectInput(t.target_slot)}},LGraph.prototype.serialize=function(){let n=[];for(let e=0,t=this._nodes.length;e<t;++e)n.push(this._nodes[e].serialize());let e=[];for(var r in this.links){let t=this.links[r];if(!t.serialize){console.warn("weird LLink bug, link info is not a LLink but a regular object");let e=new LLink;for(var i in t)e[i]=t[i];this.links[r]=e,t=e}e.push(t.serialize())}let t=[];for(let e=0;e<this._groups.length;++e)t.push(this._groups[e].serialize());var o={last_node_id:this.last_node_id,last_link_id:this.last_link_id,nodes:n,links:e,groups:t,config:this.config,extra:this.extra,version:LiteGraph$2.VERSION};return this.onSerialize&&this.onSerialize(o),o},LGraph.prototype.configure=function(r,e){if(r){e||this.clear();var t,i=r.nodes;if(r.links&&r.links.constructor===Array){let t=[];for(let e=0;e<r.links.length;++e){var o=r.links[e];if(o){let e=new LLink;e.configure(o),t[e.id]=e}else console.warn("serialized graph link data contains errors, skipping.")}r.links=t}for(t in r)"nodes"!=t&&"groups"!=t&&(this[t]=r[t]);let n=!1;if(this._nodes=[],i){for(let t=0,e=i.length;t<e;++t){var a=i[t];let e=LiteGraph$2.createNode(a.type,a.title);e||(LiteGraph$2.debug&&console.log("Node not found or has errors: "+a.type),(e=new LGraphNode).last_serialization=a,e.has_errors=!0,n=!0),e.id=a.id,this.add(e,!0)}for(let t=0,e=i.length;t<e;++t){var s=i[t];let e=this.getNodeById(s.id);e&&e.configure(s)}}if(this._groups.length=0,r.groups)for(let t=0;t<r.groups.length;++t){let e=new LiteGraph$2.LGraphGroup;e.configure(r.groups[t]),this.add(e)}return this.updateExecutionOrder(),this.extra=r.extra||{},this.onConfigure&&this.onConfigure(r),this._version++,this.setDirtyCanvas(!0,!0),n}},LGraph.prototype.load=function(t,r){let i=this;if(t.constructor===File||t.constructor===Blob){let e=new FileReader;e.addEventListener("load",function(e){e=JSON.parse(e.target.result);i.configure(e),r&&r()}),void e.readAsText(t)}else{let n=new XMLHttpRequest;n.open("GET",t,!0),n.send(null),n.onload=function(e){var t;200!==n.status?console.error("Error loading graph:",n.status,n.response):(t=JSON.parse(n.response),i.configure(t),r&&r())},n.onerror=function(e){console.error("Error loading graph:",e)}}},LGraph.prototype.onNodeTrace=function(e,t,n){};const install=a=>{function e(){this.size=[140,80],this.properties={enabled:!0},this.enabled=!0,this.subgraph=new a.LGraph,(this.subgraph._subgraph_node=this).subgraph._is_subgraph=!0,this.subgraph.onTrigger=this.onSubgraphTrigger.bind(this),this.subgraph.onInputAdded=this.onSubgraphNewInput.bind(this),this.subgraph.onInputRenamed=this.onSubgraphRenamedInput.bind(this),this.subgraph.onInputTypeChanged=this.onSubgraphTypeChangeInput.bind(this),this.subgraph.onInputRemoved=this.onSubgraphRemovedInput.bind(this),this.subgraph.onOutputAdded=this.onSubgraphNewOutput.bind(this),this.subgraph.onOutputRenamed=this.onSubgraphRenamedOutput.bind(this),this.subgraph.onOutputTypeChanged=this.onSubgraphTypeChangeOutput.bind(this),this.subgraph.onOutputRemoved=this.onSubgraphRemovedOutput.bind(this)}function t(){this.addOutput("","number"),this.name_in_graph="",this.properties={name:"",type:"number",value:0};var t=this;this.name_widget=this.addWidget("text","Name",this.properties.name,function(e){e&&t.setProperty("name",e)}),this.type_widget=this.addWidget("text","Type",this.properties.type,function(e){t.setProperty("type",e)}),this.value_widget=this.addWidget("number","Value",this.properties.value,function(e){t.setProperty("value",e)}),this.widgets_up=!0,this.size=[180,90]}function n(){this.addInput("",""),this.name_in_graph="",this.properties={name:"",type:""},this.name_widget=this.addWidget("text","Name",this.properties.name,"name"),this.type_widget=this.addWidget("text","Type",this.properties.type,"type"),this.widgets_up=!0,this.size=[180,60]}e.title="Subgraph",e.desc="Graph inside a node",e.title_color="#334",e.prototype.onGetInputs=function(){return[["enabled","boolean"]]},e.prototype.onDblClick=function(e,t,n){var r=this;setTimeout(function(){n.openSubgraph(r.subgraph)},10)},e.prototype.onAction=function(e,t){this.subgraph.onAction(e,t)},e.prototype.onExecute=function(){if(this.enabled=this.getInputOrProperty("enabled"),this.enabled){if(this.inputs)for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],n=this.getInputData(e);this.subgraph.setInputData(t.name,n)}if(this.subgraph.runStep(),this.outputs)for(e=0;e<this.outputs.length;e++){var r=this.outputs[e],n=this.subgraph.getOutputData(r.name);this.setOutputData(e,n)}}},e.prototype.sendEventToAllNodes=function(e,t,n){this.enabled&&this.subgraph.sendEventToAllNodes(e,t,n)},e.prototype.onDrawBackground=function(e,t,n,r){var i,o;this.flags.collapsed||(i=this.size[1]-a.NODE_TITLE_HEIGHT+.5,o=a.isInsideRectangle(r[0],r[1],this.pos[0],this.pos[1]+i,this.size[0],a.NODE_TITLE_HEIGHT),r=a.isInsideRectangle(r[0],r[1],this.pos[0],this.pos[1]+i,this.size[0]/2,a.NODE_TITLE_HEIGHT),e.fillStyle=o?"#555":"#222",e.beginPath(),this._shape==a.BOX_SHAPE?r?e.rect(0,i,this.size[0]/2+1,a.NODE_TITLE_HEIGHT):e.rect(this.size[0]/2,i,this.size[0]/2+1,a.NODE_TITLE_HEIGHT):r?e.roundRect(0,i,this.size[0]/2+1,a.NODE_TITLE_HEIGHT,[0,0,8,8]):e.roundRect(this.size[0]/2,i,this.size[0]/2+1,a.NODE_TITLE_HEIGHT,[0,0,8,8]),o?e.fill():e.fillRect(0,i,this.size[0]+1,a.NODE_TITLE_HEIGHT),e.textAlign="center",e.font="24px Arial",e.fillStyle=o?"#DDD":"#999",e.fillText("+",.25*this.size[0],24+i),e.fillText("+",.75*this.size[0],24+i))},e.prototype.onMouseDown=function(e,t,n){var r=this.size[1]-a.NODE_TITLE_HEIGHT+.5;console.log(0),t[1]>r&&(t[0]<this.size[0]/2?(console.log(1),n.showSubgraphPropertiesDialog(this)):(console.log(2),n.showSubgraphPropertiesDialogRight(this)))},e.prototype.computeSize=function(){var e=this.inputs?this.inputs.length:0,t=this.outputs?this.outputs.length:0;return[200,Math.max(e,t)*a.NODE_SLOT_HEIGHT+a.NODE_TITLE_HEIGHT]},e.prototype.onSubgraphTrigger=function(e,t){e=this.findOutputSlot(e);-1!=e&&this.triggerSlot(e)},e.prototype.onSubgraphNewInput=function(e,t){-1==this.findInputSlot(e)&&this.addInput(e,t)},e.prototype.onSubgraphRenamedInput=function(e,t){e=this.findInputSlot(e);-1!=e&&(this.getInputInfo(e).name=t)},e.prototype.onSubgraphTypeChangeInput=function(e,t){e=this.findInputSlot(e);-1!=e&&(this.getInputInfo(e).type=t)},e.prototype.onSubgraphRemovedInput=function(e){e=this.findInputSlot(e);-1!=e&&this.removeInput(e)},e.prototype.onSubgraphNewOutput=function(e,t){-1==this.findOutputSlot(e)&&this.addOutput(e,t)},e.prototype.onSubgraphRenamedOutput=function(e,t){e=this.findOutputSlot(e);-1!=e&&(this.getOutputInfo(e).name=t)},e.prototype.onSubgraphTypeChangeOutput=function(e,t){e=this.findOutputSlot(e);-1!=e&&(this.getOutputInfo(e).type=t)},e.prototype.onSubgraphRemovedOutput=function(e){e=this.findInputSlot(e);-1!=e&&this.removeOutput(e)},e.prototype.getExtraMenuOptions=function(e){var t=this;return[{content:"Open",callback:function(){e.openSubgraph(t.subgraph)}}]},e.prototype.onResize=function(e){e[1]+=20},e.prototype.serialize=function(){var e=a.LGraphNode.prototype.serialize.call(this);return e.subgraph=this.subgraph.serialize(),e},e.prototype.clone=function(){var e=a.createNode(this.type),t=this.serialize();return delete t.id,delete t.inputs,delete t.outputs,e.configure(t),e},e.prototype.buildFromNodes=function(e){for(var t={},n=0,r=0;r<e.length;++r)t[(i=e[r]).id]=i,n=Math.min(i.pos[0],n),Math.max(i.pos[0],n);for(var i,r=0;r<e.length;++r){if((i=e[r]).inputs)for(var o=0;o<i.inputs.length;++o){var a=i.inputs[o];a&&a.link&&((h=i.graph.links[a.link])&&!t[h.origin_id]&&this.subgraph.addInput(a.name,h.type))}if(i.outputs)for(o=0;o<i.outputs.length;++o){var s=i.outputs[o];if(s&&s.links&&s.links.length)for(var l=0;l<s.links.length;++l){var h=i.graph.links[s.links[l]];if(h&&!t[h.target_id]){0;break}}}}},t.title="Input",t.desc="Input of the graph",t.prototype.onConfigure=function(){this.updateType()},t.prototype.updateType=function(){var e=this.properties.type;this.type_widget.value=e,this.outputs[0].type!=e&&(a.isValidConnection(this.outputs[0].type,e)||this.disconnectOutput(0),this.outputs[0].type=e),"number"==e?(this.value_widget.type="number",this.value_widget.value=0):"boolean"==e?(this.value_widget.type="toggle",this.value_widget.value=!0):"string"==e?(this.value_widget.type="text",this.value_widget.value=""):(this.value_widget.type=null,this.value_widget.value=null),this.properties.value=this.value_widget.value,this.graph&&this.name_in_graph&&this.graph.changeInputType(this.name_in_graph,e)},t.prototype.onPropertyChanged=function(e,t){if("name"==e){if(""==t||t==this.name_in_graph||"enabled"==t)return!1;this.graph&&(this.name_in_graph?this.graph.renameInput(this.name_in_graph,t):this.graph.addInput(t,this.properties.type)),this.name_widget.value=t,this.name_in_graph=t}else"type"==e&&this.updateType()},t.prototype.getTitle=function(){return this.flags.collapsed?this.properties.name:this.title},t.prototype.onAction=function(e,t){this.properties.type==a.EVENT&&this.triggerSlot(0,t)},t.prototype.onExecute=function(){var e=this.properties.name,e=this.graph.inputs[e];e?this.setOutputData(0,(void 0!==e.value?e:this.properties).value):this.setOutputData(0,this.properties.value)},t.prototype.onRemoved=function(){this.name_in_graph&&this.graph.removeInput(this.name_in_graph)},n.title="Output",n.desc="Output of the graph",n.prototype.onPropertyChanged=function(e,t){if("name"==e){if(""==t||t==this.name_in_graph||"enabled"==t)return!1;this.graph&&(this.name_in_graph?this.graph.renameOutput(this.name_in_graph,t):this.graph.addOutput(t,this.properties.type)),this.name_widget.value=t,this.name_in_graph=t}else"type"==e&&this.updateType()},n.prototype.updateType=function(){var e=this.properties.type;this.type_widget&&(this.type_widget.value=e),this.inputs[0].type!=e&&("action"!=e&&"event"!=e||(e=a.EVENT),a.isValidConnection(this.inputs[0].type,e)||this.disconnectInput(0),this.inputs[0].type=e),this.graph&&this.name_in_graph&&this.graph.changeOutputType(this.name_in_graph,e)},n.prototype.onExecute=function(){this._value=this.getInputData(0),this.graph.setOutputData(this.properties.name,this._value)},n.prototype.onAction=function(e,t){this.properties.type==a.ACTION&&this.graph.trigger(this.properties.name,t)},n.prototype.onRemoved=function(){this.name_in_graph&&this.graph.removeOutput(this.name_in_graph)},n.prototype.getTitle=function(){return this.flags.collapsed?this.properties.name:this.title},a.Subgraph=e,a.registerNodeType("graph/subgraph",e),a.GraphInput=t,a.registerNodeType("graph/input",t),a.GraphOutput=n,a.registerNodeType("graph/output",n)};var Subgraph={install:install};const LiteGraph$1={VERSION:"0.0.1",CANVAS_GRID_SIZE:10,NODE_TITLE_HEIGHT:30,NODE_TITLE_TEXT_Y:20,NODE_SLOT_HEIGHT:20,NODE_WIDGET_HEIGHT:20,NODE_WIDTH:140,NODE_MIN_WIDTH:50,NODE_COLLAPSED_RADIUS:10,NODE_COLLAPSED_WIDTH:80,NODE_TITLE_COLOR:"#999",NODE_SELECTED_TITLE_COLOR:"#FFF",NODE_TEXT_SIZE:14,NODE_TEXT_COLOR:"#AAA",NODE_SUBTEXT_SIZE:12,NODE_DEFAULT_COLOR:"#333",NODE_DEFAULT_BGCOLOR:"#353535",NODE_DEFAULT_BOXCOLOR:"#666",NODE_DEFAULT_SHAPE:"box",NODE_BOX_OUTLINE_COLOR:"#FFF",DEFAULT_SHADOW_COLOR:"rgba(0,0,0,0.5)",DEFAULT_GROUP_FONT:24,WIDGET_BGCOLOR:"#222",WIDGET_OUTLINE_COLOR:"#666",WIDGET_TEXT_COLOR:"#DDD",WIDGET_SECONDARY_TEXT_COLOR:"#999",LINK_COLOR:"#9A9",EVENT_LINK_COLOR:"#A86",CONNECTING_LINK_COLOR:"#AFA",MAX_NUMBER_OF_NODES:1e3,DEFAULT_POSITION:[100,100],VALID_SHAPES:["default","box","round","card"],BOX_SHAPE:1,ROUND_SHAPE:2,CIRCLE_SHAPE:3,CARD_SHAPE:4,ARROW_SHAPE:5,GRID_SHAPE:6,DEFAULT_SHAPE:1,INPUT:1,OUTPUT:2,EVENT:-1,ACTION:-1,NODE_MODES:["Always","On Event","Never","On Trigger"],NODE_MODES_COLORS:["#666","#422","#333","#224","#626"],ALWAYS:0,ON_EVENT:1,NEVER:2,ON_TRIGGER:3,UP:1,DOWN:2,LEFT:3,RIGHT:4,CENTER:5,LINK_RENDER_MODES:["Straight","Linear","Spline"],STRAIGHT_LINK:0,LINEAR_LINK:1,SPLINE_LINK:2,NORMAL_TITLE:0,NO_TITLE:1,TRANSPARENT_TITLE:2,AUTOHIDE_TITLE:3,VERTICAL_LAYOUT:"vertical",proxy:null,node_images_path:"",debug:!1,catch_exceptions:!0,throw_errors:!0,allow_scripts:!1,registered_node_types:{},node_types_by_file_extension:{},Nodes:{},Globals:{},searchbox_extras:{},auto_sort_node_types:!1,node_box_coloured_when_on:!1,node_box_coloured_by_mode:!1,dialog_close_on_mouse_leave:!0,dialog_close_on_mouse_leave_delay:500,shift_click_do_break_link_from:!1,click_do_break_link_to:!1,search_hide_on_mouse_leave:!0,search_filter_enabled:!1,search_show_all_on_open:!0,auto_load_slot_types:!1,registered_slot_in_types:{},registered_slot_out_types:{},slot_types_in:[],slot_types_out:[],slot_types_default_in:[],slot_types_default_out:[],alt_drag_do_clone_nodes:!1,do_add_triggers_slots:!1,allow_multi_output_for_events:!0,middle_click_slot_add_default_node:!1,release_link_on_empty_shows_menu:!1,pointerevents_method:"mouse",registerNodeType:function(e,n){if(!n.prototype)throw"Cannot register a simple object, it must be a class with a prototype";n.type=e,LiteGraph$1.debug&&console.log("Node registered: "+e),e.split("/");var t=n.name,r=e.lastIndexOf("/");if(n.category=e.substr(0,r),n.title||(n.title=t),n.prototype)for(var i in LGraphNode.prototype)n.prototype[i]||(n.prototype[i]=LGraphNode.prototype[i]);r=this.registered_node_types[e];if(r)console.log("replacing node type: "+e);else if(Object.hasOwnProperty(n.prototype,"shape")||Object.defineProperty(n.prototype,"shape",{set:function(e){switch(e){case"default":delete this._shape;break;case"box":this._shape=LiteGraph$1.BOX_SHAPE;break;case"round":this._shape=LiteGraph$1.ROUND_SHAPE;break;case"circle":this._shape=LiteGraph$1.CIRCLE_SHAPE;break;case"card":this._shape=LiteGraph$1.CARD_SHAPE;break;default:this._shape=e}},get:function(e){return this._shape},enumerable:!0,configurable:!0}),n.prototype.onPropertyChange&&console.warn("LiteGraph node class "+e+" has onPropertyChange method, it must be called onPropertyChanged with d at the end"),n.supported_extensions)for(var o in n.supported_extensions){let e=n.supported_extensions[o];e&&e.constructor===String&&(this.node_types_by_file_extension[e.toLowerCase()]=n)}if((this.registered_node_types[e]=n).constructor.name&&(this.Nodes[t]=n),LiteGraph$1.onNodeTypeRegistered&&LiteGraph$1.onNodeTypeRegistered(e,n),r&&LiteGraph$1.onNodeTypeReplaced&&LiteGraph$1.onNodeTypeReplaced(e,n,r),n.prototype.onPropertyChange&&console.warn("LiteGraph node class "+e+" has onPropertyChange method, it must be called onPropertyChanged with d at the end"),n.supported_extensions)for(let t=0;t<n.supported_extensions.length;t++){let e=n.supported_extensions[t];e&&e.constructor===String&&(this.node_types_by_file_extension[e.toLowerCase()]=n)}},unregisterNodeType:function(e){var t=e.constructor===String?this.registered_node_types[e]:e;if(!t)throw"node type not found: "+e;delete this.registered_node_types[t.type],t.constructor.name&&delete this.Nodes[t.constructor.name]},registerNodeAndSlotType:function(e,t,n){n=n||!1;var r=(e.constructor===String&&"anonymous"!==this.registered_node_types[e]?this.registered_node_types[e]:e).constructor.type;let i;i="string"==typeof t?t.split(","):t==this.EVENT||t==this.ACTION?["_event_"]:["*"];for(let t=0;t<i.length;++t){let e=i[t];""===e&&(e="*");var o=n?"registered_slot_out_types":"registered_slot_in_types";void 0===this[o][e]&&(this[o][e]={nodes:[]}),this[o][e].nodes.push(r),n?this.slot_types_out.includes(e.toLowerCase())||(this.slot_types_out.push(e.toLowerCase()),this.slot_types_out.sort()):this.slot_types_in.includes(e.toLowerCase())||(this.slot_types_in.push(e.toLowerCase()),this.slot_types_in.sort())}},wrapFunctionAsNode:function(e,t,n,r,i){let o=Array(t.length),a="";var s=LiteGraph$1.getParameterNames(t);for(let e=0;e<s.length;++e)a+="this.addInput('"+s[e]+"',"+(n&&n[e]?"'"+n[e]+"'":"0")+");\n";a+="this.addOutput('out',"+(r?"'"+r+"'":0)+");\n",i&&(a+="this.properties = "+JSON.stringify(i)+";\n");let l=Function(a);l.title=e.split("/").pop(),l.desc="Generated from "+t.name,l.prototype.onExecute=function(){for(let e=0;e<o.length;++e)o[e]=this.getInputData(e);var e=t.apply(this,o);this.setOutputData(0,e)},this.registerNodeType(e,l)},clearRegisteredTypes:function(){this.registered_node_types={},this.node_types_by_file_extension={},this.Nodes={},this.searchbox_extras={}},addNodeMethod:function(t,n){for(var r in LGraphNode.prototype[t]=n,this.registered_node_types){let e=this.registered_node_types[r];e.prototype[t]&&(e.prototype["_"+t]=e.prototype[t]),e.prototype[t]=n}},createNode:function(e,t,n){let r=this.registered_node_types[e];if(!r)return LiteGraph$1.debug&&console.log('GraphNode type "'+e+'" not registered.'),null;r.prototype||r,t=t||r.title||e;let i=null;if(LiteGraph$1.catch_exceptions)try{i=new r(t)}catch(e){return console.error(e),null}else i=new r(t);if(i.type=e,!i.title&&t&&(i.title=t),i.properties||(i.properties={}),i.properties_info||(i.properties_info=[]),i.flags||(i.flags={}),i.size||(i.size=i.computeSize()),i.pos||(i.pos=LiteGraph$1.DEFAULT_POSITION.concat()),i.mode||(i.mode=LiteGraph$1.ALWAYS),n)for(var o in n)i[o]=n[o];return i.onNodeCreated&&i.onNodeCreated(),i},getNodeType:function(e){return this.registered_node_types[e]},getNodeTypesInCategory:function(e,t){let n=[];for(var r in this.registered_node_types){r=this.registered_node_types[r];r.filter==t&&(""==e?null==r.category&&n.push(r):r.category==e&&n.push(r))}return this.auto_sort_node_types&&n.sort(function(e,t){return e.title.localeCompare(t.title)}),n},getNodeTypesCategories:function(e){let t={"":1};for(var n in this.registered_node_types){n=this.registered_node_types[n];n.category&&!n.skip_list&&n.filter==e&&(t[n.category]=1)}let r=[];for(var i in t)r.push(i);return this.auto_sort_node_types?r.sort():r},reloadNodes:function(e){var t=document.getElementsByTagName("script");let r=[];for(let e=0;e<t.length;e++)r.push(t[e]);let i=document.getElementsByTagName("head")[0];e=document.location.href+e;for(let n=0;n<r.length;n++){let t=r[n].src;if(t&&t.substr(0,e.length)==e)try{LiteGraph$1.debug&&console.log("Reloading: "+t);let e=document.createElement("script");e.type="text/javascript",e.src=t,i.appendChild(e),i.removeChild(r[n])}catch(e){if(LiteGraph$1.throw_errors)throw e;LiteGraph$1.debug&&console.log("Error while reloading "+t)}}LiteGraph$1.debug&&console.log("Nodes reloaded")},cloneObject:function(e,t){if(null==e)return null;var n,r=JSON.parse(JSON.stringify(e));if(!t)return r;for(n in r)t[n]=r[n];return t},isValidConnection:function(e,t){if(""!=t&&"*"!==t||(t=0),!(e=""!=e&&"*"!==e?e:0)||!t||e==t||e==LiteGraph$1.EVENT&&t==LiteGraph$1.ACTION)return!0;if(e=String(e),t=String(t),e=e.toLowerCase(),t=t.toLowerCase(),-1==e.indexOf(",")&&-1==t.indexOf(","))return e==t;var n=e.split(","),r=t.split(",");for(let t=0;t<n.length;++t)for(let e=0;e<r.length;++e)if(this.isValidConnection(n[t],r[e]))return!0;return!1},registerSearchboxExtra:function(e,t,n){this.searchbox_extras[t.toLowerCase()]={type:e,desc:t,data:n}},fetchFile:function(t,n,r,i){if(t){if(n=n||"text",t.constructor===String)return"http"==t.substr(0,4)&&LiteGraph$1.proxy&&(t=LiteGraph$1.proxy+t.substr(t.indexOf(":")+3)),fetch(t).then(function(e){if(e.ok)return"arraybuffer"==n?e.arrayBuffer():"text"==n||"string"==n?e.text():"json"==n?e.json():"blob"==n?e.blob():void 0;throw new Error("File not found")}).then(function(e){r&&r(e)}).catch(function(e){console.error("error fetching file:",t),i&&i(e)});if(t.constructor===File||t.constructor===Blob){let e=new FileReader;if(e.onload=function(e){let t=e.target.result;"json"==n&&(t=JSON.parse(t)),r&&r(t)},"arraybuffer"==n)return e.readAsArrayBuffer(t);if("text"==n||"json"==n)return e.readAsText(t);if("blob"==n)return e.readAsBinaryString(t)}}return null}};LiteGraph$1.LGraph=LGraph,LiteGraph$1.LLink=LLink,LiteGraph$1.LGraphNode=LGraphNode,LiteGraph$1.LGraphGroup=LGraphGroup,LiteGraph$1.LGraphCanvas=LGraphCanvas,LiteGraph$1.DragAndScale=DragAndScale,LiteGraph$1.CurveEditor=CurveEditor,LiteGraph$1.ContextMenu=ContextMenu,LiteGraph$1.distance=distance,LiteGraph$1.compareObjects=compareObjects,LiteGraph$1.growBounding=growBounding,LiteGraph$1.isInsideBounding=isInsideBounding,LiteGraph$1.overlapBounding=overlapBounding,LiteGraph$1.isInsideRectangle=isInsideRectangle,LiteGraph$1.colorToString=colorToString,LiteGraph$1.hex2num=hex2num,LiteGraph$1.num2hex=num2hex,LiteGraph$1.closeAllContextMenus=function(e){var n=(e=e||window).document.querySelectorAll(".litecontextmenu");if(n.length){let t=[];for(let e=0;e<n.length;e++)t.push(n[e]);for(let e=0;e<t.length;e++)t[e].close?t[e].close():t[e].parentNode&&t[e].parentNode.removeChild(t[e])}},LiteGraph$1.extendClass=function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);if(t.prototype)for(var r in t.prototype)!t.prototype.hasOwnProperty(r)||e.prototype.hasOwnProperty(r)||(t.prototype.__lookupGetter__(r)?e.prototype.__defineGetter__(r,t.prototype.__lookupGetter__(r)):e.prototype[r]=t.prototype[r],t.prototype.__lookupSetter__(r)&&e.prototype.__defineSetter__(r,t.prototype.__lookupSetter__(r)))},LiteGraph$1.getParameterNames=function(e){return(e+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)},LiteGraph$1.pointerListenerAdd=function(n,r,i,o=!1){if(n&&n.addEventListener&&r&&"function"==typeof i){let e=LiteGraph$1.pointerevents_method,t=r;if("pointer"==e&&!window.PointerEvent)switch(console.warn("sMethod=='pointer' && !window.PointerEvent"),console.log("Converting pointer["+t+"] : down move up cancel enter TO touchstart touchmove touchend, etc .."),t){case"down":e="touch",t="start";break;case"move":e="touch";break;case"up":e="touch",t="end";break;case"cancel":e="touch";break;case"enter":console.log("debug: Should I send a move event?");break;default:console.warn("PointerEvent not available in this browser ? The event "+t+" would not be called")}switch(t){case"down":case"up":case"move":case"over":case"out":case"enter":n.addEventListener(e+t,i,o);case"leave":case"cancel":case"gotpointercapture":case"lostpointercapture":if("mouse"!=e)return n.addEventListener(e+t,i,o);default:return n.addEventListener(t,i,o)}}},LiteGraph$1.pointerListenerRemove=function(e,t,n,r=!1){if(e&&e.removeEventListener&&t&&"function"==typeof n)switch(t){case"down":case"up":case"move":case"over":case"out":case"enter":"pointer"!=LiteGraph$1.pointerevents_method&&"mouse"!=LiteGraph$1.pointerevents_method||e.removeEventListener(LiteGraph$1.pointerevents_method+t,n,r);case"leave":case"cancel":case"gotpointercapture":case"lostpointercapture":if("pointer"==LiteGraph$1.pointerevents_method)return e.removeEventListener(LiteGraph$1.pointerevents_method+t,n,r);default:return e.removeEventListener(t,n,r)}},LiteGraph$1.use=function(e){const t=this._installedPlugins||(this._installedPlugins=[]);if(!(-1<t.indexOf(e))){const n=toArray(arguments);n.unshift(this),"function"==typeof e.install?e.install.apply(e,n):"function"==typeof e&&e.apply(null,n),t.push(e)}return this},"undefined"!=typeof performance?LiteGraph$1.getTime=performance.now.bind(performance):"undefined"!=typeof Date&&Date.now?LiteGraph$1.getTime=Date.now.bind(Date):"undefined"!=typeof process?LiteGraph$1.getTime=function(){var e=process.hrtime();return.001*e[0]+1e-6*e[1]}:LiteGraph$1.getTime=function(){return(new Date).getTime()},"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}),Math.clamp=function(e,t,n){return e<t?t:n<e?n:e},LiteGraph$1.use(Subgraph);var LiteGraph$2=LiteGraph$1;LiteGraph$2.debug=!1,LiteGraph$2.catch_exceptions=!0,LiteGraph$2.throw_errors=!0,LiteGraph$2.allow_scripts=!1,LiteGraph$2.searchbox_extras={},LiteGraph$2.auto_sort_node_types=!0,LiteGraph$2.node_box_coloured_when_on=!0,LiteGraph$2.node_box_coloured_by_mode=!0,LiteGraph$2.dialog_close_on_mouse_leave=!0,LiteGraph$2.dialog_close_on_mouse_leave_delay=500,LiteGraph$2.shift_click_do_break_link_from=!1,LiteGraph$2.click_do_break_link_to=!1,LiteGraph$2.search_hide_on_mouse_leave=!0,LiteGraph$2.search_filter_enabled=!0,LiteGraph$2.search_show_all_on_open=!0,LiteGraph$2.auto_load_slot_types=!0,LiteGraph$2.registered_slot_in_types={},LiteGraph$2.registered_slot_out_types={},LiteGraph$2.slot_types_in=[],LiteGraph$2.slot_types_out=[],LiteGraph$2.alt_drag_do_clone_nodes=!0,LiteGraph$2.do_add_triggers_slots=!0,LiteGraph$2.allow_multi_output_for_events=!1,LiteGraph$2.middle_click_slot_add_default_node=!0,LiteGraph$2.release_link_on_empty_shows_menu=!0,LiteGraph$2.pointerevents_method="mouse";export{LiteGraph$2 as default};
